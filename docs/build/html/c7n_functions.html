<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>C7N Functions Required &#8212; CEL in Python  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Development Tools" href="development.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="c7n-functions-required">
<span id="c7n-functions"></span><h1><a class="toc-backref" href="#id1" role="doc-backlink">C7N Functions Required</a><a class="headerlink" href="#c7n-functions-required" title="Link to this heading">¶</a></h1>
<p>This survey of C7N filter clauses is based on source code and on an analysis of working policies.
The required functions are grouped into four clusters, depending on the presence of absence of the “op” operator clause, and the number of resource types using the feature.
Within each group, they are ranked in order of popularity.</p>
<p>For each individual type of filter clause, we provide the following details:</p>
<ul class="simple">
<li><p>The C7N schema definition.</p></li>
<li><p>The resource types where the filter type is used.</p></li>
<li><p>The variant implementations that are registered (if any.)</p></li>
<li><p>If used in the working policies,</p>
<ul>
<li><p>the number of policies using the filter clause,</p></li>
<li><p>Up to three examples.</p></li>
</ul>
</li>
</ul>
<p>The actions are redacted as are specific values from filters.
The filter redaction obscures the S3 buckets, RESTful services,
vpc-names, tag values, and subnet names.</p>
<p>The schema and the examples help to define the domain of CEL functions required.</p>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c7n-functions-required" id="id1">C7N Functions Required</a></p>
<ul>
<li><p><a class="reference internal" href="#design-principles" id="id2">Design Principles</a></p></li>
<li><p><a class="reference internal" href="#c7n-context-object" id="id3">C7N Context Object</a></p></li>
<li><p><a class="reference internal" href="#celfilter-design" id="id4">CELFilter Design</a></p></li>
<li><p><a class="reference internal" href="#c7n-cache" id="id5">C7N Cache</a></p></li>
<li><p><a class="reference internal" href="#common-c7n-constructs" id="id6">Common C7N Constructs</a></p></li>
<li><p><a class="reference internal" href="#common-non-bool-filters" id="id7">Common/Non-Bool Filters</a></p>
<ul>
<li><p><a class="reference internal" href="#value" id="id8">value</a></p></li>
<li><p><a class="reference internal" href="#op-implementations" id="id9">op Implementations</a></p></li>
<li><p><a class="reference internal" href="#value-type-conversions" id="id10">value_type Conversions</a></p></li>
<li><p><a class="reference internal" href="#value-from-external-data" id="id11">value_from External Data</a></p></li>
<li><p><a class="reference internal" href="#marked-for-op" id="id12">marked-for-op</a></p></li>
<li><p><a class="reference internal" href="#image-age" id="id13">image-age</a></p></li>
<li><p><a class="reference internal" href="#event" id="id14">event</a></p></li>
<li><p><a class="reference internal" href="#metrics" id="id15">metrics</a></p></li>
<li><p><a class="reference internal" href="#age" id="id16">age</a></p></li>
<li><p><a class="reference internal" href="#security-group" id="id17">security-group</a></p></li>
<li><p><a class="reference internal" href="#subnet" id="id18">subnet</a></p></li>
<li><p><a class="reference internal" href="#flow-logs" id="id19">flow-logs</a></p></li>
<li><p><a class="reference internal" href="#tag-count" id="id20">tag-count</a></p></li>
<li><p><a class="reference internal" href="#vpc" id="id21">vpc</a></p></li>
<li><p><a class="reference internal" href="#credential" id="id22">credential</a></p></li>
<li><p><a class="reference internal" href="#image" id="id23">image</a></p></li>
<li><p><a class="reference internal" href="#kms-alias" id="id24">kms-alias</a></p></li>
<li><p><a class="reference internal" href="#kms-key" id="id25">kms-key</a></p></li>
<li><p><a class="reference internal" href="#config-compliance-no-examples" id="id26">config-compliance (no examples)</a></p></li>
<li><p><a class="reference internal" href="#user-data-no-examples" id="id27">user-data (no examples)</a></p></li>
<li><p><a class="reference internal" href="#shield-metrics-no-examples" id="id28">shield-metrics (no examples)</a></p></li>
<li><p><a class="reference internal" href="#status-no-examples" id="id29">status (no examples)</a></p></li>
<li><p><a class="reference internal" href="#instance-no-examples" id="id30">instance (no examples)</a></p></li>
<li><p><a class="reference internal" href="#task-definition-no-examples" id="id31">task-definition (no examples)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#common-boolean-filters" id="id32">Common/Boolean Filters</a></p>
<ul>
<li><p><a class="reference internal" href="#offhour" id="id33">offhour</a></p></li>
<li><p><a class="reference internal" href="#onhour" id="id34">onhour</a></p></li>
<li><p><a class="reference internal" href="#cross-account" id="id35">cross-account</a></p></li>
<li><p><a class="reference internal" href="#unused" id="id36">unused</a></p></li>
<li><p><a class="reference internal" href="#is-not-logging" id="id37">is-not-logging</a></p></li>
<li><p><a class="reference internal" href="#health-event" id="id38">health-event</a></p></li>
<li><p><a class="reference internal" href="#shield-enabled" id="id39">shield-enabled</a></p></li>
<li><p><a class="reference internal" href="#is-logging" id="id40">is-logging</a></p></li>
<li><p><a class="reference internal" href="#used" id="id41">used</a></p></li>
<li><p><a class="reference internal" href="#waf-enabled" id="id42">waf-enabled</a></p></li>
<li><p><a class="reference internal" href="#network-location" id="id43">network-location</a></p></li>
<li><p><a class="reference internal" href="#finding-no-examples" id="id44">finding (no examples)</a></p></li>
<li><p><a class="reference internal" href="#has-inline-policy-no-examples" id="id45">has-inline-policy (no examples)</a></p></li>
<li><p><a class="reference internal" href="#default-vpc-no-examples" id="id46">default-vpc (no examples)</a></p></li>
<li><p><a class="reference internal" href="#healthcheck-protocol-mismatch-no-examples" id="id47">healthcheck-protocol-mismatch (no examples)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#singleton-non-bool-filters" id="id48">Singleton/Non-Bool Filters</a></p>
<ul>
<li><p><a class="reference internal" href="#launch-config" id="id49">launch-config</a></p></li>
<li><p><a class="reference internal" href="#instance-age" id="id50">instance-age</a></p></li>
<li><p><a class="reference internal" href="#listener" id="id51">listener</a></p></li>
<li><p><a class="reference internal" href="#vpc-id" id="id52">vpc-id</a></p></li>
<li><p><a class="reference internal" href="#ebs" id="id53">ebs</a></p></li>
<li><p><a class="reference internal" href="#instance-uptime" id="id54">instance-uptime</a></p></li>
<li><p><a class="reference internal" href="#state-age" id="id55">state-age</a></p></li>
<li><p><a class="reference internal" href="#password-policy" id="id56">password-policy</a></p></li>
<li><p><a class="reference internal" href="#reserved-concurrency" id="id57">reserved-concurrency</a></p></li>
<li><p><a class="reference internal" href="#access-key" id="id58">access-key</a></p></li>
<li><p><a class="reference internal" href="#mfa-device" id="id59">mfa-device</a></p></li>
<li><p><a class="reference internal" href="#policy" id="id60">policy</a></p></li>
<li><p><a class="reference internal" href="#key-rotation-status" id="id61">key-rotation-status</a></p></li>
<li><p><a class="reference internal" href="#group-no-examples" id="id62">group (no examples)</a></p></li>
<li><p><a class="reference internal" href="#iam-summary-no-examples" id="id63">iam-summary (no examples)</a></p></li>
<li><p><a class="reference internal" href="#s3-public-block-no-examples" id="id64">s3-public-block (no examples)</a></p></li>
<li><p><a class="reference internal" href="#rest-integration-no-examples" id="id65">rest-integration (no examples)</a></p></li>
<li><p><a class="reference internal" href="#rest-method-no-examples" id="id66">rest-method (no examples)</a></p></li>
<li><p><a class="reference internal" href="#target-group-no-examples" id="id67">target-group (no examples)</a></p></li>
<li><p><a class="reference internal" href="#instance-attribute-no-examples" id="id68">instance-attribute (no examples)</a></p></li>
<li><p><a class="reference internal" href="#ssm-no-examples" id="id69">ssm (no examples)</a></p></li>
<li><p><a class="reference internal" href="#event-source-no-examples" id="id70">event-source (no examples)</a></p></li>
<li><p><a class="reference internal" href="#db-parameter-no-examples" id="id71">db-parameter (no examples)</a></p></li>
<li><p><a class="reference internal" href="#param-no-examples" id="id72">param (no examples)</a></p></li>
<li><p><a class="reference internal" href="#bucket-notification-no-examples" id="id73">bucket-notification (no examples)</a></p></li>
<li><p><a class="reference internal" href="#inventory-no-examples" id="id74">inventory (no examples)</a></p></li>
<li><p><a class="reference internal" href="#route-no-examples" id="id75">route (no examples)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#singleton-boolean-filters" id="id76">Singleton/Boolean Filters</a></p>
<ul>
<li><p><a class="reference internal" href="#skip-ami-snapshots" id="id77">skip-ami-snapshots</a></p></li>
<li><p><a class="reference internal" href="#missing-policy-statement" id="id78">missing-policy-statement</a></p></li>
<li><p><a class="reference internal" href="#ssl-policy" id="id79">ssl-policy</a></p></li>
<li><p><a class="reference internal" href="#service-limit" id="id80">service-limit</a></p></li>
<li><p><a class="reference internal" href="#ingress" id="id81">ingress</a></p></li>
<li><p><a class="reference internal" href="#global-grants" id="id82">global-grants</a></p></li>
<li><p><a class="reference internal" href="#last-write" id="id83">last-write</a></p></li>
<li><p><a class="reference internal" href="#invalid" id="id84">invalid</a></p></li>
<li><p><a class="reference internal" href="#not-encrypted" id="id85">not-encrypted</a></p></li>
<li><p><a class="reference internal" href="#is-log-target" id="id86">is-log-target</a></p></li>
<li><p><a class="reference internal" href="#has-statement" id="id87">has-statement</a></p></li>
<li><p><a class="reference internal" href="#missing" id="id88">missing</a></p></li>
<li><p><a class="reference internal" href="#mismatch-s3-origin" id="id89">mismatch-s3-origin</a></p></li>
<li><p><a class="reference internal" href="#egress" id="id90">egress</a></p></li>
<li><p><a class="reference internal" href="#valid" id="id91">valid</a></p></li>
<li><p><a class="reference internal" href="#latest" id="id92">latest</a></p></li>
<li><p><a class="reference internal" href="#capacity-delta" id="id93">capacity-delta</a></p></li>
<li><p><a class="reference internal" href="#check-cloudtrail" id="id94">check-cloudtrail</a></p></li>
<li><p><a class="reference internal" href="#check-config" id="id95">check-config</a></p></li>
<li><p><a class="reference internal" href="#grant-count" id="id96">grant-count</a></p></li>
<li><p><a class="reference internal" href="#has-users-no-examples" id="id97">has-users (no examples)</a></p></li>
<li><p><a class="reference internal" href="#has-specific-managed-policy-no-examples" id="id98">has-specific-managed-policy (no examples)</a></p></li>
<li><p><a class="reference internal" href="#no-specific-managed-policy-no-examples" id="id99">no-specific-managed-policy (no examples)</a></p></li>
<li><p><a class="reference internal" href="#has-allow-all-no-examples" id="id100">has-allow-all (no examples)</a></p></li>
<li><p><a class="reference internal" href="#has-virtual-mfa-no-examples" id="id101">has-virtual-mfa (no examples)</a></p></li>
<li><p><a class="reference internal" href="#xray-encrypt-key-no-examples" id="id102">xray-encrypt-key (no examples)</a></p></li>
<li><p><a class="reference internal" href="#ephemeral-no-examples" id="id103">ephemeral (no examples)</a></p></li>
<li><p><a class="reference internal" href="#singleton-no-examples" id="id104">singleton (no examples)</a></p></li>
<li><p><a class="reference internal" href="#termination-protected-no-examples" id="id105">termination-protected (no examples)</a></p></li>
<li><p><a class="reference internal" href="#progagated-tags-no-examples" id="id106">progagated-tags (no examples)</a></p></li>
<li><p><a class="reference internal" href="#is-shadow-no-examples" id="id107">is-shadow (no examples)</a></p></li>
<li><p><a class="reference internal" href="#fault-tolerant-no-examples" id="id108">fault-tolerant (no examples)</a></p></li>
<li><p><a class="reference internal" href="#modifyable-no-examples" id="id109">modifyable (no examples)</a></p></li>
<li><p><a class="reference internal" href="#lifecycle-rule-no-examples" id="id110">lifecycle-rule (no examples)</a></p></li>
<li><p><a class="reference internal" href="#is-ssl-no-examples" id="id111">is-ssl (no examples)</a></p></li>
<li><p><a class="reference internal" href="#upgrade-available-no-examples" id="id112">upgrade-available (no examples)</a></p></li>
<li><p><a class="reference internal" href="#query-logging-enabled-no-examples" id="id113">query-logging-enabled (no examples)</a></p></li>
<li><p><a class="reference internal" href="#bucket-encryption-no-examples" id="id114">bucket-encryption (no examples)</a></p></li>
<li><p><a class="reference internal" href="#data-events-no-examples" id="id115">data-events (no examples)</a></p></li>
<li><p><a class="reference internal" href="#no-encryption-statement-no-examples" id="id116">no-encryption-statement (no examples)</a></p></li>
<li><p><a class="reference internal" href="#dhcp-options-no-examples" id="id117">dhcp-options (no examples)</a></p></li>
<li><p><a class="reference internal" href="#vpc-attributes-no-examples" id="id118">vpc-attributes (no examples)</a></p></li>
<li><p><a class="reference internal" href="#diff-no-examples" id="id119">diff (no examples)</a></p></li>
<li><p><a class="reference internal" href="#locked-no-examples" id="id120">locked (no examples)</a></p></li>
<li><p><a class="reference internal" href="#stale-no-examples" id="id121">stale (no examples)</a></p></li>
<li><p><a class="reference internal" href="#missing-route-no-examples" id="id122">missing-route (no examples)</a></p></li>
<li><p><a class="reference internal" href="#s3-cidr-no-examples" id="id123">s3-cidr (no examples)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#summary" id="id124">Summary</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="design-principles">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Design Principles</a><a class="headerlink" href="#design-principles" title="Link to this heading">¶</a></h2>
<p>There are a number of general design principles that apply to the C7N-CEL
interface.</p>
<ol class="arabic simple">
<li><p>Separate from C7N. The CEL processing is outside C7N, and capable of standing alone.
CEL is focused on Protobuf (and JSON) objects.
The interface to C7N is via the <code class="xref py py-mod docutils literal notranslate"><span class="pre">c7nlib</span></code> library of functions. These do <strong>not</strong> depend
on imports from the C7N project, but rely on a <code class="docutils literal notranslate"><span class="pre">CELFilter</span></code> class offering specific methods.
Access to C7N objects and their associated methods is limited to the features exposed
through the function library and the expected class definition.</p></li>
<li><p>Resource Representation. CEL is focused on Protobuf (and JSON) objects.
This means cloud resource descriptions must be provided in this form.
For AWS resource descriptions, this works out well since they start as JSON documents.
For C7N it works out well because the C7N representation of a resource is a Python dictionary.</p></li>
<li><p>The CEL activation context has these expected objects:</p>
<dl class="field-list simple">
<dt class="field-odd">resource<span class="colon">:</span></dt>
<dd class="field-odd"><p>This is the cloud resource being examined by C7N.
This will be a CEL mapping object built from JSON source data.</p>
</dd>
<dt class="field-even">now<span class="colon">:</span></dt>
<dd class="field-even"><p>This is the current time.
This will be a CEL timestamp.
This promotes testability by removing the need to mock
a clock to provide proper <code class="docutils literal notranslate"><span class="pre">utcnow()</span></code> values.</p>
</dd>
<dt class="field-odd">event<span class="colon">:</span></dt>
<dd class="field-odd"><p>For lambda-related resources, this is the triggering event.
This will be a CEL mapping object built from JSON source data.</p>
</dd>
</dl>
</li>
<li><p>C7N Extension functions can rely on a global <code class="docutils literal notranslate"><span class="pre">C7N</span></code> object. This is the <a class="reference internal" href="api.html#celpy.c7nlib.C7NContext" title="celpy.c7nlib.C7NContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">celpy.c7nlib.C7NContext</span></code></a> instance
used to manage C7N CEL Execution. It generally has one attribute, <code class="docutils literal notranslate"><span class="pre">filter</span></code> which is the
current <code class="docutils literal notranslate"><span class="pre">CELFilter</span></code> instance.</p></li>
</ol>
</section>
<section id="c7n-context-object">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">C7N Context Object</a><a class="headerlink" href="#c7n-context-object" title="Link to this heading">¶</a></h2>
<p>A global <code class="docutils literal notranslate"><span class="pre">C7N</span></code> object in the <a class="reference internal" href="api.html#module-celpy.c7nlib" title="celpy.c7nlib"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celpy.c7nlib</span></code></a> module contains a reference to the current <code class="docutils literal notranslate"><span class="pre">CELFilter</span></code> instance.
This has a single attribite.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">C7N.filter</span></code> is the current <code class="xref py py-class docutils literal notranslate"><span class="pre">CELFilter</span></code> instance.
This is a subclass of <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.filters.core.Filter</span></code>.
It provides the resource manager, useful to getting cloud provider client connections.
The <code class="docutils literal notranslate"><span class="pre">C7N.filter.manager</span></code> can be used to gather additional cloud provider data.
In many cases, a number of additional functions are also present in this class.</p></li>
</ul>
<p>A number of filter expressions rely on data not directly avalable in the <code class="docutils literal notranslate"><span class="pre">resource</span></code> or <code class="docutils literal notranslate"><span class="pre">event</span></code> objects.
These are called <em>related resource</em> filters, and there are several examples.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">image</span></code> and <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">image-age</span></code> filters gather details about the image associated with a resource
like an ec2.
These filter types are handled by the <code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.image()</span></code> function.
This uses <code class="docutils literal notranslate"><span class="pre">C7N.filter.get_instance_image()</span></code>.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">CELFilter</span></code> implementation should be a mixin shared by the C7N <code class="xref py py-class docutils literal notranslate"><span class="pre">ImageAge</span></code> class.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">metrics</span></code> filter provides metrics information for those resources that create CloudWatch metrics.
This filter type is handled by the <code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_raw_metrics()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_metrics()</span></code> functions.
This uses methods extracted from the C7N <code class="xref py py-class docutils literal notranslate"><span class="pre">Metrics</span></code> filter class.
It also uses the <code class="docutils literal notranslate"><span class="pre">C7N.filter.manager.get_model()</span></code> and <code class="docutils literal notranslate"><span class="pre">C7N.filter.manager.resource_type</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">security-group</span></code> filter gathers the security group details and security group IDs.
These filter types are handled by the <code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.security_group()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_related_ids()</span></code> functions.
These use <code class="docutils literal notranslate"><span class="pre">C7N.filter.get_related_ids()</span></code> and <code class="docutils literal notranslate"><span class="pre">C7N.filter.get_related()</span></code> functions.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">CELFilter</span></code> implementation should be the C7N <code class="xref py py-class docutils literal notranslate"><span class="pre">RelatedResourceFilter</span></code> class.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">subnet</span></code> filter gathers the subnet details.
This filter type is handled by the <code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.subnet()</span></code> function.
This uses  the <code class="docutils literal notranslate"><span class="pre">C7N.filter.get_related()</span></code> function.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">CELFilter</span></code> implementation should be the C7N <code class="xref py py-class docutils literal notranslate"><span class="pre">RelatedResourceFilter</span></code> class.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">flow-logs</span></code> filter gathers the flow logs from those resources that support this kind of logging.
This filter type is handled by the <code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.flow_logs()</span></code> function.
This uses code extracted from the C7N <code class="docutils literal notranslate"><span class="pre">vpc.FlowLogFilter</span></code> class.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">CELFilter</span></code> implementation should be the C7N <code class="xref py py-class docutils literal notranslate"><span class="pre">vpc.FlowLogFilter</span></code> class.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">vpc</span></code> filter gather information about the VPC’s used to host resources.
This filter type is handled by the <code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.vpc()</span></code> function.
This uses  the <code class="docutils literal notranslate"><span class="pre">C7N.filter.get_related()</span></code> function.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">CELFilter</span></code> implementation should be the C7N <code class="xref py py-class docutils literal notranslate"><span class="pre">RelatedResourceFilter</span></code> class.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">credentials</span></code> filter gathers information about IAM role credentials.
This filter type is handled by the <code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.credentials()</span></code> function.
This uses the <code class="docutils literal notranslate"><span class="pre">C7N.filter.get_credential_report()</span></code> function.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">CELFilter</span></code> implementation should be a mixin shared by the C7N <code class="xref py py-class docutils literal notranslate"><span class="pre">iam.CredentialReport</span></code> class.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">kms-alias</span></code> filter gathers information about KMS alias attributes.
This filter type is handled by the <code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.kms_alias()</span></code> function.
This uses the <code class="docutils literal notranslate"><span class="pre">C7N.filter.get_matching_aliases()</span></code> function.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">CELFilter</span></code> implementation should be the mixin shared by the C7N <code class="xref py py-class docutils literal notranslate"><span class="pre">ebs.KmsKeyAlias</span></code> class.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">kms-key</span></code> filter gathers information about KMS key attributes.
This filter type is handled by the <code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.kms_key()</span></code> function.
This uses the <code class="docutils literal notranslate"><span class="pre">C7N.filter.get_related()</span></code> function.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">CELFilter</span></code> implementation should be the C7N <code class="xref py py-class docutils literal notranslate"><span class="pre">RelatedResourceFilter</span></code> class.</p></li>
</ul>
<p>Note that this implies refactoring of C7N filters to provide a unified access to a number of pieces of data
from a single <code class="docutils literal notranslate"><span class="pre">CELFilter</span></code> class.
Currently, the functionality is scattered among several <code class="xref py py-class docutils literal notranslate"><span class="pre">Filter</span></code> subclasses and mixins.</p>
</section>
<section id="celfilter-design">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">CELFilter Design</a><a class="headerlink" href="#celfilter-design" title="Link to this heading">¶</a></h2>
<p>This processing must be refactored into a <code class="xref py py-class docutils literal notranslate"><span class="pre">CELFilter</span></code> subclass of <code class="xref py py-class docutils literal notranslate"><span class="pre">Filter</span></code>.
All the mixins currently part of more specialized filters need to be collected into this class.
In some cases, functionality must be extracted from existing filters to create mixins which can be shared
by the  <code class="xref py py-class docutils literal notranslate"><span class="pre">CELFilter</span></code> class.</p>
<p>For example, t:py:class:<cite>ImageAge</cite> filter is a composite, built from <code class="xref py py-class docutils literal notranslate"><span class="pre">AgeFilter</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">InstanceImageBase</span></code>.
In this case, the <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.resources.ec2.InstanceImageBase</span></code> class gathers AMI image details.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">CELFilter</span></code> needs to have the  <code class="xref py py-class docutils literal notranslate"><span class="pre">InstanceImageBase</span></code> mixin available to gather
the required data for the CEL operation.</p>
<p>This is a subclass of Subclass of c7n.filters.core.Filter.
See the <a class="reference internal" href="api.html#module-celpy.c7nlib" title="celpy.c7nlib"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celpy.c7nlib</span></code></a> module for additional information on this interface.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">InstanceImageMixin</span><span class="p">:</span>
    <span class="c1"># from :py:class:`InstanceImageBase` refactoring</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_instance_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RelatedResourceMixin</span><span class="p">:</span>
    <span class="c1"># from :py:class:`RelatedResourceFilter` mixin</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_related_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_related</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CredentialReportMixin</span><span class="p">:</span>
    <span class="c1"># from :py:class:`c7n.resources.iam.CredentialReport` filter.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_credential_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ResourceKmsKeyAliasMixin</span><span class="p">:</span>
    <span class="c1"># from :py:class:`c7n.resources.kms.ResourceKmsKeyAlias`</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_matching_aliases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CrossAccountAccessMixin</span><span class="p">:</span>
    <span class="c1"># from :py:class:`c7n.filters.iamaccessfilter.CrossAccountAccessFilter`</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_accounts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_vpcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_vpces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_orgids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="c1"># from :py:class:`c7n.resources.secretsmanager.CrossAccountAccessFilter`</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SNSCrossAccountMixin</span><span class="p">:</span>
    <span class="c1"># from :py:class:`c7n.resources.sns.SNSCrossAccount`</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_protocols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ImagesUnusedMixin</span><span class="p">:</span>
    <span class="c1"># from :py:class:`c7n.resources.ami.ImageUnusedFilter`</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_pull_ec2_images</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_pull_asg_images</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SnapshotUnusedMixin</span><span class="p">:</span>
    <span class="c1"># from :py:class:`c7n.resources.ebs.SnapshotUnusedFilter`</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_pull_asg_snapshots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_pull_ami_snapshots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">IamRoleUsageMixin</span><span class="p">:</span>
    <span class="c1"># from :py:class:`c7n.resources.iam.IamRoleUsage`</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_role_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">instance_profile_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SGUsageMixin</span><span class="p">:</span>
    <span class="c1"># from :py:class:`c7n.resources.vpc.SGUsage`</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">scan_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">IsShieldProtectedMixin</span><span class="p">:</span>
    <span class="c1"># from :py:mod:`c7n.resources.shield`</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_type_protections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ShieldEnabledMixin</span><span class="p">:</span>
    <span class="c1"># from :py:class:`c7n.resources.account.ShieldEnabled`</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">account_shield_subscriptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CELFilter</span><span class="p">(</span>
    <span class="n">InstanceImageMixin</span><span class="p">,</span> <span class="n">RelatedResourceMixin</span><span class="p">,</span> <span class="n">CredentialReportMixin</span><span class="p">,</span>
    <span class="n">ResourceKmsKeyAliasMixin</span><span class="p">,</span> <span class="n">CrossAccountAccessMixin</span><span class="p">,</span> <span class="n">SNSCrossAccountMixin</span><span class="p">,</span>
    <span class="n">ImagesUnusedMixin</span><span class="p">,</span> <span class="n">SnapshotUnusedMixin</span><span class="p">,</span> <span class="n">IamRoleUsageMixin</span><span class="p">,</span> <span class="n">SGUsageMixin</span><span class="p">,</span>
    <span class="n">c7n</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Filter</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    State a filter as a CEL expression.</span>

<span class="sd">    The activation environment for CEL has all the functions in ``c7nlib``.</span>

<span class="sd">    It also includes three global objects:</span>

<span class="sd">    -   ``resource`` the cloud resource to be examined.</span>

<span class="sd">    -   ``now`` the current time as a CEL timestamp.</span>

<span class="sd">    -   ``event`` an event for those resources where the C7N check is triggered by a CloudWatch event.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">type_schema</span><span class="p">(</span>
        <span class="s1">&#39;cel&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;enum&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;cel&#39;</span><span class="p">]},</span>
        <span class="s1">&#39;expr&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">}</span>
    <span class="p">)</span>

    <span class="n">decls</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">celpy</span><span class="o">.</span><span class="n">Annotation</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;resource&quot;</span><span class="p">:</span> <span class="n">celpy</span><span class="o">.</span><span class="n">celtypes</span><span class="o">.</span><span class="n">MapType</span><span class="p">,</span>
        <span class="s2">&quot;now&quot;</span><span class="p">:</span> <span class="n">celpy</span><span class="o">.</span><span class="n">celtypes</span><span class="o">.</span><span class="n">TimestampType</span><span class="p">,</span>
        <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="n">celpy</span><span class="o">.</span><span class="n">celtypes</span><span class="o">.</span><span class="n">MapType</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">decls</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">celpy</span><span class="o">.</span><span class="n">c7nlib</span><span class="o">.</span><span class="n">DECLARATIONS</span><span class="p">)</span>

    <span class="n">env</span> <span class="o">=</span> <span class="n">celpy</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span><span class="n">annotations</span><span class="o">=</span><span class="n">CELFilter</span><span class="o">.</span><span class="n">decls</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">manager</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">manager</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;cel&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expr</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;expr&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">c7n</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">offhours</span><span class="o">.</span><span class="n">ScheduleParser</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compile and build CEL&quot;&quot;&quot;</span>
        <span class="n">cel_env</span> <span class="o">=</span> <span class="n">celpy</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span>
            <span class="n">annotations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decls</span><span class="p">,</span>
            <span class="n">runner_class</span><span class="o">=</span><span class="n">c7nlib</span><span class="o">.</span><span class="n">C7N_Interpreted_Runner</span><span class="p">)</span>
        <span class="n">cel_ast</span> <span class="o">=</span> <span class="n">cel_env</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pgm</span> <span class="o">=</span> <span class="n">cel_env</span><span class="o">.</span><span class="n">program</span><span class="p">(</span><span class="n">cel_ast</span><span class="p">,</span> <span class="n">functions</span><span class="o">=</span><span class="n">celpy</span><span class="o">.</span><span class="n">c7nlib</span><span class="o">.</span><span class="n">FUNCTIONS</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">resources</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">celpy</span><span class="o">.</span><span class="n">celtypes</span><span class="o">.</span><span class="n">MapType</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">celpy</span><span class="o">.</span><span class="n">celtypes</span><span class="o">.</span><span class="n">MapType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply CEL to the various resources.&quot;&quot;&quot;</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">resources</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">C7NContext</span><span class="p">(</span><span class="nb">filter</span><span class="o">=</span><span class="n">the_filter</span><span class="p">):</span>
                <span class="n">cel_activation</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;resource&quot;</span><span class="p">:</span> <span class="n">celpy</span><span class="o">.</span><span class="n">json_to_cel</span><span class="p">(</span><span class="n">resource</span><span class="p">),</span>
                    <span class="s2">&quot;now&quot;</span><span class="p">:</span> <span class="n">celpy</span><span class="o">.</span><span class="n">celtypes</span><span class="o">.</span><span class="n">TimestampType</span><span class="p">(</span><span class="n">now</span><span class="p">),</span>
                    <span class="c1"># &quot;event&quot;: ...,</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pgm</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">cel_activation</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="n">resource</span>
</pre></div>
</div>
<p>This is a suggested interface. It seems to fit the outline of many other filters.
It’s not perfectly clear how event-based filters fit this model.</p>
</section>
<section id="c7n-cache">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">C7N Cache</a><a class="headerlink" href="#c7n-cache" title="Link to this heading">¶</a></h2>
<p>Within C7N, related resource information is cached to avoid repeatedly looking it up.
The CEL activation makes use of these caches through several global objects.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">Resource</span></code> provided is a JSON-to-CEL mapping of the original C7N dictionary.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">C7NContext</span></code> instance is used by The CEL functions in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">c7nlib</span></code> module to access c7n modules and classes.
This allows them to use C7N’s caching and avoid extra describe operations.
<em>All</em> cloud resource access must go through existing C7N <code class="docutils literal notranslate"><span class="pre">CELFilter</span></code> methods and resource caches.</p></li>
</ul>
</section>
<section id="common-c7n-constructs">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Common C7N Constructs</a><a class="headerlink" href="#common-c7n-constructs" title="Link to this heading">¶</a></h2>
<p>The C7N shorthand <code class="docutils literal notranslate"><span class="pre">tag:Name</span></code> doesn’t translate well to CEL. It extracts a single value
from a sequence of objects with a <code class="docutils literal notranslate"><span class="pre">{&quot;Key&quot;:</span> <span class="pre">x,</span> <span class="pre">&quot;Value&quot;:</span> <span class="pre">y}</span></code> structure; specifically,
the value for <code class="docutils literal notranslate"><span class="pre">y</span></code> when <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">==</span> <span class="pre">&quot;Name&quot;</span></code>.</p>
<p>If we want to check the value associated with the “Uptime” tag
to see if it is in some list of valid values, we have something like this.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Resource</span><span class="p">[</span><span class="s2">&quot;Tags&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Name&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;Value&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>This seems bulky, but it’s workable within the CEL language.</p>
<p>We can replace this with a <code class="docutils literal notranslate"><span class="pre">key(Resource,</span> <span class="pre">&quot;Name&quot;)</span></code> function. This can be used
as <code class="docutils literal notranslate"><span class="pre">Resource[&quot;Tags&quot;].key(&quot;Name&quot;)</span></code> preserving the original C7N syntax to an extent.
It has the <code class="docutils literal notranslate"><span class="pre">{&quot;Key&quot;:</span> <span class="pre">x,</span> <span class="pre">&quot;Value&quot;:</span> <span class="pre">y}</span></code> assumption wired-in.</p>
</section>
<section id="common-non-bool-filters">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Common/Non-Bool Filters</a><a class="headerlink" href="#common-non-bool-filters" title="Link to this heading">¶</a></h2>
<p>These are functions that provide data that is not trivially a boolean
decision. Because an explicit <code class="docutils literal notranslate"><span class="pre">op:</span></code> is provided in C7N, we can
map this to an CEL operator. This leads us to a function to extract
data from the C7N resource description, in a form that CEL can use.</p>
<section id="value">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">value</a><a class="headerlink" href="#value" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;value&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ssm-managed-instance, aws.iam-policy, aws.batch-definition, aws.iam-group, aws.shield-protection, aws.ecs, aws.fsx-backup, aws.ecs-container-instance, aws.eks, aws.support-case, aws.vpc, aws.rds-subscription, aws.network-addr, aws.message-broker, aws.redshift, aws.sagemaker-notebook, aws.glue-connection, aws.directory, aws.ebs-snapshot, aws.rds-cluster-param-group, aws.customer-gateway, aws.lambda-layer, aws.ecs-task, aws.subnet, aws.ec2, aws.cfn, aws.cloud-directory, aws.r53domain, aws.transit-gateway, aws.sns, aws.iam-role, aws.kinesis-analytics, aws.rds-param-group, aws.snowball-cluster, aws.codebuild, aws.efs, aws.elasticbeanstalk, aws.cache-snapshot, aws.security-group, aws.waf-regional, aws.dynamodb-table, aws.kms-key, aws.step-machine, aws.s3, aws.eni, aws.snowball, aws.elasticbeanstalk-environment, aws.lambda, aws.alarm, aws.ami, aws.sagemaker-endpoint-config, aws.app-elb-target-group, aws.simpledb, aws.hsm-client, aws.directconnect, aws.nat-gateway, aws.sagemaker-job, aws.emr, aws.glue-dev-endpoint, aws.rest-account, aws.fsx, aws.rest-resource, aws.codepipeline, aws.dlm-policy, aws.rds-cluster-snapshot, aws.hsm-hapg, aws.ecs-task-definition, aws.firehose, aws.secrets-manager, aws.asg, aws.rest-vpclink, aws.vpc-endpoint, aws.redshift-subnet-group, aws.iam-profile, aws.transit-attachment, aws.rest-stage, aws.rest-api, aws.distribution, aws.cache-subnet-group, aws.ecs-service, aws.event-rule-target, aws.identity-pool, aws.ssm-activation, aws.rds-snapshot, aws.app-elb, aws.ecr, aws.peering-connection, aws.ebs, aws.config-rule, aws.dax, aws.kinesis, aws.rrset, aws.batch-compute, aws.kms, aws.cloudtrail, aws.dynamodb-backup, aws.dms-endpoint, aws.sqs, aws.sagemaker-endpoint, aws.gamelift-build, aws.shield-attack, aws.dms-instance, aws.backup-plan, aws.key-pair, aws.iot, aws.hostedzone, aws.log-group, aws.rds-subnet-group, aws.cache-cluster, aws.hsm, aws.vpn-gateway, aws.sagemaker-transform-job, aws.route-table, aws.dynamodb-stream, aws.redshift-snapshot, aws.efs-mount-target, aws.codecommit, aws.glacier, aws.elasticsearch, aws.event-rule, aws.ssm-parameter, aws.rds, aws.sagemaker-model, aws.account, aws.cloudhsm-cluster, aws.waf, aws.vpn-connection, aws.iam-certificate, aws.iam-user, aws.streaming-distribution, aws.ml-model, aws.network-acl, aws.health-event, aws.launch-config, aws.rds-cluster, aws.storage-gateway, aws.healthcheck, aws.opswork-cm, aws.opswork-stack, aws.user-pool, aws.acm-certificate, aws.datapipeline, aws.elb, aws.gamelift-fleet, aws.cloudsearch, aws.internet-gateway</p>
<p>No implementation for value.
Policies studied have 5103 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-invalid-asv-value-notify</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Report on any ASGs that use an ASV that isn&#39;t valid.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_asv</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all_values.*</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-asg-ancient-image-delete</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Delete any ASG that uses an AMI that is over 60 days old.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">LaunchConfigurationName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:ASV&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:BA&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-asg-ancient-image-delete</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Delete any ASG that uses an AMI that is over 60 days old.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">LaunchConfigurationName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:ASV&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:BA&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">value</span></code> clauses are the base case. There’s nothing particularly special of complex here.
These are handled directly by translating the C7N <code class="docutils literal notranslate"><span class="pre">op:</span></code> field to a CEL operator.</p>
</section>
<section id="op-implementations">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">op Implementations</a><a class="headerlink" href="#op-implementations" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>C7N</p></th>
<th class="head"><p>CEL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘eq’</p></td>
<td><p>==</p></td>
</tr>
<tr class="row-odd"><td><p>‘equal’</p></td>
<td><p>==</p></td>
</tr>
<tr class="row-even"><td><p>‘ne’</p></td>
<td><p>!=</p></td>
</tr>
<tr class="row-odd"><td><p>‘not-equal’</p></td>
<td><p>!=</p></td>
</tr>
<tr class="row-even"><td><p>‘gt’</p></td>
<td><p>&gt;</p></td>
</tr>
<tr class="row-odd"><td><p>‘greater-than’</p></td>
<td><p>&gt;</p></td>
</tr>
<tr class="row-even"><td><p>‘ge’</p></td>
<td><p>&gt;=</p></td>
</tr>
<tr class="row-odd"><td><p>‘gte’</p></td>
<td><p>&gt;=</p></td>
</tr>
<tr class="row-even"><td><p>‘le’</p></td>
<td><p>&lt;</p></td>
</tr>
<tr class="row-odd"><td><p>‘lte’</p></td>
<td><p>&lt;=</p></td>
</tr>
<tr class="row-even"><td><p>‘lt’</p></td>
<td><p>&lt;</p></td>
</tr>
<tr class="row-odd"><td><p>‘less-than’</p></td>
<td><p>&lt;</p></td>
</tr>
<tr class="row-even"><td><p>‘glob’</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>‘regex’</p></td>
<td><p>string.matches(regex)</p></td>
</tr>
<tr class="row-even"><td><p>‘in’</p></td>
<td><p>string.contains(item) list.contains(item)</p></td>
</tr>
<tr class="row-odd"><td><p>‘ni’</p></td>
<td><p>~string.contains(item) ~list.contains(item)</p></td>
</tr>
<tr class="row-even"><td><p>‘not-in’</p></td>
<td><p>~string.contains(item) ~list.contains(item)</p></td>
</tr>
<tr class="row-odd"><td><p>‘contains’</p></td>
<td><p>string.contains(item) list.contains(item)</p></td>
</tr>
<tr class="row-even"><td><p>‘difference’</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>‘intersect’</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>There are three additional functions required:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.glob()</span></code> to implement <code class="docutils literal notranslate"><span class="pre">fnmatch.fnmatch(value,</span> <span class="pre">pattern)</span></code>.</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.difference()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.intersect()</span></code></p></li>
</ul>
</section>
<section id="value-type-conversions">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">value_type Conversions</a><a class="headerlink" href="#value-type-conversions" title="Link to this heading">¶</a></h3>
<p>This is part of the <code class="docutils literal notranslate"><span class="pre">value</span></code> filter expression. There are several value type conversions performed.
These are generally implemented in <code class="xref py py-meth docutils literal notranslate"><span class="pre">c7n.filters.core.ValueFilter.process_value_type()</span></code>
This accepts sentinel (from the filter) and value (from the resource).
It returns two values: the sentinel and, generally, a converted value that should have the same type as the resource.</p>
<ul class="simple">
<li><p>‘age’ – <code class="docutils literal notranslate"><span class="pre">parse_date(value),</span> <span class="pre">datetime.datetime.now(tz=tzutc())</span> <span class="pre">-</span> <span class="pre">timedelta(sentinel)</span></code>
Note that these are reversed to make it easier to compare age against a given value.
A global <code class="docutils literal notranslate"><span class="pre">Now</span></code> variable removes the need for an implicit age computation.
The <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_date()</span></code> is the <code class="xref py py-func docutils literal notranslate"><span class="pre">pendulum.parse()</span></code> function.</p></li>
<li><p>‘integer’ – <code class="docutils literal notranslate"><span class="pre">sentinel,</span> <span class="pre">int(str(value).strip())</span></code></p></li>
<li><p>‘expiration’ – <code class="docutils literal notranslate"><span class="pre">datetime.datetime.now(tz=tzutc())</span> <span class="pre">+</span> <span class="pre">timedelta(sentinel),</span> <span class="pre">parse_date(value)</span></code>
A global <code class="docutils literal notranslate"><span class="pre">Now</span></code> variable removes the need for an implicit expiration computation.
The <code class="xref py py-func docutils literal notranslate"><span class="pre">parse_date()</span></code> is the <code class="xref py py-func docutils literal notranslate"><span class="pre">pendulum.parse()</span></code> function.</p></li>
<li><p>‘normalize’ – <code class="docutils literal notranslate"><span class="pre">sentinel,</span> <span class="pre">value.strip().lower()</span></code></p></li>
<li><p>‘size’ – <code class="docutils literal notranslate"><span class="pre">sentinel,</span> <span class="pre">len(value)</span></code></p></li>
<li><p>‘cidr’ – <code class="docutils literal notranslate"><span class="pre">parse_cidr(sentinel),</span> <span class="pre">parse_cidr(value)</span></code>
See <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">c7n.utils</span> <span class="pre">import</span> <span class="pre">set_annotation,</span> <span class="pre">type_schema,</span> <span class="pre">parse_cidr</span></code>
(It appears this is not used.)</p></li>
<li><p>‘cidr_size’ – <code class="docutils literal notranslate"><span class="pre">sentinel,</span> <span class="pre">parse_cidr(value).prefixlen</span></code>
(It appears this is used rarely and is always part of a Cidr: filter primitive.)</p></li>
<li><p>‘swap’ – <code class="docutils literal notranslate"><span class="pre">value,</span> <span class="pre">sentinel</span></code>
This is needed because the implied order of DSL operands.
Without <code class="docutils literal notranslate"><span class="pre">swap</span></code>, the operation is <em>resource OP filter-value</em>.
With <code class="docutils literal notranslate"><span class="pre">swap</span></code> it’s <em>filter-value OP resource</em>.</p></li>
<li><p>‘unique_size’ – <code class="docutils literal notranslate"><span class="pre">len(set(value))</span></code>
(It appears this is not used.)</p></li>
<li><p>‘date’ – <code class="docutils literal notranslate"><span class="pre">parse_date(sentinel),</span> <span class="pre">parse_date(value)</span></code>
(It appears this is not used.)</p></li>
<li><p>‘version’ – <code class="docutils literal notranslate"><span class="pre">ComparableVersion(sentinel),</span> <span class="pre">ComparableVersion(value)</span></code>
(It appears this is not used.)</p></li>
</ul>
<p>The following are unusual value_type options. They’re part of the schema, but have special-seeming implementations
but aren’t widely used.</p>
<ul class="simple">
<li><p>‘expr’ – <code class="docutils literal notranslate"><span class="pre">self.get_resource_value(sentinel,</span> <span class="pre">resource)</span></code>
This seems to be widely used used in an action context and in a <code class="docutils literal notranslate"><span class="pre">value_from</span></code> element of a <code class="docutils literal notranslate"><span class="pre">value</span></code> clause.
It does not appear to be a general feature of filters.</p></li>
<li><p>‘resource_count’ – the op is applied to len(resources) instead of the resources.
This is handled specially in the <code class="xref py py-class docutils literal notranslate"><span class="pre">filters.core.ValueFilter</span></code> class.</p></li>
</ul>
<p>Some of these are directly available in CEL. See <a class="reference external" href="https://github.com/google/cel-spec/blob/master/doc/langdef.md#list-of-standard-definitions">https://github.com/google/cel-spec/blob/master/doc/langdef.md#list-of-standard-definitions</a>.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>C7N</p></th>
<th class="head"><p>CEL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘age’</p></td>
<td><p>duration()</p></td>
</tr>
<tr class="row-odd"><td><p>‘integer’</p></td>
<td><p>int()</p></td>
</tr>
<tr class="row-even"><td><p>‘expiration’</p></td>
<td><p>duration()</p></td>
</tr>
<tr class="row-odd"><td><p>‘normalize’</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>‘size’</p></td>
<td><p>size()</p></td>
</tr>
<tr class="row-odd"><td><p>‘cidr’</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>‘cidr_size’</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>‘expr’</p></td>
<td><p>this is generally resource[value]</p></td>
</tr>
<tr class="row-even"><td><p>‘unique_size’</p></td>
<td><p>size(set(value))</p></td>
</tr>
<tr class="row-odd"><td><p>‘date’</p></td>
<td><p>timestamp()</p></td>
</tr>
<tr class="row-even"><td><p>‘version’</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>‘resource_count’</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Additional functions are needed for a few of these operations:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.normalize()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.unique_size()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.parse_cidr()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.size_parse_cidr()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.version()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.present()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.absent()</span></code></p></li>
</ul>
<p>It would be sensible to follow some of the design patterns used by OPA for these extensions.
See <a class="reference external" href="https://www.openpolicyagent.org/docs/latest/policy-reference/#net">https://www.openpolicyagent.org/docs/latest/policy-reference/#net</a> for examples of CIDR-parsing.</p>
<p>‘swap’ is not needed because CEL allows reordering operands.</p>
</section>
<section id="value-from-external-data">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">value_from External Data</a><a class="headerlink" href="#value-from-external-data" title="Link to this heading">¶</a></h3>
<p>There are several sources for values other than literal values. This is defined by a <code class="docutils literal notranslate"><span class="pre">values_from</span></code> sub-clause.
The sub-clause includes up to three additional parameters</p>
<dl class="field-list simple">
<dt class="field-odd">url<span class="colon">:</span></dt>
<dd class="field-odd"><p>A URL points at the source of the data: S3 or HTTPS.</p>
</dd>
<dt class="field-even">format<span class="colon">:</span></dt>
<dd class="field-even"><p>One of json, csv, csv2dict, txt. This can be inferred from the suffix on the path in the URL.</p>
</dd>
<dt class="field-odd">expr<span class="colon">:</span></dt>
<dd class="field-odd"><p>This extracts specific fields from the raw data. Expression syntax:</p>
<ul class="simple">
<li><p>on json, a jmespath expr is evaluated.</p></li>
<li><p>on csv, an integer column or jmespath expr can be specified.</p></li>
<li><p>on csv2dict, a jmespath expr (the csv is parsed into a dictionary where
the keys are the headers and the values are the remaining columns).</p></li>
</ul>
</dd>
</dl>
<p>Text files are expected to be line delimited values.</p>
<p>While CEL doesn’t directly use JMESPath, it has some similarities.
We can use a <a class="reference internal" href="api.html#celpy.c7nlib.jmes_path" title="celpy.c7nlib.jmes_path"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.jmes_path()</span></code></a> function to explicitly handle C7N JMESPath.
We can also use the existing <code class="docutils literal notranslate"><span class="pre">map()</span></code> macro for simpler cases, like
extracting a column from a CSV.</p>
<p>C7N Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">value_from</span><span class="p">:</span>
   <span class="n">url</span><span class="p">:</span> <span class="n">s3</span><span class="p">:</span><span class="o">//</span><span class="n">bucket</span><span class="o">/</span><span class="n">xyz</span><span class="o">/</span><span class="n">foo</span><span class="o">.</span><span class="n">json</span>
   <span class="n">expr</span><span class="p">:</span> <span class="p">[]</span><span class="o">.</span><span class="n">AppId</span>

<span class="n">values_from</span><span class="p">:</span>
   <span class="n">url</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">foobar</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mydata</span>
   <span class="nb">format</span><span class="p">:</span> <span class="n">json</span>
   <span class="n">expr</span><span class="p">:</span> <span class="n">Region</span><span class="o">.</span><span class="s2">&quot;us-east-1&quot;</span><span class="p">[]</span><span class="o">.</span><span class="n">ImageId</span>

<span class="n">value_from</span><span class="p">:</span>
   <span class="n">url</span><span class="p">:</span> <span class="n">s3</span><span class="p">:</span><span class="o">//</span><span class="n">bucket</span><span class="o">/</span><span class="n">abc</span><span class="o">/</span><span class="n">foo</span><span class="o">.</span><span class="n">csv</span>
   <span class="nb">format</span><span class="p">:</span> <span class="n">csv2dict</span>
   <span class="n">expr</span><span class="p">:</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

 <span class="c1"># inferred from extension</span>
 <span class="nb">format</span><span class="p">:</span> <span class="p">[</span><span class="n">json</span><span class="p">,</span> <span class="n">csv</span><span class="p">,</span> <span class="n">csv2dict</span><span class="p">,</span> <span class="n">txt</span><span class="p">]</span>
</pre></div>
</div>
<p>(Yes, there’s a spelling mistake in one of the examples.)</p>
<p>Proposed CEL Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">value_from</span><span class="p">(</span><span class="s2">&quot;s3://bucket/xyz/foo.json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">AppId</span><span class="p">)</span>

<span class="n">value_from</span><span class="p">(</span><span class="s2">&quot;http://foobar.com/mydata&quot;</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">jmes_path</span><span class="p">(</span><span class="s1">&#39;Region.[&quot;us-east-1&quot;]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">ImageId</span><span class="p">)</span>

<span class="n">value_from</span><span class="p">(</span><span class="s2">&quot;s3://bucket/abc/foo.csv&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>This requires a suite of functions:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.text_from()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.parse_text()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.value_from()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.jmes_path()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.jmes_path_map()</span></code></p></li>
</ul>
</section>
<section id="marked-for-op">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">marked-for-op</a><a class="headerlink" href="#marked-for-op" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">skew</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;minimum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">}</span>
<span class="nt">skew_hours</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;minimum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">}</span>
<span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;marked-for-op&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">tz</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.fsx, aws.hostedzone, aws.log-group, aws.cache-cluster, aws.secrets-manager, aws.fsx-backup, aws.efs, aws.vpn-gateway, aws.cache-snapshot, aws.asg, aws.route-table, aws.security-group, aws.vpc-endpoint, aws.redshift-snapshot, aws.dynamodb-table, aws.kms-key, aws.vpc, aws.transit-attachment, aws.rest-stage, aws.glacier, aws.s3, aws.elasticsearch, aws.distribution, aws.message-broker, aws.redshift, aws.rds, aws.sagemaker-notebook, aws.sagemaker-model, aws.ssm-parameter, aws.eni, aws.ebs-snapshot, aws.network-addr, aws.vpn-connection, aws.elasticbeanstalk-environment, aws.rds-snapshot, aws.app-elb, aws.customer-gateway, aws.iam-user, aws.lambda, aws.streaming-distribution, aws.peering-connection, aws.network-acl, aws.ebs, aws.ami, aws.sagemaker-endpoint-config, aws.app-elb-target-group, aws.kinesis, aws.rds-cluster, aws.healthcheck, aws.subnet, aws.ec2, aws.sqs, aws.sagemaker-endpoint, aws.nat-gateway, aws.datapipeline, aws.emr, aws.elb, aws.transit-gateway, aws.internet-gateway, aws.dms-instance, aws.key-pair</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/mq.py</span></code> 48</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@MessageBroker</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">marked</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">op</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MarkedForOp</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 490 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dynamodb-untagged-delete</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Delete any DynamoDB tables whose delete date has arrived.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dynamodb-table</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete</span>
<span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_tagging</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marked-for-op</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">not</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ASV</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">                </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">                </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">                </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:BA</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">                </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">                </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">                </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerContact</span>
<span class="w">            </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">            </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:GroupName</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EMMO</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ApplicationName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:Environment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:Uptime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ApplicationName</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Environment</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Uptime</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dynamodb-untagged-two-day-warning</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Final warning for DynamoDB tables marked for delete.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dynamodb-table</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerContact</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">        </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerEID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerEID</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">        </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerEID</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(^[A-Za-z]{3}[0-9]{3}$)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete</span>
<span class="w">    </span><span class="nt">skew</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_tagging</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marked-for-op</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">not</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ASV</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">                </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">                </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">                </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:BA</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">                </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">                </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">                </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerContact</span>
<span class="w">            </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">            </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:GroupName</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EMMO</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ApplicationName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:Environment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:Uptime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ApplicationName</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Environment</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Uptime</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dynamodb-untagged-two-day-warning-no-owner</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Final warning for DynamoDB tables marked for delete.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dynamodb-table</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerContact</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">      </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerEID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerEID</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">      </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerEID</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(?!(^[A-Za-z]{3}[0-9]{3})$)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete</span>
<span class="w">    </span><span class="nt">skew</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_tagging</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marked-for-op</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">marked-for-op</span></code> filter is the obverse to the <code class="docutils literal notranslate"><span class="pre">mark-for-ap</span></code> action.
Both work with a complex tag value format.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">message</span><span class="p">:</span><span class="n">action</span><span class="nd">@action_date</span>
</pre></div>
</div>
<p>For a filter, there is a multi-step search.</p>
<ol class="arabic simple">
<li><p>Examine Tags, looking for the target Key  (default “custodian_status”).</p></li>
<li><p>Parse the value to get the three fields: mssage, action, and action_date.</p></li>
<li><p>Examine the action to see if it matches the <code class="docutils literal notranslate"><span class="pre">op:</span></code> value (default “stop”)</p></li>
<li><p>Compare the action_date with the current time, <code class="docutils literal notranslate"><span class="pre">Now</span></code> possibly offset
by the <code class="docutils literal notranslate"><span class="pre">skew:</span></code> and <code class="docutils literal notranslate"><span class="pre">skew_hours:</span></code> as well as <code class="docutils literal notranslate"><span class="pre">tz:</span></code> values.</p></li>
</ol>
<p>The two comparisons (operation and date) can be exposed as basic CEL.
This leaves the parsing of the tag as a feature for the interface library.</p>
<p>The following will parse the value, creating a Mapping that can be
used for subsequent processing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Resource</span><span class="p">[</span><span class="s2">&quot;Tags&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">marked_key</span><span class="p">(</span><span class="s2">&quot;custodian_status&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We expect something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Resource</span><span class="p">[</span><span class="s2">&quot;Tags&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">marked_key</span><span class="p">(</span><span class="s2">&quot;custodian_status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;stop&quot;</span>
<span class="o">&amp;&amp;</span> <span class="n">Now</span> <span class="o">&gt;=</span> <span class="n">Resource</span><span class="p">[</span><span class="s2">&quot;Tags&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">marked_key</span><span class="p">(</span><span class="s2">&quot;custodian_status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">action_date</span>
</pre></div>
</div>
<p>This will find items marked for action that are past due.</p>
<p>This requires one new function:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.marked_key()</span></code></p></li>
</ul>
</section>
<section id="image-age">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">image-age</a><a class="headerlink" href="#image-age" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;minimum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;image-age&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2, aws.asg, aws.ami</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ami.py</span></code> 189</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">image</span><span class="o">-</span><span class="n">age</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ImageAgeFilter</span>
</pre></div>
</div>
<p>Filters images based on the age (in days)</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ami-remove-launch-permissions</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ami</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">        </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 390</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">image</span><span class="o">-</span><span class="n">age</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ImageAge</span>
</pre></div>
</div>
<p>EC2 AMI age filter</p>
<p>Filters EC2 instances based on the age of their AMI image (in days)</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-ancient-ami</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
<span class="w">        </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">90</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/asg.py</span></code> 563</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">image</span><span class="o">-</span><span class="n">age</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ImageAgeFilter</span>
</pre></div>
</div>
<p>Filter asg by image age (in days).</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-older-image</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">        </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">90</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 318 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-asg-ancient-image-delete</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Delete any ASG that uses an AMI that is over 60 days old.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">LaunchConfigurationName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:ASV&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:BA&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-asg-ancient-image-delete-no-owner</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Delete any ASG that uses an AMI that is over 60 days old but has no OwnerContact info.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">LaunchConfigurationName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:ASV&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:BA&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-ec2-ami-age-35days-notify</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Send a warning to users when their AMI has reached 35 days of age</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">State.Name</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ne</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terminated</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">34.5</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">35.5</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lt</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:ASV&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:BA&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">image-age</span></code> filter examines data not directly part of the current <code class="docutils literal notranslate"><span class="pre">Resource</span></code> object.
An EC2, or ASG has an associated AMI, named with the <code class="docutils literal notranslate"><span class="pre">ImageId</span></code> attribute.
The AMI description has the <code class="docutils literal notranslate"><span class="pre">CreationDate</span></code>. This is one of many examples of related resource processing.</p>
<p>The value of <code class="docutils literal notranslate"><span class="pre">Now</span> <span class="pre">-</span> <span class="pre">Resource.image().CreationDate</span></code> is the image age,
as a <code class="xref py py-class docutils literal notranslate"><span class="pre">celtypes.DurationType</span></code> object.</p>
<p>This requires one new function:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.image()</span></code> depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_instance_image()</span></code>.</p></li>
</ul>
</section>
<section id="event">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">event</a><a class="headerlink" href="#event" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;event&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ssm-managed-instance, aws.iam-policy, aws.batch-definition, aws.iam-group, aws.shield-protection, aws.ecs, aws.fsx-backup, aws.ecs-container-instance, aws.eks, aws.support-case, aws.vpc, aws.rds-subscription, aws.network-addr, aws.message-broker, aws.redshift, aws.sagemaker-notebook, aws.glue-connection, aws.directory, aws.ebs-snapshot, aws.rds-cluster-param-group, aws.customer-gateway, aws.lambda-layer, aws.ecs-task, aws.subnet, aws.ec2, aws.cfn, aws.cloud-directory, aws.r53domain, aws.transit-gateway, aws.sns, aws.iam-role, aws.kinesis-analytics, aws.rds-param-group, aws.snowball-cluster, aws.codebuild, aws.efs, aws.elasticbeanstalk, aws.cache-snapshot, aws.security-group, aws.waf-regional, aws.dynamodb-table, aws.kms-key, aws.step-machine, aws.s3, aws.eni, aws.snowball, aws.elasticbeanstalk-environment, aws.lambda, aws.alarm, aws.ami, aws.sagemaker-endpoint-config, aws.app-elb-target-group, aws.simpledb, aws.hsm-client, aws.directconnect, aws.nat-gateway, aws.sagemaker-job, aws.emr, aws.glue-dev-endpoint, aws.rest-account, aws.fsx, aws.rest-resource, aws.codepipeline, aws.dlm-policy, aws.rds-cluster-snapshot, aws.hsm-hapg, aws.ecs-task-definition, aws.firehose, aws.secrets-manager, aws.asg, aws.rest-vpclink, aws.vpc-endpoint, aws.redshift-subnet-group, aws.iam-profile, aws.transit-attachment, aws.rest-stage, aws.rest-api, aws.distribution, aws.cache-subnet-group, aws.ecs-service, aws.event-rule-target, aws.identity-pool, aws.ssm-activation, aws.rds-snapshot, aws.app-elb, aws.ecr, aws.peering-connection, aws.ebs, aws.config-rule, aws.dax, aws.kinesis, aws.rrset, aws.batch-compute, aws.kms, aws.cloudtrail, aws.dynamodb-backup, aws.dms-endpoint, aws.sqs, aws.sagemaker-endpoint, aws.gamelift-build, aws.shield-attack, aws.dms-instance, aws.backup-plan, aws.key-pair, aws.iot, aws.hostedzone, aws.log-group, aws.rds-subnet-group, aws.cache-cluster, aws.hsm, aws.vpn-gateway, aws.sagemaker-transform-job, aws.route-table, aws.dynamodb-stream, aws.redshift-snapshot, aws.efs-mount-target, aws.codecommit, aws.glacier, aws.elasticsearch, aws.event-rule, aws.ssm-parameter, aws.rds, aws.sagemaker-model, aws.account, aws.cloudhsm-cluster, aws.waf, aws.vpn-connection, aws.iam-certificate, aws.iam-user, aws.streaming-distribution, aws.ml-model, aws.network-acl, aws.health-event, aws.launch-config, aws.rds-cluster, aws.storage-gateway, aws.healthcheck, aws.opswork-cm, aws.opswork-stack, aws.user-pool, aws.acm-certificate, aws.datapipeline, aws.elb, aws.gamelift-fleet, aws.cloudsearch, aws.internet-gateway</p>
<p>No implementation for event.
Policies studied have 125 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-using-key-pair-notify-new</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Any EC2 instance that use a KeyName (key pair) will generate a notification</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">detail.userAgent</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">event</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autoscaling.amazonaws.com</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">less-than</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KeyName</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-using-key-pair-notify-new</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Any EC2 instance that use a KeyName (key pair) will generate a notification</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">detail.userAgent</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">event</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autoscaling.amazonaws.com</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">less-than</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KeyName</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-using-key-pair-notify-new</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Any EC2 instance that use a KeyName (key pair) will generate a notification</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">detail.userAgent</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">event</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autoscaling.amazonaws.com</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">less-than</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KeyName</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">event</span></code> filter examines data not directly part of a resource.
A Lambda is changed by an event. This <code class="docutils literal notranslate"><span class="pre">event</span></code> detail is available in the activation along with the <code class="docutils literal notranslate"><span class="pre">resource</span></code>.</p>
</section>
<section id="metrics">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">metrics</a><a class="headerlink" href="#metrics" title="Link to this heading">¶</a></h3>
<p>See <a class="reference internal" href="#health-event">health-event</a> for a similar function.</p>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">attr-multiplier</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">dimensions</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">percent-attr</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">period</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">statistics</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;Average&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;Sum&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;Maximum&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;Minimum&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;SampleCount&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;metrics&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.log-group, aws.cache-cluster, aws.rds-param-group, aws.ecs, aws.firehose, aws.asg, aws.dynamodb-stream, aws.waf-regional, aws.dynamodb-table, aws.rest-api, aws.elasticsearch, aws.s3, aws.event-rule, aws.distribution, aws.message-broker, aws.redshift, aws.rds, aws.ecs-service, aws.waf, aws.rds-cluster-param-group, aws.app-elb, aws.lambda, aws.streaming-distribution, aws.ebs, aws.kinesis, aws.rds-cluster, aws.ec2, aws.dynamodb-backup, aws.opswork-stack, aws.sqs, aws.datapipeline, aws.emr, aws.elb, aws.cloudsearch, aws.sns</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/appelb.py</span></code> 167</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AppElbMetrics</span>
</pre></div>
</div>
<p>Filter app load balancer by metric values.</p>
<p>See available metrics here: <a class="reference external" href="https://goo.gl/TLQ9Fr">https://goo.gl/TLQ9Fr</a>
Custodian defaults to specifying dimensions for the app elb only.
Target Group dimension not supported atm.</p>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elasticsearch.py</span></code> 105</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ElasticSearchDomain</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Metrics</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/emr.py</span></code> 123</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@EMRCluster</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EMRMetrics</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/sqs.py</span></code> 99</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@SQS</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MetricsFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/cw.py</span></code> 97</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@EventRule</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EventRuleMetrics</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/mq.py</span></code> 66</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@MessageBroker</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MQMetrics</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/s3.py</span></code> 548</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">S3Metrics</span>
</pre></div>
</div>
<p>S3 CW Metrics need special handling for attribute/dimension
mismatch, and additional required dimension.</p>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ecs.py</span></code> 69</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ECSCluster</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ECSMetrics</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ecs.py</span></code> 182</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Service</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ServiceMetrics</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 111 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-unused-report</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Mark unused RDS instances that haven&#39;t had connections in 14 days</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_cleanup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ReadReplicaSourceDBInstanceIdentifier</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerContact</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">        </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerEID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerEID</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">        </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerEID</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(^[A-Za-z]{3}[0-9]{3}$)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">InstanceCreateTime</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gt</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">14</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">14</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DatabaseConnections</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">equal</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metrics</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-unused-report-no-owner</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Mark unused RDS instances that haven&#39;t had connections in 14 days</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_cleanup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ReadReplicaSourceDBInstanceIdentifier</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerContact</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">      </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerEID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerEID</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">      </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerEID</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(?!(^[A-Za-z]{3}[0-9]{3})$)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">InstanceCreateTime</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gt</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">14</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">14</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DatabaseConnections</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">equal</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metrics</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-under-utilized-cpu-network-tag-radistis</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tag a resource with underutilized CPU and Network I/O</span>
<span class="l l-Scalar l-Scalar-Plain">In addition, last resize action should be &gt;= 7 days and</span>
<span class="l l-Scalar l-Scalar-Plain">instance-age &gt; 7 days.</span>
<span class="l l-Scalar l-Scalar-Plain">Runs at 2 PM EST everyday</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">et</span>
<span class="w">    </span><span class="nt">offhour</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">14</span>
<span class="w">    </span><span class="nt">opt-out</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">offhour</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:resize-backoff</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resize</span>
<span class="w">      </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resize-backoff</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marked-for-op</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gt</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CPUUtilization</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">less-than</span>
<span class="w">    </span><span class="nt">period</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">612000</span>
<span class="w">    </span><span class="nt">statistics</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Average</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metrics</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CPUUtilization</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">less-than</span>
<span class="w">    </span><span class="nt">period</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">612000</span>
<span class="w">    </span><span class="nt">statistics</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Maximum</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metrics</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkIn</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">less-than</span>
<span class="w">      </span><span class="nt">period</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">612000</span>
<span class="w">      </span><span class="nt">statistics</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Maximum</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metrics</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2500000</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkOut</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">less-than</span>
<span class="w">      </span><span class="nt">period</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">612000</span>
<span class="w">      </span><span class="nt">statistics</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Maximum</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metrics</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2500000</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>There are two parts to this.</p>
<ol class="arabic simple">
<li><p>Getting raw metric statistics from the cloud provider.
The <a class="reference internal" href="api.html#celpy.c7nlib.get_raw_metrics" title="celpy.c7nlib.get_raw_metrics"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.get_raw_metrics()</span></code></a> is refactored
from the <code class="docutils literal notranslate"><span class="pre">Metrics</span></code> filter into <a class="reference internal" href="api.html#celpy.c7nlib.get_raw_metrics" title="celpy.c7nlib.get_raw_metrics"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.get_raw_metrics()</span></code></a> function.</p></li>
<li><p>Getting metric statistics for a specific resource.
The <a class="reference internal" href="api.html#celpy.c7nlib.get_metrics" title="celpy.c7nlib.get_metrics"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.get_metrics()</span></code></a> function takes parameters for period, start, end,
and the statistics value to compute. The dimension comes from the Resource.
This uses <a class="reference internal" href="api.html#celpy.c7nlib.get_raw_metrics" title="celpy.c7nlib.get_raw_metrics"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.get_raw_metrics()</span></code></a>.</p></li>
</ol>
<p>Generally, C7N requests in bunches of 50 per client connection.
A worker pool processes the batches to keep from overwhelming AWS with
metrics requests.</p>
<p>See <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.filters.metrics.MetricsFilter</span></code>. This filter collects
metrics and applies the filter decision to items in each batch.
The <code class="xref py py-meth docutils literal notranslate"><span class="pre">process()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">process_resource_set()</span></code> methods
need to be refactored into several pieces:</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_resource_set()</span></code>. This is the existing interface.
This calls <code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_query()</span></code> to create the various query
parameters.  It then creates a worker pool and applies <code class="xref py py-meth docutils literal notranslate"><span class="pre">process_resource_set()</span></code>
to chunks of 50 resources.</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_query()</span></code>. This is new. It prepares the parameters
for <code class="xref py py-meth docutils literal notranslate"><span class="pre">client.get_metric_statistics()</span></code>.</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_resource_set()</span></code>. This is the existing interface.
It gets a client and then calls <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_resource_statistics()</span></code> with the client
and each resource. It calls <code class="xref py py-meth docutils literal notranslate"><span class="pre">filter_resource_statistics()</span></code> on the results
of <code class="xref py py-meth docutils literal notranslate"><span class="pre">client.get_metric_statistics()</span></code>.</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_resource_statistics()</span></code>. Given a client and a resource,
this function will set the resource’s <code class="docutils literal notranslate"><span class="pre">&quot;c7n.metrics&quot;</span></code> attribute with current
statistics. This is the <code class="docutils literal notranslate"><span class="pre">['Datapoints']</span></code> value. It returns the [self.statistics]
item from each dictionary in the metrics list of dictionaries.</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter_resource_statistics()</span></code>. Given a resource, this function will apply the
missing-value, the percent-attr and attr-multiplier transformations to the
resource’s <code class="docutils literal notranslate"><span class="pre">&quot;c7n.metrics&quot;</span></code>.
It will apply the filter op and value. All of these things better represented in CEL.</p></li>
</ul>
<p>This requires two extension functions:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_raw_metrics()</span></code> depends on <code class="xref py py-attr docutils literal notranslate"><span class="pre">CELFilter.manager</span></code>.</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_metrics()</span></code> depends on <code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_raw_metrics()</span></code></p></li>
</ul>
</section>
<section id="age">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">age</a><a class="headerlink" href="#age" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.redshift-snapshot, aws.rds-snapshot, aws.rds-cluster-snapshot, aws.cache-snapshot, aws.launch-config, aws.ebs-snapshot</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/redshift.py</span></code> 643</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@RedshiftSnapshot</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RedshiftSnapshotAge</span>
</pre></div>
</div>
<p>Filters redshift snapshots based on age (in days)</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redshift-old-snapshots</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redshift-snapshot</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">        </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">21</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gt</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rds.py</span></code> 1045</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@RDSSnapshot</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RDSSnapshotAge</span>
</pre></div>
</div>
<p>Filters RDS snapshots based on age (in days)</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-snapshot-expired</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-snapshot</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">        </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">28</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elasticache.py</span></code> 325</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ElastiCacheSnapshot</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ElastiCacheSnapshotAge</span>
</pre></div>
</div>
<p>Filters elasticache snapshots based on their age (in days)</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elasticache-stale-snapshots</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cache-snapshot</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">        </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rdscluster.py</span></code> 436</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@RDSClusterSnapshot</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RDSSnapshotAge</span>
</pre></div>
</div>
<p>Filters rds cluster snapshots based on age (in days)</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-cluster-snapshots-expired</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-cluster-snapshot</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">        </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gt</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/asg.py</span></code> 1704</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@LaunchConfig</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LaunchConfigAge</span>
</pre></div>
</div>
<p>Filter ASG launch configuration by age (in days)</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-launch-config-old</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch-config</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">        </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">90</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ebs.py</span></code> 154</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Snapshot</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SnapshotAge</span>
</pre></div>
</div>
<p>EBS Snapshot Age Filter</p>
<p>Filters an EBS snapshot based on the age of the snapshot (in days)</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs-snapshots-week-old</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs-snapshot</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">        </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 101 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-ebs-snapshot-manual-mark</span>
<span class="nt">comments</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs manual snapshots older than 30 days will be marked and deleted in 7 days.</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs-snapshot</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">skip-ami-snapshots</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_snapshot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:fs_manual_ebs_snapshot_expiring</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:exceptionmanualsnapshot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VolumeId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ne</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vol-ffffffff</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SnapshotId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">accounts.&quot;{account_id}&quot;.ebs.snapshots.*[][]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SnapshotId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.[&quot;ebs-snapshot&quot;][].snapshot.[&quot;SnapshotId&quot;][].*[].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gte</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-rds-snapshot-manual-mark</span>
<span class="nt">comments</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RDS manual snapshots older than 30 days will be marked and deleted in 7 days.</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-snapshot</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:exceptionmanualsnapshot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:fs_manual_rds_snapshot_expiring</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SnapshotType</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">manual</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gte</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-launch-config-unused-gt-60-days</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Delete unused launch configurations.</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch-config</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gt</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unused</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">age</span></code> filter refers to an attribute with slightly varying names across resource types.
The C7N DSL conceals these variations.
There doesn’t seem to be a good reason to conceal the slight variations in the attribute
name.</p>
<p>This leads to a number of variants, depending on the resource type</p>
<ul class="simple">
<li><p>launch-config: <code class="docutils literal notranslate"><span class="pre">Now</span> <span class="pre">-</span> <span class="pre">timestamp(Resource.CreatedTime)</span> <span class="pre">&gt;</span> <span class="pre">duration(&quot;21d&quot;)</span></code></p></li>
<li><p>ebs-snapshot: <code class="docutils literal notranslate"><span class="pre">Now</span> <span class="pre">-</span> <span class="pre">timestamp(Resource.StartTime)</span> <span class="pre">&gt;</span> <span class="pre">duration(&quot;21d&quot;)</span></code></p></li>
<li><p>cache-snapshot: <code class="docutils literal notranslate"><span class="pre">Now</span> <span class="pre">-</span> <span class="pre">timestamp(Resource.NodeSnaphots.min(x,</span> <span class="pre">x.SnapshotCreateTime))</span> <span class="pre">&gt;</span> <span class="pre">duration(&quot;21d&quot;)</span></code></p></li>
<li><p>rds-snapshot: <code class="docutils literal notranslate"><span class="pre">Now</span> <span class="pre">-</span> <span class="pre">timestamp(Resource.SnapshotCreateTime)</span> <span class="pre">&gt;</span> <span class="pre">duration(&quot;21d&quot;)</span></code></p></li>
<li><p>rds-cluster-snapshot: <code class="docutils literal notranslate"><span class="pre">Now</span> <span class="pre">-</span> <span class="pre">timestamp(Resource.SnapshotCreateTime)</span> <span class="pre">&gt;</span> <span class="pre">duration(&quot;21d&quot;)</span></code></p></li>
<li><p>redshift-snapshot: <code class="docutils literal notranslate"><span class="pre">Now</span> <span class="pre">-</span> <span class="pre">timestamp(Resource.SnapshotCreateTime)</span> <span class="pre">&gt;</span> <span class="pre">duration(&quot;21d&quot;)</span></code></p></li>
</ul>
<p>This requires one extension function:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.image()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_instance_image()</span></code></p></li>
</ul>
</section>
<section id="security-group">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">security-group</a><a class="headerlink" href="#security-group" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">match-resource</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;and&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;or&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;security-group&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.cache-cluster, aws.codebuild, aws.asg, aws.vpc-endpoint, aws.eks, aws.efs-mount-target, aws.vpc, aws.elasticsearch, aws.message-broker, aws.redshift, aws.rds, aws.glue-connection, aws.sagemaker-notebook, aws.directory, aws.eni, aws.app-elb, aws.lambda, aws.dax, aws.rds-cluster, aws.batch-compute, aws.ec2, aws.elb, aws.dms-instance</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/redshift.py</span></code> 100</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityGroupFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/appelb.py</span></code> 184</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityGroupFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 178</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Vpc</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">VpcSecurityGroupFilter</span>
</pre></div>
</div>
<p>Filter VPCs based on Security Group attributes</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gray-vpcs</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Color</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Gray</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1211</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@NetworkInterface</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InterfaceSecurityGroupFilter</span>
</pre></div>
</div>
<p>Network interface security group filter</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-interface-ssh</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eni</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="w">        </span><span class="nt">match-resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FromPort</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">22</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1787</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@VpcEndpoint</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EndpointSecurityGroupFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elasticsearch.py</span></code> 93</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ElasticSearchDomain</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityGroup</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rds.py</span></code> 293</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityGroupFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elasticache.py</span></code> 80</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityGroupFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/dms.py</span></code> 128</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ReplicationInstance</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityGroup</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/dynamodb.py</span></code> 429</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@DynamoDbAccelerator</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DaxSecurityGroupFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rdscluster.py</span></code> 197</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityGroupFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/eks.py</span></code> 42</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@EKS</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EKSSGFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/batch.py</span></code> 37</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ComputeEnvironment</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ComputeSGFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/code.py</span></code> 98</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@CodeBuildProject</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BuildSecurityGroupFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/glue.py</span></code> 47</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@GlueConnection</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ConnectionSecurityGroupFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/sagemaker.py</span></code> 622</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@NotebookInstance</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NotebookSecurityGroupFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 173</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityGroupFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/mq.py</span></code> 60</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@MessageBroker</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MQSGFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elb.py</span></code> 424</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityGroupFilter</span>
</pre></div>
</div>
<p>ELB security group filter</p>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/efs.py</span></code> 87</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ElasticFileSystemMountTarget</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityGroup</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/directory.py</span></code> 58</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Directory</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DirectorySecurityGroupFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/asg.py</span></code> 123</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityGroupFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/awslambda.py</span></code> 115</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">security</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityGroupFilter</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 48 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-invalid-sg-delete-qa-east</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Find all EC2 instances that are using Testing-Only SG and remove hourly</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GroupName</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cml-testing-only-sg</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-invalid-sg-delete-qa-west</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Find all EC2 instances that are using Testing-Only SG and remove hourly</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GroupName</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cml-testing-only-sg</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-invalid-sg-delete-qa-east</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Find all EC2 instances that are using Testing-Only SG and remove hourly</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GroupName</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cml-testing-only-sg</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">security-group</span></code> filter looks at a related resource. This is similar to the way <code class="docutils literal notranslate"><span class="pre">image-age</span></code>
looks at an associated resource. The linkage varies slightly among resource types.</p>
<p>The <a class="reference internal" href="api.html#celpy.c7nlib.security_group" title="celpy.c7nlib.security_group"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.security_group()</span></code></a> and <a class="reference internal" href="api.html#celpy.c7nlib.get_related_ids" title="celpy.c7nlib.get_related_ids"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.get_related_ids()</span></code></a> functions
fetch the related resource.
This can then be examined to check group name, group id, or tags.</p>
<p>This requires two extension functions:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_related_ids()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_related_ids()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.security_group()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_related()</span></code></p></li>
</ul>
</section>
<section id="subnet">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">subnet</a><a class="headerlink" href="#subnet" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">match-resource</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;and&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;or&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;subnet&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.cache-cluster, aws.codebuild, aws.asg, aws.route-table, aws.vpc-endpoint, aws.eks, aws.efs-mount-target, aws.elasticsearch, aws.message-broker, aws.redshift, aws.rds, aws.glue-connection, aws.sagemaker-notebook, aws.directory, aws.eni, aws.app-elb, aws.lambda, aws.network-acl, aws.dax, aws.rds-cluster, aws.batch-compute, aws.ec2, aws.elb, aws.dms-instance</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/redshift.py</span></code> 106</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SubnetFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/appelb.py</span></code> 190</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SubnetFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1191</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@NetworkInterface</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InterfaceSubnetFilter</span>
</pre></div>
</div>
<p>Network interface subnet filter</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-interface-in-subnet</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eni</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subnet</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CidrBlock</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.2.0/24</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1295</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@RouteTable</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SubnetRoute</span>
</pre></div>
</div>
<p>Filter a route table by its associated subnet attributes.</p>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1493</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@NetworkAcl</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AclSubnetFilter</span>
</pre></div>
</div>
<p>Filter network acls by the attributes of their attached subnets.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subnet-acl</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-acl</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subnet</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tag:Location&quot;</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Public</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1793</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@VpcEndpoint</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EndpointSubnetFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elasticsearch.py</span></code> 87</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ElasticSearchDomain</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Subnet</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rds.py</span></code> 299</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SubnetFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elasticache.py</span></code> 86</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SubnetFilter</span>
</pre></div>
</div>
<p>Filters elasticache clusters based on their associated subnet</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elasticache-in-subnet-x</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cache-cluster</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subnet</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SubnetId</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subnet-12ab34cd</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/dms.py</span></code> 122</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ReplicationInstance</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Subnet</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/dynamodb.py</span></code> 622</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@DynamoDbAccelerator</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DaxSubnetFilter</span>
</pre></div>
</div>
<p>Filters DAX clusters based on their associated subnet group</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dax-no-auto-public</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dax</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subnet</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MapPublicIpOnLaunch</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rdscluster.py</span></code> 203</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SubnetFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/eks.py</span></code> 36</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@EKS</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EKSSubnetFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/batch.py</span></code> 43</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ComputeEnvironment</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ComputeSubnetFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/code.py</span></code> 92</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@CodeBuildProject</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BuildSubnetFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/glue.py</span></code> 41</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@GlueConnection</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ConnectionSubnetFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/sagemaker.py</span></code> 628</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@NotebookInstance</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NotebookSubnetFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 179</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SubnetFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/mq.py</span></code> 54</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@MessageBroker</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MQSubnetFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elb.py</span></code> 431</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SubnetFilter</span>
</pre></div>
</div>
<p>ELB subnet filter</p>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/efs.py</span></code> 81</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ElasticFileSystemMountTarget</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Subnet</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/directory.py</span></code> 52</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Directory</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DirectorySubnetFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/asg.py</span></code> 145</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SubnetFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/awslambda.py</span></code> 121</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">subnet</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SubnetFilter</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 16 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-restriction-az1e-notify-weekly</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SubnetId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subnet</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">txt</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lambda-restriction-az1e-notify-weekly</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lambda</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SubnetId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subnet</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">txt</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb-restriction-az1e-notify-weekly</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SubnetId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subnet</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">txt</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">subnet</span></code> filter looks at a related resource. This is similar to the way <code class="docutils literal notranslate"><span class="pre">security-group</span></code>
looks at an associated resource. The linkage varies slightly among resource types.</p>
<p>See the <a class="reference internal" href="api.html#celpy.c7nlib.subnet" title="celpy.c7nlib.subnet"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.subnet()</span></code></a> function fetches the related resource.
This can then be examined to check group name, group id, or tags.</p>
<p>This requires one extension function:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.subnet()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_related()</span></code>.</p></li>
</ul>
</section>
<section id="flow-logs">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">flow-logs</a><a class="headerlink" href="#flow-logs" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">deliver-status</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;success&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;failure&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">destination</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">destination-type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;s3&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cloud-watch-logs&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;default&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">False</span><span class="p p-Indicator">}</span>
<span class="nt">log-group</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;default&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">set-op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;or&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;and&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;default&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;or&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;active&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">traffic-type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;accept&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;reject&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;all&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;flow-logs&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.vpc, aws.eni, aws.subnet</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 57</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Vpc</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">flow</span><span class="o">-</span><span class="n">logs</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FlowLogFilter</span>
</pre></div>
</div>
<p>Are flow logs enabled on the resource.</p>
<p>ie to find all vpcs with flows logs disabled we can do this</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flow-logs-enabled</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flow-logs</span>
</pre></div>
</div>
<p>or to find all vpcs with flow logs but that don’t match a
particular configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flow-mis-configured</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">not</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flow-logs</span>
<span class="w">          </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">          </span><span class="nt">set-op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">or</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">equal</span>
<span class="w">          </span><span class="c1"># equality operator applies to following keys</span>
<span class="w">          </span><span class="nt">traffic-type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w">          </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">active</span>
<span class="w">          </span><span class="nt">log-group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-logs</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 9 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-enable-vpc-flow-logs</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ISRM-78 All VPCs must have flow logs enabled</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flow-logs</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OREO-vpc-CM6AWS11-NC</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ISRM 78 - VPC Flow Logs must be enable</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flow-logs</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OREO-vpc-CM6AWS11-CBR</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ISRM 78 - VPC Flow Logs must be enable</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flow-logs</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">flow-logs</span></code> fklter looks at a related resource. This is similar to the way <code class="docutils literal notranslate"><span class="pre">security-group</span></code> and <code class="docutils literal notranslate"><span class="pre">subnet</span></code> work.
This looks at an associated resource. The linkage varies slightly among resource types.</p>
<p>See the <a class="reference internal" href="api.html#celpy.c7nlib.flow_logs" title="celpy.c7nlib.flow_logs"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.flow_logs()</span></code></a> function to fetch the related resource.
This can then be examined to check group name, group id, or tags.</p>
<p>This requires one extension function:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.flow_logs()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_flow_logs()</span></code></p></li>
</ul>
</section>
<section id="tag-count">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">tag-count</a><a class="headerlink" href="#tag-count" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">count</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;minimum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;tag-count&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.hostedzone, aws.log-group, aws.cache-cluster, aws.efs, aws.vpn-gateway, aws.cache-snapshot, aws.asg, aws.route-table, aws.security-group, aws.vpc-endpoint, aws.kms-key, aws.vpc, aws.transit-attachment, aws.rest-stage, aws.glacier, aws.distribution, aws.network-addr, aws.ssm-parameter, aws.rds, aws.eni, aws.ebs-snapshot, aws.vpn-connection, aws.elasticbeanstalk-environment, aws.rds-snapshot, aws.app-elb, aws.customer-gateway, aws.streaming-distribution, aws.peering-connection, aws.network-acl, aws.ebs, aws.ami, aws.kinesis, aws.app-elb-target-group, aws.rds-cluster, aws.healthcheck, aws.subnet, aws.ec2, aws.nat-gateway, aws.elb, aws.transit-gateway, aws.internet-gateway, aws.key-pair</p>
<p>No implementation for tag-count.
Policies studied have 5 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-tag-trim</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:maid_status</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:cardda_tagcompliance</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:autoscaling:groupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag-count</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-tag-trim</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:cardda_tagcompliance</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ASV</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:CMDBEnvironment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:Project</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag-count</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs-tag-trim</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:maid_status</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag-count</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">tag-count</span></code> filter doesn’t require any extra functions.
The filter generally translates to something like the following:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">size(Resource[&quot;Tags&quot;].filter(x,</span> <span class="pre">!</span> <span class="pre">matches(x.Key,</span> <span class="pre">&quot;^aws:.*&quot;)))</span> <span class="pre">&gt;=</span> <span class="pre">8</span></code></p>
</div></blockquote>
</section>
<section id="vpc">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">vpc</a><a class="headerlink" href="#vpc" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">match-resource</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;and&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;or&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;vpc&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2, aws.eks, aws.app-elb, aws.lambda, aws.elb, aws.codebuild, aws.elasticsearch, aws.rds, aws.dms-instance, aws.directory, aws.eni, aws.vpc-endpoint</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/appelb.py</span></code> 196</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">VpcFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1232</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@NetworkInterface</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InterfaceVpcFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1799</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@VpcEndpoint</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EndpointVpcFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elasticsearch.py</span></code> 99</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ElasticSearchDomain</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Vpc</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rds.py</span></code> 305</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">VpcFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/dms.py</span></code> 134</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ReplicationInstance</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Vpc</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/eks.py</span></code> 48</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@EKS</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EKSVpcFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/code.py</span></code> 104</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@CodeBuildProject</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BuildVpcFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 185</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">VpcFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elb.py</span></code> 438</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">VpcFilter</span>
</pre></div>
</div>
<p>ELB vpc filter</p>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/directory.py</span></code> 64</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Directory</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DirectoryVpcFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/awslambda.py</span></code> 127</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">VpcFilter</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 4 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-offhours-tagging</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">State.Name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">running</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:autoscaling:groupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:elasticmapreduce:job-flow-id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:elasticmapreduce:instance-group-role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:Component</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VpcId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(offhours_exceptions.&quot;{account_id}&quot;.&quot;account&quot;, &#39;[]&#39;)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_downtime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:custodian_downtime</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;off&#39;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;False&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:custodian_downtime</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-offhours-component-tagging</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">State.Name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">running</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:autoscaling:groupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:elasticmapreduce:job-flow-id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:elasticmapreduce:instance-group-role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:Component</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VpcId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(offhours_exceptions.&quot;{account_id}&quot;.&quot;account&quot;, &#39;[]&#39;)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Component</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(offhours_exceptions.&quot;{account_id}&quot;.&quot;account&quot;, &#39;[]&#39;)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_downtime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:custodian_downtime</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;off&#39;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;False&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:custodian_downtime</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-offhours-tagging</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ReadReplicaDBInstanceIdentifiers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">empty</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ReadReplicaSourceDBInstanceIdentifier</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">empty</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">DBClusterIdentifier</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:Component</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_rds_offhours_et</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_rds_offhours_ct</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_rds_offhours_pt</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VpcId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(offhours_exceptions.&quot;{account_id}&quot;.&quot;account&quot;, &#39;[]&#39;)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">not</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Engine</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aurora</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">vpc</span></code> filter looks at a related resource. This is similar to the way <code class="docutils literal notranslate"><span class="pre">security-group</span></code> and <code class="docutils literal notranslate"><span class="pre">subnet</span></code> work.
This looks at an associated resource. The linkage varies slightly among resource types.</p>
<p>See the <a class="reference internal" href="api.html#celpy.c7nlib.vpc" title="celpy.c7nlib.vpc"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.vpc()</span></code></a> function to fetch the related resource.
This can then be examined to check group name, group id, or tags.</p>
<p>This requires one extension function:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.vpc()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_related()</span></code></p></li>
</ul>
</section>
<section id="credential">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">credential</a><a class="headerlink" href="#credential" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;title&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;report</span><span class="nv"> </span><span class="s">key</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">search&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;user&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;arn&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;user_creation_time&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;password_enabled&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;password_last_used&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;password_last_changed&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;password_next_rotation&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;mfa_active&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;access_keys&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;access_keys.active&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;access_keys.last_used_date&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;access_keys.last_used_region&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;access_keys.last_used_service&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;access_keys.last_rotated&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;certs&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;certs.active&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;certs.last_rotated&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">report_delay</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;title&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;Number</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">seconds</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">wait</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">report</span><span class="nv"> </span><span class="s">generation.&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;default&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">report_generate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;title&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;Generate</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">report</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">none</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">present.&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;default&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">True</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">report_max_age</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;title&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;Number</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">seconds</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">consider</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">report</span><span class="nv"> </span><span class="s">valid.&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;default&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">86400</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;credential&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.account, aws.iam-user</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 987</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@User</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">credential</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserCredentialReport</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/account.py</span></code> 81</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">credential</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AccountCredentialReport</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 2 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-active-key-lastrotate-notify</span>
<span class="nt">comments</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Check and notify resource owner of active keys not rotated in last 55 days. Keys will need to be rotated every 60 days.</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-user</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">access_keys.active</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">credential</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">access_keys.last_rotated</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gte</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">credential</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">55</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-active-key-lastrotate-notify</span>
<span class="nt">comments</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Check and notify resource owner of active keys not rotated in last 55 days. Keys will need to be rotated every 60 days.</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-user</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">access_keys.active</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">credential</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">access_keys.last_rotated</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gte</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">credential</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">55</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>There are two examples of <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">credential</span></code> filters. These look at the credentials associated with IAM roles.
See the <a class="reference internal" href="api.html#celpy.c7nlib.credentials" title="celpy.c7nlib.credentials"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.credentials()</span></code></a> function to fetch the related resource.</p>
<p>This requires two extension functions:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.subst()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.credentials()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_credential_report()</span></code></p></li>
</ul>
</section>
<section id="image">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">image</a><a class="headerlink" href="#image" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;image&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2, aws.asg</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 431</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InstanceImage</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/asg.py</span></code> 608</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ImageFilter</span>
</pre></div>
</div>
<p>Filter asg by image</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">non-windows-asg</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Platform</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Windows</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ne</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 2 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-ec2-ancient-images-notify-warn</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Identify EC2 instances that configured with AMIs older than 25 days</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:proxy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:autoscaling:groupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gte</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lt</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:ASV&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:BA&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(?!WIN.*)</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-ec2-ancient-images-notify</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Identify EC2 instances that configured with AMIs older than 30 days</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:proxy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:autoscaling:groupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gte</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:ASV&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:BA&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(?!WIN.*)</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>Like the <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">image-age</span></code>, the <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">image</span></code> filter looks at the related Image resource.
See the <a class="reference internal" href="api.html#celpy.c7nlib.image" title="celpy.c7nlib.image"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.image()</span></code></a> function to fetch the related resource, the ImageName
and CreationDate are available in the related resource.</p>
<p>Note the complex regex: <code class="docutils literal notranslate"><span class="pre">(?!WIN.*)</span></code>. This does not translated trivially to CEL: a manual
revision to this filter is strongly suggested, something like this:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">!</span> <span class="pre">Resource.image().Name.matches(&quot;WIN.*&quot;)</span></code></p>
</div></blockquote>
</section>
<section id="kms-alias">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">kms-alias</a><a class="headerlink" href="#kms-alias" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;kms-alias&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ebs, aws.rds</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rds.py</span></code> 314</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">kms</span><span class="o">-</span><span class="n">alias</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">KmsKeyAlias</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ebs.py</span></code> 549</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">kms</span><span class="o">-</span><span class="n">alias</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">KmsKeyAlias</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 2 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs-no-kms-keys</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Detect all EBS volumes EBS volumes not encrypted with customer managed key</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AliasName</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kms-alias</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^(alias/aws/)</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-no-kms-keys</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Detect all RDS databases not encrypted with customer managed key</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AliasName</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kms-alias</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^(alias/aws/)</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">kms-alias</span></code> filter looks at related information.
See the <a class="reference internal" href="api.html#celpy.c7nlib.kms_alias" title="celpy.c7nlib.kms_alias"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.kms_alias()</span></code></a> function to fetch the related resource</p>
<p>This requires one extension function:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.kms_alias()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_matching_aliases()</span></code>.</p></li>
</ul>
</section>
<section id="kms-key">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">kms-key</a><a class="headerlink" href="#kms-key" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">match-resource</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;and&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;or&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;kms-key&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.sns, aws.dynamodb-table, aws.dms-instance</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/dms.py</span></code> 116</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ReplicationInstance</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">kms</span><span class="o">-</span><span class="n">key</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">KmsFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/dynamodb.py</span></code> 98</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Table</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">kms</span><span class="o">-</span><span class="n">key</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">KmsFilter</span>
</pre></div>
</div>
<p>Filter a resource by its associcated kms key and optionally the aliasname
of the kms key by using ‘c7n:AliasName’</p>
<dl class="field-list">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dynamodb-kms-key-filters</span>
<span class="w">      </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dynamodb-table</span>
<span class="w">      </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kms-key</span>
<span class="w">          </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c7n:AliasName</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^(alias/aws/dynamodb)&quot;</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/sns.py</span></code> 257</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@SNS</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">kms</span><span class="o">-</span><span class="n">key</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">KmsFilter</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 1 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-dynamodb-table-app-kms-key-unmark</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SC-28.AWS.16 - DynamoDB Tables in CDE must be encrypted with a enterprise key or an app specific KMS key</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dynamodb-table</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c7n:AliasName</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kms-key</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^(alias/enterprise)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;tag:</span><span class="nv"> </span><span class="s">enterprise-controls-SC-28.AWS.16&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">kms-alias</span></code> filter looks at related information.
See the <a class="reference internal" href="api.html#celpy.c7nlib.kms_key" title="celpy.c7nlib.kms_key"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.kms_key()</span></code></a> function to fetch the related resource</p>
<p>This requires one extension function:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.kms_key()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_related()</span></code></p></li>
</ul>
</section>
<section id="config-compliance-no-examples">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">config-compliance (no examples)</a><a class="headerlink" href="#config-compliance-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">eval_filters</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;$ref&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;#/definitions/filters/valuekv&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;$ref&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;#/definitions/filters/value&#39;</span><span class="p p-Indicator">}]}}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;or&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;and&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">rules</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">states</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;COMPLIANT&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;NON_COMPLIANT&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;NOT_APPLICABLE&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;INSUFFICIENT_DATA&#39;</span><span class="p p-Indicator">]}}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;config-compliance&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.iam-policy, aws.iam-group, aws.codebuild, aws.vpn-gateway, aws.asg, aws.security-group, aws.redshift-snapshot, aws.waf-regional, aws.redshift-subnet-group, aws.dynamodb-table, aws.vpc, aws.s3, aws.rds-subscription, aws.distribution, aws.network-addr, aws.redshift, aws.rds, aws.eni, aws.waf, aws.vpn-connection, aws.rds-snapshot, aws.app-elb, aws.iam-user, aws.lambda, aws.streaming-distribution, aws.alarm, aws.network-acl, aws.ebs, aws.dax, aws.launch-config, aws.subnet, aws.ec2, aws.cloudtrail, aws.dynamodb-backup, aws.cfn, aws.acm-certificate, aws.elb, aws.iam-role, aws.internet-gateway</p>
<p>No implementation for config-compliance.
Policies studied have 0 examples.</p>
</section>
<section id="user-data-no-examples">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">user-data (no examples)</a><a class="headerlink" href="#user-data-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;user-data&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2, aws.asg</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 676</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">user</span><span class="o">-</span><span class="n">data</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserData</span>
</pre></div>
</div>
<p>Filter on EC2 instances which have matching userdata.
Note: It is highly recommended to use regexes with the ?sm flags, since Custodian
uses re.match() and userdata spans multiple lines.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2_userdata_stop</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">user-data</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(?smi).*password=</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stop</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/asg.py</span></code> 829</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">user</span><span class="o">-</span><span class="n">data</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserDataFilter</span>
</pre></div>
</div>
<p>Filter on ASG’s whose launch configs have matching userdata.
Note: It is highly recommended to use regexes with the ?sm flags, since Custodian
uses re.match() and userdata spans multiple lines.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lc_userdata</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">user-data</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(?smi).*password=</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="shield-metrics-no-examples">
<h3><a class="toc-backref" href="#id28" role="doc-backlink">shield-metrics (no examples)</a><a class="headerlink" href="#shield-metrics-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">attr-multiplier</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">dimensions</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">percent-attr</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">period</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">statistics</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;Average&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;Sum&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;Maximum&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;Minimum&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;SampleCount&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;shield-metrics&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.elb, aws.distribution</p>
<p>No implementation for shield-metrics.
Policies studied have 0 examples.</p>
</section>
<section id="status-no-examples">
<h3><a class="toc-backref" href="#id29" role="doc-backlink">status (no examples)</a><a class="headerlink" href="#status-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;status&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.config-rule, aws.cloudtrail</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/cloudtrail.py</span></code> 74</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@CloudTrail</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Status</span>
</pre></div>
</div>
<p>Filter a cloudtrail by its status.</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cloudtrail-not-active</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws.cloudtrail</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="w">      </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IsLogging</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/config.py</span></code> 35</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ConfigRule</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RuleStatus</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="instance-no-examples">
<h3><a class="toc-backref" href="#id30" role="doc-backlink">instance (no examples)</a><a class="headerlink" href="#instance-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;instance&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ebs, aws.elb</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elb.py</span></code> 448</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Instance</span>
</pre></div>
</div>
<p>Filter ELB by an associated instance value(s)</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb-image-filter</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ImageId</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ami-01ab23cd</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ebs.py</span></code> 505</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AttachedInstanceFilter</span>
</pre></div>
</div>
<p>Filter volumes based on filtering on their attached instance</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-ebs-volumes</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="task-definition-no-examples">
<h3><a class="toc-backref" href="#id31" role="doc-backlink">task-definition (no examples)</a><a class="headerlink" href="#task-definition-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;task-definition&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ecs-task, aws.ecs-service</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ecs.py</span></code> 223</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Service</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">task</span><span class="o">-</span><span class="n">definition</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ServiceTaskDefinitionFilter</span>
</pre></div>
</div>
<p>Filter services by their task definitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p>Find any fargate services that are running with a particular
image in the task and delete them.</p>
</dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fargate-readonly-tasks</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ecs-task</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">launchType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FARGATE</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">task-definition</span>
<span class="w">       </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;containerDefinitions[].image&quot;</span>
<span class="w">       </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;elasticsearch/elasticsearch:6.4.3</span>
<span class="w">       </span><span class="s">value_type:</span><span class="nv"> </span><span class="s">swap</span>
<span class="w">       </span><span class="s">op:</span><span class="nv"> </span><span class="s">contains</span>
<span class="w">    </span><span class="s">actions:</span>
<span class="w">     </span><span class="s">-</span><span class="nv"> </span><span class="s">delete</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ecs.py</span></code> 317</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Task</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">task</span><span class="o">-</span><span class="n">definition</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TaskTaskDefinitionFilter</span>
</pre></div>
</div>
<p>Filter tasks by their task definition.</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p>Find any fargate tasks that are running without read only root
and stop them.</p>
</dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fargate-readonly-tasks</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ecs-task</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">launchType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FARGATE</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">task-definition</span>
<span class="w">       </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;containerDefinitions[].readonlyRootFilesystem&quot;</span>
<span class="w">       </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None</span>
<span class="w">       </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">swap</span>
<span class="w">       </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stop</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
</section>
<section id="common-boolean-filters">
<h2><a class="toc-backref" href="#id32" role="doc-backlink">Common/Boolean Filters</a><a class="headerlink" href="#common-boolean-filters" title="Link to this heading">¶</a></h2>
<p>These are functions that examine and make a decision, providing a boolean result.
Because no explicit <code class="docutils literal notranslate"><span class="pre">op:</span></code> is provided in C7N, we must examine the semantics of each individual DSL
construct to map it to both a source of data, and a CEL operator.</p>
<p>In principle, this leads us to a function to extract
data from the C7N resource description, in a form that CEL can use. The operation should be exposed
instead of implied.</p>
<section id="offhour">
<h3><a class="toc-backref" href="#id33" role="doc-backlink">offhour</a><a class="headerlink" href="#offhour" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">offhour</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;minimum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;maximum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">23</span><span class="p p-Indicator">}</span>
<span class="nt">opt-out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">skip-days</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;pattern&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;^[0-9]{4}-[0-9]{2}-[0-9]{2}&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">skip-days-from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;offhour&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">weekends</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">weekends-only</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.ec2, aws.asg, aws.rds</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rds.py</span></code> 262</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">offhour</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RDSOffHour</span>
</pre></div>
</div>
<p>Scheduled action on rds instance.</p>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 455</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">offhour</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InstanceOffHour</span>
</pre></div>
</div>
<p>Custodian OffHour filter</p>
<p>Filters running EC2 instances with the intent to stop at a given hour of
the day. A list of days to excluded can be included as a list of strings
with the format YYYY-MM-DD. Alternatively, the list (using the same syntax)
can be taken from a specified url.</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">offhour-evening-stop</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">offhour</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_downtime</span>
<span class="w">        </span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">et</span>
<span class="w">        </span><span class="nt">offhour</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stop</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">offhour-evening-stop-skip-holidays</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">offhour</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_downtime</span>
<span class="w">        </span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">et</span>
<span class="w">        </span><span class="nt">offhour</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="w">        </span><span class="nt">skip-days</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;2017-12-25&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stop</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">offhour-evening-stop-skip-holidays-from</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">offhour</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_downtime</span>
<span class="w">        </span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">et</span>
<span class="w">        </span><span class="nt">offhour</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="w">        </span><span class="nt">skip-days-from</span><span class="p">:</span>
<span class="w">          </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">          </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">csv</span>
<span class="w">          </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;s3://location/holidays.csv&#39;</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stop</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 125 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-asg-offhours-8x5-suspend</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_resize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:resize_config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SuspendedProcesses</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">equal</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Uptime</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">08-19-weekend-off</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8x5</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ct</span>
<span class="w">    </span><span class="nt">offhour</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">19</span>
<span class="w">    </span><span class="nt">opt-out</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">offhour</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-asg-offhours-24x5-suspend</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_resize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:resize_config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SuspendedProcesses</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">equal</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Uptime</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">down-weekends</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">24x5</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ct</span>
<span class="w">    </span><span class="nt">offhour</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">19</span>
<span class="w">    </span><span class="nt">opt-out</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">offhour</span>
<span class="w">    </span><span class="nt">weekends-only</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-asg-offhours-custom-suspend</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_resize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:resize_config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SuspendedProcesses</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">equal</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Uptime</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custom</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ct</span>
<span class="w">    </span><span class="nt">offhour</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">19</span>
<span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_downtime</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">offhour</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>An Offhour (as well as an Onhour) filter is used to compare the current time against
a scheduled on or off time.</p>
<p>These policies are focused very narrowly on the current time.</p>
<blockquote>
<div><p>These policies are evaluated hourly; during each run (once an hour),
cloud-custodian will act on <strong>only</strong> the resources tagged for that <strong>exact</strong>
hour.</p>
</div></blockquote>
<p>In CEL, the common case is <code class="docutils literal notranslate"><span class="pre">getHours(Now)</span> <span class="pre">==</span> <span class="pre">19</span></code>, where the policy had <code class="docutils literal notranslate"><span class="pre">offhour:</span> <span class="pre">19</span></code>.</p>
<p>C7N has the following features and CEL implentations.</p>
<ul class="simple">
<li><p><strong>weekends</strong>: default true, whether to leave resources off for the weekend, i.e., do nothing on the weekend.
In effect, silence the filter on weekends.
CEL: <code class="docutils literal notranslate"><span class="pre">!</span> <span class="pre">getDayOfWeek(Now)</span> <span class="pre">in</span> <span class="pre">[0,</span> <span class="pre">6]</span></code></p></li>
<li><p><strong>weekend-only</strong>: default false, whether to turn the resource off only on, i.e., take action only on the weekend.
In effect, silence the filter on weekdays.
CEL: <code class="docutils literal notranslate"><span class="pre">getDayOfWeek(Now)</span> <span class="pre">in</span> <span class="pre">[0,</span> <span class="pre">6]</span></code></p></li>
<li><p><strong>default_tz</strong>: which timezone to utilize when evaluating time <strong>(REQUIRED)</strong>
The timezone is a second parameter to the extraction function.
CEL: <code class="docutils literal notranslate"><span class="pre">Now.getDayOfWeek(&quot;PST&quot;)</span></code> applies PST before extracting the day-of-week value.</p></li>
<li><p><strong>tag</strong>: which resource tag name to use for per-resource configuration
(schedule and timezone overrides and opt-in/opt-out); default is
<code class="docutils literal notranslate"><span class="pre">maid_offhours</span></code>. This is troublingly difficult because the tag’s syntax
implies a CEL expression that becomes invisible.
CEL: <code class="docutils literal notranslate"><span class="pre">key_value(&quot;maid_offhours&quot;).resource_schedule(Now)</span></code></p></li>
<li><p><strong>opt-out</strong>: Determines the behavior for resources which do not have a tag
matching the one specified for <strong>tag</strong>. Values can be either <code class="docutils literal notranslate"><span class="pre">false</span></code> (the
default) where the policy operates on an opt-in basis and resources must have
the tag in order to be acted on by the policy, or <code class="docutils literal notranslate"><span class="pre">true</span></code> where the policy
operates on an opt-out basis, and resources without the tag are acted on by
the policy.
CEL for <code class="docutils literal notranslate"><span class="pre">opt-out:</span> <span class="pre">false</span></code>: <code class="docutils literal notranslate"><span class="pre">Resource.Tags.exists(x,</span> <span class="pre">x.key==&quot;maid_offhours&quot;)</span> <span class="pre">?</span> <span class="pre">key_value(&quot;maid_offhours&quot;).resource_schedule(Now)</span> <span class="pre">||</span> <span class="pre">(other</span> <span class="pre">rules)</span> <span class="pre">:</span> <span class="pre">false</span></code>.
CEL for <code class="docutils literal notranslate"><span class="pre">opt-out:</span> <span class="pre">true</span></code>: <code class="docutils literal notranslate"><span class="pre">Resource.Tags.exists(x,</span> <span class="pre">x.key==&quot;maid_offhours&quot;)</span> <span class="pre">?</span> <span class="pre">false</span> <span class="pre">:</span> <span class="pre">(other</span> <span class="pre">rules)</span></code>.</p></li>
<li><p><strong>onhour</strong>: the default time to start/run resources, specified as 0-23.
CEL: <code class="docutils literal notranslate"><span class="pre">Now.getHour()</span> <span class="pre">==</span> <span class="pre">onhour</span></code>.</p></li>
<li><p><strong>offhour</strong>: the default time to stop/suspend resources, specified as 0-23.
CEL: <code class="docutils literal notranslate"><span class="pre">Now.getHour()</span> <span class="pre">==</span> <span class="pre">offhour</span></code>.</p></li>
<li><p><strong>skip-days</strong>: a list of dates to skip. Dates must use format YYYY-MM-DD.
CEL: <code class="docutils literal notranslate"><span class="pre">!</span> <span class="pre">getDate(Now)</span> <span class="pre">in</span> <span class="pre">[&quot;YYYY-MM-DD&quot;].map(d,</span> <span class="pre">getDate(timestamp(d)))</span></code></p></li>
<li><p><strong>skip-days-from</strong>: a list of dates to skip stored at a url. <strong>expr</strong>,
<strong>format</strong>, and <strong>url</strong> must be passed as parameters. Same syntax as
<code class="docutils literal notranslate"><span class="pre">value_from</span></code>. Can not specify both <strong>skip-days-from</strong> and <strong>skip-days</strong>.
CEL: <code class="docutils literal notranslate"><span class="pre">!</span> <span class="pre">getDate(Now)</span> <span class="pre">in</span> <span class="pre">value_from(&quot;url&quot;).jmes_path(&quot;date&quot;).map(d,</span> <span class="pre">getDate(timestamp(d)))</span></code></p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">resource_schedule()</span></code> function uses the C7N schedule sublanguage for a specific resource.
This describes the on-hour and off-hour processing for a single resource. Here is the special
tag value syntax.</p>
<blockquote>
<div><p>A semicolon-separated string composed of one or more of the following
components, which override the defaults specified in the policy:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tz=&lt;timezone&gt;</span></code> to evaluate with a resource-specific timezone, where
<code class="docutils literal notranslate"><span class="pre">&lt;timezone&gt;</span></code> is either one of the supported timezone aliases defined in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">c7n.filters.offhours.Time.TZ_ALIASES</span></code> (such as <code class="docutils literal notranslate"><span class="pre">pt</span></code>) or the name
of a geographic timezone identifier in
[IANA’s tzinfo database](<a class="reference external" href="https://www.iana.org/time-zones">https://www.iana.org/time-zones</a>), such as
<code class="docutils literal notranslate"><span class="pre">Americas/Los_Angeles</span></code>. <em>(Note all timezone aliases are
referenced to a locality to ensure taking into account local daylight
savings time, if applicable.)</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">off=(time</span> <span class="pre">spec)</span></code> and/or <code class="docutils literal notranslate"><span class="pre">on=(time</span> <span class="pre">spec)</span></code> matching time specifications
supported by <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.filters.offhours.ScheduleParser</span></code> as described
in the next section.</p></li>
</ul>
</div></blockquote>
<p>Each time specification follows the format <code class="docutils literal notranslate"><span class="pre">(days,hours)</span></code>. Multiple time
specifications can be combined in square-bracketed lists, i.e.
<code class="docutils literal notranslate"><span class="pre">[(days,hours),(days,hours),(days,hours)]</span></code>.</p>
<p>Days are M, T, W, H, F, S, U.</p>
<p><strong>Examples</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># up mon-fri from 7am-7pm; eastern time</span>
<span class="n">off</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">F</span><span class="p">,</span><span class="mi">19</span><span class="p">);</span><span class="n">on</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="n">F</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="c1"># up mon-fri from 6am-9pm; up sun from 10am-6pm; pacific time</span>
<span class="n">off</span><span class="o">=</span><span class="p">[(</span><span class="n">M</span><span class="o">-</span><span class="n">F</span><span class="p">,</span><span class="mi">21</span><span class="p">),(</span><span class="n">U</span><span class="p">,</span><span class="mi">18</span><span class="p">)];</span><span class="n">on</span><span class="o">=</span><span class="p">[(</span><span class="n">M</span><span class="o">-</span><span class="n">F</span><span class="p">,</span><span class="mi">6</span><span class="p">),(</span><span class="n">U</span><span class="p">,</span><span class="mi">10</span><span class="p">)];</span><span class="n">tz</span><span class="o">=</span><span class="n">pt</span>
</pre></div>
</div>
</div></blockquote>
<p>The <code class="xref py py-func docutils literal notranslate"><span class="pre">resource_schedule()</span></code> function reaches into the <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.filters.offhours.ScheduleParser</span></code> class
to parse the schedule text and compare it against the current day and hour in the given <code class="docutils literal notranslate"><span class="pre">Now</span></code> value.</p>
<p>An alternative is to eschew this special language and replace it with CEL.
These are <em>long</em> tag values, making this unwieldy.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{&quot;off&quot;:</span> <span class="pre">Now.getDayOfWeek()</span> <span class="pre">in</span> <span class="pre">[1,2,3,4,5]</span> <span class="pre">&amp;&amp;</span> <span class="pre">Now.getHour()</span> <span class="pre">==</span> <span class="pre">19,</span> <span class="pre">&quot;on&quot;:</span> <span class="pre">Now.getDayOfWeek()</span> <span class="pre">in</span> <span class="pre">[1,2,3,4,5]</span> <span class="pre">&amp;&amp;</span> <span class="pre">Now.getHour()</span> <span class="pre">==</span> <span class="pre">7}</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{&quot;off&quot;:</span> <span class="pre">(Now.getDayOfWeek(&quot;PT&quot;)</span> <span class="pre">in</span> <span class="pre">[1,2,3,4,5]</span> <span class="pre">&amp;&amp;</span> <span class="pre">Now.getHour()</span> <span class="pre">==</span> <span class="pre">21)</span> <span class="pre">||</span> <span class="pre">(Now.getDayOfWeek(&quot;PT&quot;)</span> <span class="pre">==</span> <span class="pre">0</span> <span class="pre">&amp;&amp;</span> <span class="pre">Now.getHour()</span> <span class="pre">==</span> <span class="pre">18),</span>
<span class="pre">&quot;on&quot;:</span> <span class="pre">(Now.getDayOfWeek(&quot;PT&quot;)</span> <span class="pre">in</span> <span class="pre">[1,2,3,4,5]</span> <span class="pre">&amp;&amp;</span> <span class="pre">Now.getHour()</span> <span class="pre">==</span> <span class="pre">6)</span> <span class="pre">||</span> <span class="pre">(Now.getDayOfWeek(&quot;PT&quot;)</span> <span class="pre">==</span> <span class="pre">0</span> <span class="pre">&amp;&amp;</span> <span class="pre">Now.getHour()</span> <span class="pre">==</span> <span class="pre">10)}</span></code>.</p></li>
</ul>
<p>The terse tag language should probably be left in place.</p>
<p>This requires one extension function:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.resource_schedule()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.parser.parse()</span></code></p></li>
</ul>
</section>
<section id="onhour">
<h3><a class="toc-backref" href="#id34" role="doc-backlink">onhour</a><a class="headerlink" href="#onhour" title="Link to this heading">¶</a></h3>
<p>See <a class="reference internal" href="#offhour">offhour</a>.</p>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">onhour</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;minimum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;maximum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">23</span><span class="p p-Indicator">}</span>
<span class="nt">opt-out</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">skip-days</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;pattern&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;^[0-9]{4}-[0-9]{2}-[0-9]{2}&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">skip-days-from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;onhour&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">weekends</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">weekends-only</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.ec2, aws.asg, aws.rds, aws.rds-snapshot</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rds.py</span></code> 268</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">onhour</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RDSOnHour</span>
</pre></div>
</div>
<p>Scheduled action on rds instance.</p>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rds.py</span></code> 1021</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@RDSSnapshot</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">onhour</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RDSSnapshotOnHour</span>
</pre></div>
</div>
<p>Scheduled action on rds snapshot.</p>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 512</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">onhour</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InstanceOnHour</span>
</pre></div>
</div>
<p>Custodian OnHour filter</p>
<p>Filters stopped EC2 instances with the intent to start at a given hour of
the day. A list of days to excluded can be included as a list of strings
with the format YYYY-MM-DD. Alternatively, the list (using the same syntax)
can be taken from a specified url.</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">onhour-morning-start</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">onhour</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_downtime</span>
<span class="w">        </span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">et</span>
<span class="w">        </span><span class="nt">onhour</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">start</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">onhour-morning-start-skip-holidays</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">onhour</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_downtime</span>
<span class="w">        </span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">et</span>
<span class="w">        </span><span class="nt">onhour</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<span class="w">        </span><span class="nt">skip-days</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;2017-12-25&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">start</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">onhour-morning-start-skip-holidays-from</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">onhour</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_downtime</span>
<span class="w">        </span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">et</span>
<span class="w">        </span><span class="nt">onhour</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<span class="w">        </span><span class="nt">skip-days-from</span><span class="p">:</span>
<span class="w">          </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">          </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">csv</span>
<span class="w">          </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;s3://location/holidays.csv&#39;</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">start</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 88 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-asg-onhours-8x5-resume</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_stopped</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Uptime</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">08-19-weekend-off</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8x5</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ct</span>
<span class="w">    </span><span class="nt">onhour</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">    </span><span class="nt">opt-out</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">skip-days</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2019-11-28&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2019-11-29&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2019-12-25&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-01-01&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-01-20&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-02-17&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-05-25&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-07-03&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-10-12&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-11-11&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-11-26&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-11-27&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-12-25&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2021-01-01&#39;</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">onhour</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-asg-onhours-24x5-resume</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_stopped</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Uptime</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">down-weekends</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">24x5</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ct</span>
<span class="w">    </span><span class="nt">onhour</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">    </span><span class="nt">opt-out</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">skip-days</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2019-11-28&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2019-11-29&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2019-12-25&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-01-01&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-01-20&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-02-17&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-05-25&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-07-03&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-10-12&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-11-11&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-11-26&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-11-27&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-12-25&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2021-01-01&#39;</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">onhour</span>
<span class="w">    </span><span class="nt">weekends-only</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-asg-onhours-custom-resume</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_stopped</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Uptime</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custom</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">default_tz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ct</span>
<span class="w">    </span><span class="nt">onhour</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">    </span><span class="nt">skip-days</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2019-11-28&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2019-11-29&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2019-12-25&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-01-01&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-01-20&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-02-17&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-05-25&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-07-03&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-10-12&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-11-11&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-11-26&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-11-27&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2020-12-25&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;2021-01-01&#39;</span>
<span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_downtime</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">onhour</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="cross-account">
<h3><a class="toc-backref" href="#id35" role="doc-backlink">cross-account</a><a class="headerlink" href="#cross-account" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">actions</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">everyone_only</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;cross-account&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">whitelist</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">whitelist_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">whitelist_conditions</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">whitelist_endpoints</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">whitelist_endpoints_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">whitelist_orgids</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">whitelist_orgids_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">whitelist_protocols</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;http&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;https&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;email&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;email-json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;sms&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;sqs&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;application&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lambda&#39;</span><span class="p p-Indicator">]}}</span>
<span class="nt">whitelist_protocols_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">whitelist_vpc</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">whitelist_vpc_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">whitelist_vpce</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">whitelist_vpce_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
</pre></div>
</div>
<p>Used by aws.log-group, aws.vpc-endpoint, aws.redshift-snapshot, aws.kms-key, aws.glacier, aws.rest-api, aws.s3, aws.ebs-snapshot, aws.event-rule-target, aws.rds-snapshot, aws.lambda, aws.ecr, aws.peering-connection, aws.ami, aws.lambda-layer, aws.kms, aws.sqs, aws.sns, aws.iam-role</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/redshift.py</span></code> 667</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@RedshiftSnapshot</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RedshiftSnapshotCrossAccount</span>
</pre></div>
</div>
<p>Filter all accounts that allow access to non-whitelisted accounts</p>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1410</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@PeeringConnection</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CrossAccountPeer</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1779</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@VpcEndpoint</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EndpointCrossAccountFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rds.py</span></code> 1180</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@RDSSnapshot</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CrossAccountAccess</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 400</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Role</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RoleCrossAccountAccess</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/sqs.py</span></code> 108</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@SQS</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SQSCrossAccount</span>
</pre></div>
</div>
<p>Filter SQS queues which have cross account permissions</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sqs-cross-account</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sqs</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cross-account</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/glacier.py</span></code> 58</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Glacier</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GlacierCrossAccountAccessFilter</span>
</pre></div>
</div>
<p>Filter to return all glacier vaults with cross account access permissions</p>
<p>The whitelist parameter will omit the accounts that match from the return</p>
<dl class="field-list">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">glacier-cross-account</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">glacier</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cross-account</span>
<span class="w">        </span><span class="nt">whitelist</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">permitted-account-01</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">permitted-account-02</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ami.py</span></code> 257</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AmiCrossAccountFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/apigw.py</span></code> 128</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@RestApi</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RestApiCrossAccount</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/cw.py</span></code> 117</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@EventRuleTarget</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CrossAccountFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/cw.py</span></code> 277</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@LogGroup</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LogCrossAccountFilter</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ecr.py</span></code> 43</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ECR</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ECRCrossAccountAccessFilter</span>
</pre></div>
</div>
<p>Filters all EC2 Container Registries (ECR) with cross-account access</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ecr-cross-account</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ecr</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cross-account</span>
<span class="w">        </span><span class="nt">whitelist_from</span><span class="p">:</span>
<span class="w">          </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;accounts.*.accountNumber&quot;</span>
<span class="w">          </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="nv">*accounts_url</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/s3.py</span></code> 562</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">S3CrossAccountFilter</span>
</pre></div>
</div>
<p>Filters cross-account access to S3 buckets</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-acl</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="w">    </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">us-east-1</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cross-account</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/awslambda.py</span></code> 238</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LambdaCrossAccountAccessFilter</span>
</pre></div>
</div>
<p>Filters lambda functions with cross-account permissions</p>
<p>The whitelist parameter can be used to prevent certain accounts
from being included in the results (essentially stating that these
accounts permissions are allowed to exist)</p>
<p>This can be useful when combining this filter with the delete action.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lambda-cross-account</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lambda</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cross-account</span>
<span class="w">        </span><span class="nt">whitelist</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;IAM-Policy-Cross-Account-Access&#39;</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/awslambda.py</span></code> 569</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@LambdaLayerVersion</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LayerCrossAccount</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/sns.py</span></code> 80</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@SNS</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SNSCrossAccount</span>
</pre></div>
</div>
<p>Filter to return all SNS topics with cross account access permissions</p>
<p>The whitelist parameter will omit the accounts that match from the return</p>
<dl class="field-list">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sns-cross-account</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sns</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cross-account</span>
<span class="w">        </span><span class="nt">whitelist</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">permitted-account-01</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">permitted-account-02</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ebs.py</span></code> 198</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Snapshot</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cross</span><span class="o">-</span><span class="n">account</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SnapshotCrossAccountAccess</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 86 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sns-cross-account-notify</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sns</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cross-account</span>
<span class="w">    </span><span class="nt">whitelist_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">accounts.*.account</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://redacted/path</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sqs-cross-account-notify</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sqs</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cross-account</span>
<span class="w">    </span><span class="nt">whitelist_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">accounts.*.account</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://redacted/path</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lambda-cross-account-notify</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lambda</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cross-account</span>
<span class="w">    </span><span class="nt">whitelist_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">accounts.*.account</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://redacted/path</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>Each of these is a unique path to access an account (or organization or VPC or VPC-endpoints, etc.)</p>
<p>There are a few common cases and a large number of unique, special cases.
This, in turn, leads to a raft of special functions required to extract the information.</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_accounts()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_accounts()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_vpcs()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_vpcs()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_vpces()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_vpces()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_orgids()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_orgids()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_endpoints()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_endpoints()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_protocols()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_protocols()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_resource_policy()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_protocols()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_key_policy()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_key_policy()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.describe_subscription_filters()</span></code> which depends on <code class="xref py py-attr docutils literal notranslate"><span class="pre">CELFilter.manager</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.describe_db_snapshot_attributes()</span></code> which depends on <code class="xref py py-attr docutils literal notranslate"><span class="pre">CELFilter.manager</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.arn_split()</span></code></p></li>
</ul>
<p>Generally, these functions reach back into the <code class="xref py py-class docutils literal notranslate"><span class="pre">CELFilter</span></code> instance for similarly-named
methods that acquire the required data. Some of these seem to map directly to AWS boto3 functions.</p>
</section>
<section id="unused">
<h3><a class="toc-backref" href="#id36" role="doc-backlink">unused</a><a class="headerlink" href="#unused" title="Link to this heading">¶</a></h3>
<p>See <a class="reference internal" href="#used">used</a>.</p>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;unused&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.rds-subnet-group, aws.iam-profile, aws.iam-policy, aws.ami, aws.iam-role, aws.launch-config, aws.security-group</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 659</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@SecurityGroup</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">unused</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UnusedSecurityGroup</span>
</pre></div>
</div>
<p>Filter to just vpc security groups that are not used.</p>
<p>We scan all extant enis in the vpc to get a baseline set of groups
in use. Then augment with those referenced by launch configs, and
lambdas as they may not have extant resources in the vpc at a
given moment. We also find any security group with references from
other security group either within the vpc or across peered
connections.</p>
<p>Note this filter does not support classic security groups atm.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-groups-unused</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unused</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rds.py</span></code> 1474</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@RDSSubnetGroup</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">unused</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UnusedRDSSubnetGroup</span>
</pre></div>
</div>
<p>Filters all launch rds subnet groups that are not in use but exist</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-subnet-group-delete-unused</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-subnet-group</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unused</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 373</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Role</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">unused</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UnusedIamRole</span>
</pre></div>
</div>
<p>Filter IAM roles that are either being used or not</p>
<p>This filter has been deprecated. Please use the ‘used’ filter
with the ‘state’ attribute to get unused iam roles</p>
<p>Checks for usage on EC2, Lambda, ECS only</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-roles-not-in-use</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-role</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">used</span>
<span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 597</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Policy</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">unused</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UnusedIamPolicies</span>
</pre></div>
</div>
<p>Filter IAM policies that are not being used</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-policy-unused</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-policy</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unused</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 758</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@InstanceProfile</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">unused</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UnusedInstanceProfiles</span>
</pre></div>
</div>
<p>Filter IAM profiles that are not being used</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-instance-profiles-not-in-use</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-profile</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unused</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ami.py</span></code> 212</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">unused</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ImageUnusedFilter</span>
</pre></div>
</div>
<p>Filters images based on usage</p>
<p>true: image has no instances spawned from it
false: image has instances spawned from it</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ami-unused</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ami</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unused</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/asg.py</span></code> 1728</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@LaunchConfig</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">unused</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UnusedLaunchConfig</span>
</pre></div>
</div>
<p>Filters all launch configurations that are not in use but exist</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-unused-launch-config</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch-config</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unused</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 43 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-launch-config-unused-gt-60-days</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Delete unused launch configurations.</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch-config</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gt</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unused</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-launch-config-unused-gt-90-days</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Check unused launch configurations, abandonded or unused resources needs clean up.</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch-config</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">90</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gt</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unused</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch-config-unused-gt-60-days</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Delete unused launch configurations.</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch-config</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gt</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unused</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>Each resource type is slightly different:</p>
<ul>
<li><p>ami. See <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.resources.ami.ImageUnusedFilter</span></code>. This looks at a union of all EC2 and ASG images.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Resource[&quot;ImageId&quot;] in (
        set(C7N.filter._pull_ec2_images()) +
        set(C7N.filter._pull_asg_images())
)
</pre></div>
</div>
</li>
<li><p>asg. See <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.resources.asg.UnusedLaunchConfig</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Resource[&#39;LaunchConfigurationName&#39;] in (
    C7N.filter.manager.get_launch_configuration_names()
)
</pre></div>
</div>
</li>
<li><p>ebs. See <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.resources.ebs.SnapshotUnusedFilter</span></code>.  This looks at all AMI and ASG snapshots,
as well as launch templates.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Resource[&#39;SnapshotId&#39;] in (set(C7N.filter._pull_asg_snapshots() + set(C7N.filter._pull_ami_snapshots()))
</pre></div>
</div>
</li>
<li><p>iam.</p>
<ul>
<li><p>Role. See <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.resources.iam.UnusedIamRole</span></code>. Gets ARN’s using the role.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Resource[&#39;Arn&#39;] in C7N.filter.service_role_usage() &amp;&amp; ! Resource[&#39;RoleName&#39;] in C7N.filter.service_role_usage()
</pre></div>
</div>
</li>
<li><p>Policy. See <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.resources.iam.UnusedIamPolicies</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! (Resource[&#39;AttachmentCount&#39;] &gt; 0 || Resource.get(&#39;PermissionsBoundaryUsageCount&#39;, 0) &gt; 0)
</pre></div>
</div>
</li>
<li><p>Instance. See <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.resources.iam.UnusedInstanceProfiles</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Resource[&#39;Arn&#39;] in C7N.filter.instance_profile_usage() &amp;&amp; ! Resource[&#39;InstanceProfileName&#39;] in C7N.filter.instance_profile_usage()
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>rds-subnet-group. See <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.resources.rds.UnusedRDSSubnetGroup</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Resource[&#39;DBSubnetGroupName&#39;] in C7N.filter.get_dbsubnet_group_used()
</pre></div>
</div>
</li>
<li><p>vpc. See <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.resources.vpc.UnusedSecurityGroup</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Resource[&#39;GroupId&#39;] in C7N.filter.scan_groups() and &#39;VpcId&#39; in Resource
</pre></div>
</div>
</li>
</ul>
<p>This leads to a number of functions in the <code class="docutils literal notranslate"><span class="pre">CELFilter</span></code> class, depending
on the resource type.</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.all_images()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter._pull_ec2_images()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter._pull_asg_images()</span></code>.</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.all_snapshots()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter._pull_asg_snapshots()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter._pull_ami_snapshots()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.all_launch_configuration_names()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.manager.get_launch_configuration_names()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.all_service_roles()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.service_role_usage()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.all_instance_profiles()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.instance_profile_usage()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.all_dbsubenet_groups()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.get_dbsubnet_group_used()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.all_scan_groups()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">CELFilter.scan_groups()</span></code></p></li>
</ul>
</section>
<section id="is-not-logging">
<h3><a class="toc-backref" href="#id37" role="doc-backlink">is-not-logging</a><a class="headerlink" href="#is-not-logging" title="Link to this heading">¶</a></h3>
<p>See <a class="reference internal" href="#is-logging">is-logging</a>.</p>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">bucket</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;is-not-logging&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.app-elb, aws.elb</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/appelb.py</span></code> 610</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="ow">is</span><span class="o">-</span><span class="ow">not</span><span class="o">-</span><span class="n">logging</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IsNotLoggingFilter</span>
</pre></div>
</div>
<dl class="simple">
<dt>Matches AppELBs that are NOT logging to S3.</dt><dd><p>or do not match the optional bucket and/or prefix.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alb-is-not-logging-test</span>
<span class="w">      </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb</span>
<span class="w">      </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-not-logging</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alb-is-not-logging-bucket-and-prefix-test</span>
<span class="w">      </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb</span>
<span class="w">      </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-not-logging</span>
<span class="w">          </span><span class="nt">bucket</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prodlogs</span>
<span class="w">          </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alblogs</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elb.py</span></code> 829</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="ow">is</span><span class="o">-</span><span class="ow">not</span><span class="o">-</span><span class="n">logging</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IsNotLoggingFilter</span>
</pre></div>
</div>
<dl class="simple">
<dt>Matches ELBs that are NOT logging to S3.</dt><dd><p>or do not match the optional bucket and/or prefix.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb-is-not-logging-test</span>
<span class="w">      </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="w">      </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-not-logging</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-not-logging-bucket-and-prefix-test</span>
<span class="w">      </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb</span>
<span class="w">      </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-not-logging</span>
<span class="w">          </span><span class="nt">bucket</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prodlogs</span>
<span class="w">          </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alblogs</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 40 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">classic-elb-require-logging-us-east-1</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">bucket</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redacted</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Logs</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-not-logging</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">classic-elb-require-logging-us-west-2</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">bucket</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redacted</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Logs</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-not-logging</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application-elb-require-logging-us-east-1</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">bucket</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redacted</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Logs</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-not-logging</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>This leads to a two functions in the <code class="docutils literal notranslate"><span class="pre">CELFilter</span></code> class, depending
on the resource type.</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_access_log()</span></code> is for <cite>elb</cite>, and depends on
<code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.resources.elb.IsNotLoggingFilter</span></code> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.resources.elb.IsLoggingFilter</span></code>.</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.get_load_balancer()</span></code> is for <cite>app-elb</cite> and depends on
<code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.resources.appelb.IsNotLoggingFilter</span></code> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.resources.appelb.IsLoggingFilter</span></code>.</p></li>
</ul>
</section>
<section id="health-event">
<h3><a class="toc-backref" href="#id38" role="doc-backlink">health-event</a><a class="headerlink" href="#health-event" title="Link to this heading">¶</a></h3>
<p>See <a class="reference internal" href="#metrics">metrics</a>.</p>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">statuses</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;open&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;upcoming&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;closed&#39;</span><span class="p p-Indicator">]}}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;health-event&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">types</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;AWS_EBS_DEGRADED_EBS_VOLUME_PERFORMANCE&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;AWS_EBS_VOLUME_LOST&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.ec2, aws.directconnect, aws.dynamodb-table, aws.cache-cluster, aws.acm-certificate, aws.emr, aws.app-elb, aws.elb, aws.ebs, aws.efs, aws.storage-gateway, aws.rds, aws.dms-instance, aws.directory</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ebs.py</span></code> 592</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">health</span><span class="o">-</span><span class="n">event</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">HealthFilter</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 32 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-health-event</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Send daily EC2 PHD event notification to resource owners</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">statuses</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">upcoming</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">open</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">health-event</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&quot;c7n:HealthEvent&quot;[0].lastUpdatedTime&#39;</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">le</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-health-event</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Send daily RDS PHD event notification to resource owners</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">statuses</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">upcoming</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">open</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">health-event</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&quot;c7n:HealthEvent&quot;[0].lastUpdatedTime&#39;</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">le</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-health-event</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Send daily EC2 PHD event notification to resource owners</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">statuses</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">upcoming</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">open</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">health-event</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&quot;c7n:HealthEvent&quot;[0].lastUpdatedTime&#39;</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">le</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>This may require some rework in the <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.filters.health.HealthEventFilter</span></code> class.
The class  <code class="xref py py-meth docutils literal notranslate"><span class="pre">c7n.filters.health.HealthEventFilter.process()</span></code> method
appears to provide all Health events for a given list of resources.</p>
<p>It may be that a CEL <code class="docutils literal notranslate"><span class="pre">Resource.get_health_events()</span></code> should evaluate a
<code class="docutils literal notranslate"><span class="pre">C7N.health_events</span></code> function that is a refactirubg of the <code class="docutils literal notranslate"><span class="pre">process()</span></code> method of
the <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.filters.health.HealthEventFilter</span></code> class. Because the filter features
are mixins, they cannot reuse names like <code class="docutils literal notranslate"><span class="pre">process</span></code>.</p>
<p>There are two parts to this.</p>
<ol class="arabic simple">
<li><p>Getting raw health-events from the cloud provider.
The <a class="reference internal" href="api.html#celpy.c7nlib.get_raw_health_events" title="celpy.c7nlib.get_raw_health_events"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.get_raw_health_events()</span></code></a> is refactored
from the <code class="docutils literal notranslate"><span class="pre">HealthEventFilter</span></code> filter into <a class="reference internal" href="api.html#celpy.c7nlib.get_raw_health_events" title="celpy.c7nlib.get_raw_health_events"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.get_raw_health_events()</span></code></a> function.</p></li>
<li><p>Getting health events for a specific resource.
The <a class="reference internal" href="api.html#celpy.c7nlib.get_health_events" title="celpy.c7nlib.get_health_events"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.get_health_events()</span></code></a> function builds a filter unique to the resource.
This uses <a class="reference internal" href="api.html#celpy.c7nlib.get_raw_health_events" title="celpy.c7nlib.get_raw_health_events"><code class="xref py py-func docutils literal notranslate"><span class="pre">celpy.c7nlib.get_raw_health_events()</span></code></a>.</p></li>
</ol>
<p>Generally, C7N requests in bunches of 10 per client connection.
A worker pool processes the batches to keep from overwhelming AWS with
health event requests.</p>
</section>
<section id="shield-enabled">
<h3><a class="toc-backref" href="#id39" role="doc-backlink">shield-enabled</a><a class="headerlink" href="#shield-enabled" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;shield-enabled&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.hostedzone, aws.app-elb, aws.elb, aws.network-addr, aws.distribution, aws.account</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/account.py</span></code> 934</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">shield</span><span class="o">-</span><span class="n">enabled</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ShieldEnabled</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 15 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-check-shield-advanced-enabled</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">shield-enabled</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-check-shield-advanced-enabled</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">shield-enabled</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-check-shield-advanced-enabled</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">shield-enabled</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>This leads to two functions in the <code class="docutils literal notranslate"><span class="pre">CELFilter</span></code> class, depending on the resource type.</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.shield_protection()</span></code> which depends on the <code class="xref py py-meth docutils literal notranslate"><span class="pre">c7n.resources.shield.IsShieldProtected.process()</span></code> method.
This needs to be refactored and renamed to avoid collisions with other <code class="docutils literal notranslate"><span class="pre">process()</span></code> variants.
Also depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">c7n.resources.shield.IsShieldProtected.get_type_protections()</span></code>, unmodified.</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.shield_subscription()</span></code> which depends on <code class="xref py py-meth docutils literal notranslate"><span class="pre">c7n.resources.account.ShieldEnabled.process()</span></code> method.
This needs to be refactored and renamed to avoid collisions with other <code class="docutils literal notranslate"><span class="pre">process()</span></code> variants.</p></li>
</ul>
</section>
<section id="is-logging">
<h3><a class="toc-backref" href="#id40" role="doc-backlink">is-logging</a><a class="headerlink" href="#is-logging" title="Link to this heading">¶</a></h3>
<p>See <a class="reference internal" href="#is-not-logging">is-not-logging</a>.</p>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">bucket</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;is-logging&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.app-elb, aws.elb</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/appelb.py</span></code> 567</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="ow">is</span><span class="o">-</span><span class="n">logging</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IsLoggingFilter</span>
</pre></div>
</div>
<dl class="simple">
<dt>Matches AppELBs that are logging to S3.</dt><dd><p>bucket and prefix are optional</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alb-is-logging-test</span>
<span class="w">      </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb</span>
<span class="w">      </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-logging</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alb-is-logging-bucket-and-prefix-test</span>
<span class="w">      </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb</span>
<span class="w">      </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-logging</span>
<span class="w">          </span><span class="nt">bucket</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prodlogs</span>
<span class="w">          </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alblogs</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elb.py</span></code> 786</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="ow">is</span><span class="o">-</span><span class="n">logging</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IsLoggingFilter</span>
</pre></div>
</div>
<dl class="simple">
<dt>Matches ELBs that are logging to S3.</dt><dd><p>bucket and prefix are optional</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb-is-logging-test</span>
<span class="w">  </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="w">  </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-logging</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb-is-logging-bucket-and-prefix-test</span>
<span class="w">  </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="w">  </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-logging</span>
<span class="w">      </span><span class="nt">bucket</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prodlogs</span>
<span class="w">      </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elblogs</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 8 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">correct-elb-logging-region-1</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-logging</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNSName</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(?!.*eu-west-2.*)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Attributes.AccessLog.S3BucketName</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ne</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">capone-redacted</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">correct-elb-logging-region-2</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-logging</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNSName</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(?!.*eu-west-1.*)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Attributes.AccessLog.S3BucketName</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ne</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">capone-redacted</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">correct-elb-logging-region-1</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-logging</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNSName</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(?!.*eu-west-2.*)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Attributes.AccessLog.S3BucketName</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ne</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">capone-redacted</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>This is based on <a class="reference internal" href="#is-not-logging">is-not-logging</a>.</p>
</section>
<section id="used">
<h3><a class="toc-backref" href="#id41" role="doc-backlink">used</a><a class="headerlink" href="#used" title="Link to this heading">¶</a></h3>
<p>See <a class="reference internal" href="#unused">unused</a>.</p>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;used&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.iam-profile, aws.iam-role, aws.iam-policy, aws.security-group</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 692</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@SecurityGroup</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">used</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UsedSecurityGroup</span>
</pre></div>
</div>
<p>Filter to security groups that are used.</p>
<p>This operates as a complement to the unused filter for multi-step
workflows.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-groups-in-use</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">used</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 341</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Role</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">used</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UsedIamRole</span>
</pre></div>
</div>
<p>Filter IAM roles that are either being used or not</p>
<p>Checks for usage on EC2, Lambda, ECS only</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-role-in-use</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-role</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">used</span>
<span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 575</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Policy</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">used</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UsedIamPolicies</span>
</pre></div>
</div>
<p>Filter IAM policies that are being used</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-policy-used</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-policy</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">used</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 729</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@InstanceProfile</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">used</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UsedInstanceProfiles</span>
</pre></div>
</div>
<p>Filter IAM profiles that are being used</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-instance-profiles-in-use</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-profile</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">used</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 5 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group-unused-unmark</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">For SG&#39;s in use, marked as unused - unmark them</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:maid_status</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">used</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group-unused-unmark</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">For SG&#39;s in use, marked as unused - unmark them</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:sg_unused</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">used</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tidyup-security-group-unused-unmark</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">For SG&#39;s in use marked as unused - unmark them</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:housekeep_unused_sg</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">used</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="waf-enabled">
<h3><a class="toc-backref" href="#id42" role="doc-backlink">waf-enabled</a><a class="headerlink" href="#waf-enabled" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;waf-enabled&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">web-acl</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.app-elb, aws.distribution</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/appelb.py</span></code> 205</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@AppELB</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">waf</span><span class="o">-</span><span class="n">enabled</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">WafEnabled</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/cloudfront.py</span></code> 147</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Distribution</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">waf</span><span class="o">-</span><span class="n">enabled</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IsWafEnabled</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 3 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uk-compliance-cloudfront-create-web-acl</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">distribution</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">waf-enabled</span>
<span class="w">    </span><span class="nt">web-acl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WebACL to allow or restrict by IP</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uk-compliance-cloudfront-hourly-web-acl</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">distribution</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">waf-enabled</span>
<span class="w">    </span><span class="nt">web-acl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WebACL to allow or restrict by IP</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uk-compliance-cloudfront-update-web-acl</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">distribution</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">waf-enabled</span>
<span class="w">    </span><span class="nt">web-acl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WebACL to allow or restrict by IP</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>There appear to be two parts to this: (1) getting ACL-ids, and then (2) checking to see
if the filter’s web-acl value is in the list of ACL-ids for this resource.</p>
<p>This leads to a a function in the <code class="docutils literal notranslate"><span class="pre">CELFilter</span></code> class:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">c7nlib.web_acls()</span></code> depends on
<code class="xref py py-meth docutils literal notranslate"><span class="pre">c7n.resources.cloudfront.IsWafEnabled.process()</span></code> to get the ACL-ids.
The rest of the prcessing can be exposed in CEL.</p></li>
</ul>
</section>
<section id="network-location">
<h3><a class="toc-backref" href="#id43" role="doc-backlink">network-location</a><a class="headerlink" href="#network-location" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">compare</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;description&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;Which</span><span class="nv"> </span><span class="s">elements</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">network</span><span class="nv"> </span><span class="s">location</span><span class="nv"> </span><span class="s">should</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">considered</span><span class="nv"> </span><span class="s">when</span><span class="nv"> </span><span class="s">matching.&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;default&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;resource&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;subnet&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;security-group&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;resource&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;subnet&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;security-group&#39;</span><span class="p p-Indicator">]}}</span>
<span class="nt">ignore</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;description&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;The</span><span class="nv"> </span><span class="s">attribute</span><span class="nv"> </span><span class="s">expression</span><span class="nv"> </span><span class="s">that</span><span class="nv"> </span><span class="s">should</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">matched</span><span class="nv"> </span><span class="s">on&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">match</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;default&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;non-equal&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">max-cardinality</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;default&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;title&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">missing-ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;default&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">False</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;description&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;How</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">handle</span><span class="nv"> </span><span class="s">missing</span><span class="nv"> </span><span class="s">keys</span><span class="nv"> </span><span class="s">on</span><span class="nv"> </span><span class="s">elements,</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">default</span><span class="nv"> </span><span class="s">this</span><span class="nv"> </span><span class="s">causesresources</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">considered</span><span class="nv"> </span><span class="s">not-equal&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;network-location&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2, aws.cache-cluster, aws.app-elb, aws.lambda, aws.elb, aws.rds, aws.rds-cluster, aws.redshift, aws.asg, aws.eni</p>
<p>No implementation for network-location.
Policies studied have 2 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-sg-shopping</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Find all ec2 instances that are using another ASVs security groups.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">compare</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resource</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="w">    </span><span class="nt">ignore</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ASV</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ASV</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ASV</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-location</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VpcId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-sg-shopping</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Find all rds instances that are using another ASVs security groups.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DBSubnetGroup.VpcId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">compare</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resource</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="w">    </span><span class="nt">ignore</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ASV</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ASV</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ASV</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-location</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<p>A number of resources depend on <code class="xref py py-class docutils literal notranslate"><span class="pre">c7n.filters.vpc.NetworkLocation</span></code> for the core implementation.
The “ec2” implementation diverges slightly from the superclass.</p>
<p>From the documentation.</p>
<blockquote>
<div><p>On a network attached resource, determine intersection of
security-group attributes, subnet attributes, and resource attributes.</p>
<p>The use case is a bit specialized, for most use cases using <cite>subnet</cite>
and <cite>security-group</cite> filters suffice. but say for example you wanted to
verify that an ec2 instance was only using subnets and security groups
with a given tag value, and that tag was not present on the resource.</p>
</div></blockquote>
<p>It appears that the “compare-ignore” rules can be optimized into an explicit
CEL expression to describe the related items and their relationshiup.</p>
<p>This legacy filter</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">resource</span><span class="p">:</span> <span class="n">ec2</span>
<span class="n">filters</span><span class="p">:</span>
  <span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="n">network</span><span class="o">-</span><span class="n">location</span>
    <span class="n">compare</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;resource&quot;</span><span class="p">,</span><span class="s2">&quot;security-group&quot;</span><span class="p">]</span>
    <span class="n">key</span><span class="p">:</span> <span class="s2">&quot;tag:TEAM_NAME&quot;</span>
    <span class="n">ignore</span><span class="p">:</span>
      <span class="o">-</span> <span class="s2">&quot;tag:TEAM_NAME&quot;</span><span class="p">:</span> <span class="n">Enterprise</span>
</pre></div>
</div>
<p>May be this</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Resource</span><span class="o">.</span><span class="n">SubnetId</span><span class="o">.</span><span class="n">subnet</span><span class="p">()[</span><span class="s2">&quot;Tags&quot;</span><span class="p">][</span><span class="s2">&quot;TEAM_NAME&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">Resource</span><span class="p">[</span><span class="s2">&quot;Tags&quot;</span><span class="p">][</span><span class="s2">&quot;TEAM_NAME&quot;</span><span class="p">]</span>
<span class="o">&amp;&amp;</span> <span class="n">Resource</span><span class="p">[</span><span class="s2">&quot;Tags&quot;</span><span class="p">][</span><span class="s2">&quot;TEAM_NAME&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;Enterprise&quot;</span>
</pre></div>
</div>
<p>This doesn’t seem to require an additional c7nlib function. The features
appear to be available in other functions to fetch the related subnet
and security group for a resource.</p>
</section>
<section id="finding-no-examples">
<h3><a class="toc-backref" href="#id44" role="doc-backlink">finding (no examples)</a><a class="headerlink" href="#finding-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;finding&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ssm-managed-instance, aws.iam-policy, aws.batch-definition, aws.iam-group, aws.shield-protection, aws.ecs, aws.fsx-backup, aws.ecs-container-instance, aws.eks, aws.support-case, aws.vpc, aws.rds-subscription, aws.network-addr, aws.message-broker, aws.redshift, aws.sagemaker-notebook, aws.glue-connection, aws.directory, aws.ebs-snapshot, aws.rds-cluster-param-group, aws.customer-gateway, aws.lambda-layer, aws.ecs-task, aws.subnet, aws.ec2, aws.cfn, aws.cloud-directory, aws.r53domain, aws.transit-gateway, aws.sns, aws.iam-role, aws.kinesis-analytics, aws.rds-param-group, aws.snowball-cluster, aws.codebuild, aws.efs, aws.elasticbeanstalk, aws.cache-snapshot, aws.security-group, aws.waf-regional, aws.dynamodb-table, aws.kms-key, aws.step-machine, aws.s3, aws.eni, aws.snowball, aws.elasticbeanstalk-environment, aws.lambda, aws.alarm, aws.ami, aws.sagemaker-endpoint-config, aws.app-elb-target-group, aws.simpledb, aws.hsm-client, aws.directconnect, aws.nat-gateway, aws.sagemaker-job, aws.emr, aws.glue-dev-endpoint, aws.rest-account, aws.fsx, aws.rest-resource, aws.codepipeline, aws.dlm-policy, aws.rds-cluster-snapshot, aws.hsm-hapg, aws.ecs-task-definition, aws.firehose, aws.secrets-manager, aws.asg, aws.rest-vpclink, aws.vpc-endpoint, aws.redshift-subnet-group, aws.iam-profile, aws.transit-attachment, aws.rest-stage, aws.rest-api, aws.distribution, aws.cache-subnet-group, aws.ecs-service, aws.event-rule-target, aws.identity-pool, aws.ssm-activation, aws.rds-snapshot, aws.app-elb, aws.ecr, aws.peering-connection, aws.ebs, aws.config-rule, aws.dax, aws.kinesis, aws.rrset, aws.batch-compute, aws.kms, aws.cloudtrail, aws.dynamodb-backup, aws.dms-endpoint, aws.sqs, aws.sagemaker-endpoint, aws.gamelift-build, aws.shield-attack, aws.dms-instance, aws.backup-plan, aws.key-pair, aws.iot, aws.hostedzone, aws.log-group, aws.rds-subnet-group, aws.cache-cluster, aws.hsm, aws.vpn-gateway, aws.sagemaker-transform-job, aws.route-table, aws.dynamodb-stream, aws.redshift-snapshot, aws.efs-mount-target, aws.codecommit, aws.glacier, aws.elasticsearch, aws.event-rule, aws.ssm-parameter, aws.rds, aws.sagemaker-model, aws.account, aws.cloudhsm-cluster, aws.waf, aws.vpn-connection, aws.iam-certificate, aws.iam-user, aws.streaming-distribution, aws.ml-model, aws.network-acl, aws.health-event, aws.launch-config, aws.rds-cluster, aws.storage-gateway, aws.healthcheck, aws.opswork-cm, aws.opswork-stack, aws.user-pool, aws.acm-certificate, aws.datapipeline, aws.elb, aws.gamelift-fleet, aws.cloudsearch, aws.internet-gateway</p>
<p>No implementation for finding.
Policies studied have 0 examples.</p>
</section>
<section id="has-inline-policy-no-examples">
<h3><a class="toc-backref" href="#id45" role="doc-backlink">has-inline-policy (no examples)</a><a class="headerlink" href="#has-inline-policy-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;has-inline-policy&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.iam-user, aws.iam-role, aws.iam-group</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 413</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Role</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">has</span><span class="o">-</span><span class="n">inline</span><span class="o">-</span><span class="n">policy</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IamRoleInlinePolicy</span>
</pre></div>
</div>
<p>Filter IAM roles that have an inline-policy attached
True: Filter roles that have an inline-policy
False: Filter roles that do not have an inline-policy</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-roles-with-inline-policies</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-role</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">has-inline-policy</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 1004</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@User</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">has</span><span class="o">-</span><span class="n">inline</span><span class="o">-</span><span class="n">policy</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IamUserInlinePolicy</span>
</pre></div>
</div>
<p>Filter IAM users that have an inline-policy attached</p>
<p>True: Filter users that have an inline-policy
False: Filter users that do not have an inline-policy</p>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 1613</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Group</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">has</span><span class="o">-</span><span class="n">inline</span><span class="o">-</span><span class="n">policy</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IamGroupInlinePolicy</span>
</pre></div>
</div>
<p>Filter IAM groups that have an inline-policy based on boolean value:
True: Filter all groups that have an inline-policy attached
False: Filter all groups that do not have an inline-policy attached</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-groups-with-inline-policy</span>
<span class="w">  </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-group</span>
<span class="w">  </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">has-inline-policy</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="default-vpc-no-examples">
<h3><a class="toc-backref" href="#id46" role="doc-backlink">default-vpc (no examples)</a><a class="headerlink" href="#default-vpc-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;default-vpc&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2, aws.app-elb, aws.elb, aws.app-elb-target-group, aws.redshift, aws.rds, aws.security-group</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/redshift.py</span></code> 78</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">default</span><span class="o">-</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DefaultVpc</span>
</pre></div>
</div>
<p>Matches if an redshift database is in the default vpc</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redshift-default-vpc</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redshift</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-vpc</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/appelb.py</span></code> 842</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">default</span><span class="o">-</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AppELBDefaultVpcFilter</span>
</pre></div>
</div>
<p>Filter all ELB that exist within the default vpc</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">appelb-in-default-vpc</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-vpc</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/appelb.py</span></code> 1023</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@AppELBTargetGroup</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">default</span><span class="o">-</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AppELBTargetGroupDefaultVpcFilter</span>
</pre></div>
</div>
<p>Filter all application elb target groups within the default vpc</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">appelb-targetgroups-default-vpc</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb-target-group</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-vpc</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 767</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@SecurityGroup</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">default</span><span class="o">-</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SGDefaultVpc</span>
</pre></div>
</div>
<p>Filter that returns any security group that exists within the default vpc</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group-default-vpc</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-vpc</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rds.py</span></code> 273</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">default</span><span class="o">-</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DefaultVpc</span>
</pre></div>
</div>
<p>Matches if an rds database is in the default vpc</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-vpc-rds</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-vpc</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 656</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">default</span><span class="o">-</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DefaultVpc</span>
</pre></div>
</div>
<p>Matches if an ec2 database is in the default vpc</p>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elb.py</span></code> 748</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">default</span><span class="o">-</span><span class="n">vpc</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DefaultVpc</span>
</pre></div>
</div>
<p>Matches if an elb database is in the default vpc</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb-default-vpc</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-vpc</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="healthcheck-protocol-mismatch-no-examples">
<h3><a class="toc-backref" href="#id47" role="doc-backlink">healthcheck-protocol-mismatch (no examples)</a><a class="headerlink" href="#healthcheck-protocol-mismatch-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;healthcheck-protocol-mismatch&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.app-elb, aws.elb</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/appelb.py</span></code> 791</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">healthcheck</span><span class="o">-</span><span class="n">protocol</span><span class="o">-</span><span class="n">mismatch</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AppELBHealthCheckProtocolMismatchFilter</span>
</pre></div>
</div>
<p>Filter AppELBs with mismatched health check protocols</p>
<p>A mismatched health check protocol is where the protocol on the target group
does not match the load balancer health check protocol</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">appelb-healthcheck-mismatch</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">healthcheck-protocol-mismatch</span>
</pre></div>
</div>
</li>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elb.py</span></code> 711</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">healthcheck</span><span class="o">-</span><span class="n">protocol</span><span class="o">-</span><span class="n">mismatch</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">HealthCheckProtocolMismatch</span>
</pre></div>
</div>
<p>Filters ELB that have a healtch check protocol mismatch</p>
<p>The mismatch occurs if the ELB has a different protocol to check than
the associated instances allow to determine health status.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb-healthcheck-mismatch</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">healthcheck-protocol-mismatch</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
</section>
<section id="singleton-non-bool-filters">
<h2><a class="toc-backref" href="#id48" role="doc-backlink">Singleton/Non-Bool Filters</a><a class="headerlink" href="#singleton-non-bool-filters" title="Link to this heading">¶</a></h2>
<section id="launch-config">
<h3><a class="toc-backref" href="#id49" role="doc-backlink">launch-config</a><a class="headerlink" href="#launch-config" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;launch-config&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.asg</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/asg.py</span></code> 161</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">launch</span><span class="o">-</span><span class="n">config</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LaunchConfigFilter</span>
</pre></div>
</div>
<p>Filter asg by launch config attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch-configs-with-public-address</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch-config</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AssociatePublicIpAddress</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 103 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-using-key-pair-notify-new</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Any ASG that creates EC2 instances that use a KeyName (key pair) will generate a notification</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KeyName</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch-config</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-large-instance-notify</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Notify any user who creates an ASG that will launch instances</span>
<span class="l l-Scalar l-Scalar-Plain">that use an instance type that is considered &quot;large&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">(generally &gt; $1/hour)</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">InstanceType</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch-config</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all.large_instance_types.*</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-using-key-pair-notify-new</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Any ASG that creates EC2 instances that use a KeyName (key pair) will generate a notification</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KeyName</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch-config</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="instance-age">
<h3><a class="toc-backref" href="#id50" role="doc-backlink">instance-age</a><a class="headerlink" href="#instance-age" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">hours</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">minutes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;instance-age&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 615</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">instance</span><span class="o">-</span><span class="n">age</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InstanceAgeFilter</span>
</pre></div>
</div>
<p>Filters instances based on their age (in days)</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-30-days-plus</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-age</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
<span class="w">        </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 94 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-invalid-asv-value-tag</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tag any instances that use an ASV that isn&#39;t valid.  Owner will be notified</span>
<span class="l l-Scalar l-Scalar-Plain">in a later policy.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.084</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gte</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:autoscaling:groupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_asv</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all_values.*</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-ec2-ancient-image-new</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Terminate any new instance whose AMI is over 60 days old.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:autoscaling:groupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">State.Name</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ne</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terminated</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.011</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-uptime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.084</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">less-than</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:ASV&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:BA&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-ec2-untagged-mark</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Require proper tagging for all EC2 instances that have been up at least 15 minutes.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.011</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:autoscaling:groupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:fs_custodian_tagging</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">State.Name</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ne</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terminated</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">not</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ASV</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">                </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">                </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">                </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:BA</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">                </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">                </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">                </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerContact</span>
<span class="w">            </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">            </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:GroupName</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EMMO</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ApplicationName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:Environment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:Uptime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ApplicationName</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Environment</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Uptime</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="listener">
<h3><a class="toc-backref" href="#id51" role="doc-backlink">listener</a><a class="headerlink" href="#listener" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">matched</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;listener&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.app-elb</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/appelb.py</span></code> 666</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AppELBListenerFilter</span>
</pre></div>
</div>
<p>Filter ALB based on matching listener attributes</p>
<p>Adding the <cite>matched</cite> flag will filter on previously matched listeners</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb-invalid-ciphers</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">listener</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Protocol</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTPS</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">listener</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SslPolicy</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;ELBSecurityPolicy-TLS-1-1-2017-01&#39;</span><span class="p p-Indicator">,</span><span class="s">&#39;ELBSecurityPolicy-TLS-1-2-2017-01&#39;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">        </span><span class="nt">matched</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">modify-listener</span>
<span class="w">        </span><span class="nt">sslpolicy</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ELBSecurityPolicy-TLS-1-2-2017-01&quot;</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 32 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-app-elb-ssl-require-tls12</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Protocol</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">listener</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTPS</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SslPolicy</span>
<span class="w">    </span><span class="nt">matched</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">listener</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ELBSecurityPolicy-TLS-1-2-2017-01</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-app-elb-ssl-require-tls12</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Protocol</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">listener</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTPS</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SslPolicy</span>
<span class="w">    </span><span class="nt">matched</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">listener</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ELBSecurityPolicy-TLS-1-2-2017-01</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb-invalid-ciphers-report</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Report on any ALB that uses an invalid SSL policy.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app-elb</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerContact</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">        </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerEID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerEID</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">        </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerEID</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(^[A-Za-z]{3}[0-9]{3}$)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Protocol</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">listener</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTPS</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SslPolicy</span>
<span class="w">    </span><span class="nt">matched</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">listener</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ELBSecurityPolicy-TLS-1-1-2017-01</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ELBSecurityPolicy-TLS-1-2-2017-01</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all.exceptions.alb.security.[&quot;tag:ASV&quot;][].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:CMDBEnvironment</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all.exceptions.alb.security.[&quot;tag:CMDBEnvironment&quot;][].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="vpc-id">
<h3><a class="toc-backref" href="#id52" role="doc-backlink">vpc-id</a><a class="headerlink" href="#vpc-id" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;vpc-id&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.asg</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/asg.py</span></code> 662</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">vpc</span><span class="o">-</span><span class="nb">id</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">VpcIdFilter</span>
</pre></div>
</div>
<p>Filters ASG based on the VpcId</p>
<p>This filter is available as a ValueFilter as the vpc-id is not natively
associated to the results from describing the autoscaling groups.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-vpc-xyz</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-id</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-12ab34cd</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 30 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-default-vpc-delete-new</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Any ASG created in any default VPC will be immediately deleted.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fs_analytical_dev.default_vpcs.*</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-default-vpc-delete-new</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Any ASG created in any default VPC will be immediately deleted.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fs_analytical_qa.default_vpcs.*</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-default-vpc-delete-new</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Any ASG created in any default VPC will be immediately deleted.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fs_core_cas_qa.default_vpcs.*</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="ebs">
<h3><a class="toc-backref" href="#id53" role="doc-backlink">ebs</a><a class="headerlink" href="#ebs" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;and&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;or&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">skip-devices</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;ebs&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 250</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">ebs</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AttachedVolume</span>
</pre></div>
</div>
<p>EC2 instances with EBS backed volume</p>
<p>Filters EC2 instances with EBS backed storage devices (non ephemeral)</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-encrypted-ebs-volumes</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Encrypted</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 27 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-ec2-create-snapshot</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Creates nightly backups of EC2 instances</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Encrypted</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:elasticmapreduce:instance-group-role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:elasticmapreduce:job-flow-id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:CMDBEnvironment</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.ec2.[&quot;snapshot&quot;][].[&quot;tag:CMDBEnvironment&quot;][].*[].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:CMDBEnvironment</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.*[].ebs.&quot;OPS-11&quot;.[&quot;tag:CMDBEnvironment&quot;][][]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ne</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-create-snapshot</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Creates nightly backups of EC2 instances</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Encrypted</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:elasticmapreduce:instance-group-role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:elasticmapreduce:job-flow-id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-require-encrypted-volumes</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ISRM 10 - All EC2 instances will be launched with encrypted EBS volumes.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">detail.userAgent</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">event</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autoscaling.amazonaws.com</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Encrypted</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">detail.userIdentity.sessionContext.sessionIssuer.userName</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ne</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">event</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">capone-redacted</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="instance-uptime">
<h3><a class="toc-backref" href="#id54" role="doc-backlink">instance-uptime</a><a class="headerlink" href="#instance-uptime" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;instance-uptime&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 604</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">instance</span><span class="o">-</span><span class="n">uptime</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UpTimeFilter</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 12 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-ec2-ancient-image-new</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Terminate any new instance whose AMI is over 60 days old.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:autoscaling:groupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">State.Name</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ne</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terminated</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.011</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-uptime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.084</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">less-than</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:ASV&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:BA&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-invalid-asv-value-mark</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Report on any instances that use an ASV that isn&#39;t valid.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.011</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-uptime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:autoscaling:groupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_asv</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all_values.*</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-invalid-asv-value-mark</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Report on any instances that use an ASV that isn&#39;t valid.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.011</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-uptime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:aws:autoscaling:groupName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_asv</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all_values.*</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="state-age">
<h3><a class="toc-backref" href="#id55" role="doc-backlink">state-age</a><a class="headerlink" href="#state-age" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;state-age&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 194</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">state</span><span class="o">-</span><span class="n">age</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">StateTransitionAge</span>
</pre></div>
</div>
<p>Age an instance has been in the given state.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-state-running-7-days</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state-age</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
<span class="w">        </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 7 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-unused-stopped-ec2-with-ancient-images</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:proxy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gte</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">State.Name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stopped</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">14</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gte</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IamInstanceProfile.Arn</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.ec2.rehydration.[&quot;IamInstanceProfile.Arn&quot;][].*[].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:CMDBEnvironment</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.ec2.rehydration.[&quot;tag:CMDBEnvironment&quot;][].*[].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.ec2.rehydration.[&quot;tag:ASV&quot;][].*[].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ImageId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.ec2.rehydration.[&quot;ImageId&quot;][].*[].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:CMDBEnvironment</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.*[].ami.&quot;ISRM-1&quot;.[&quot;tag:CMDBEnvironment&quot;][][]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:ASV&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:BA&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:c7n-ancient-image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-unused-stopped-ec2-with-ancient-image-delete</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:proxy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gte</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">State.Name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stopped</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">14</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gte</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state-age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IamInstanceProfile.Arn</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.ec2.rehydration.[&quot;IamInstanceProfile.Arn&quot;][].*[].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:CMDBEnvironment</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.ec2.rehydration.[&quot;tag:CMDBEnvironment&quot;][].*[].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.ec2.rehydration.[&quot;tag:ASV&quot;][].*[].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ImageId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.ec2.rehydration.[&quot;ImageId&quot;][].*[].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:CMDBEnvironment</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.*[].ami.&quot;ISRM-1&quot;.[&quot;tag:CMDBEnvironment&quot;][][]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:ASV&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not_null(exceptions.&quot;{account_id}&quot;.&quot;ec2/ami rehydration(si-2.aws.01)&quot;.&quot;tag:BA&quot;,</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">`[]`)</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terminate</span>
<span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c7n-ancient-image</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marked-for-op</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-stopped-extended-period-terminate-skiers</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Terminate instances which are stopped for more than 7 days.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gt</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state-age</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="password-policy">
<h3><a class="toc-backref" href="#id56" role="doc-backlink">password-policy</a><a class="headerlink" href="#password-policy" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;password-policy&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.account</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/account.py</span></code> 301</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">password</span><span class="o">-</span><span class="n">policy</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AccountPasswordPolicy</span>
</pre></div>
</div>
<p>Check an account’s password policy.</p>
<p>Note that on top of the default password policy fields, we also add an extra key,
PasswordPolicyConfigured which will be set to true or false to signify if the given
account has attempted to set a policy at all.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy-check</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="w">    </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">us-east-1</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MinimumPasswordLength</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireSymbols</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 5 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws-strong-password</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy scans to make sure accounts have a strong accounts policy</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MinimumPasswordLength</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">greater-than</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireSymbols</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireNumbers</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireUppercaseCharacters</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireLowercaseCharacters</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws-strong-password</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy scans to make sure accounts have a strong accounts policy</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MinimumPasswordLength</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">greater-than</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireSymbols</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireNumbers</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireUppercaseCharacters</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireLowercaseCharacters</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws-strong-password</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy scans to make sure accounts have a strong accounts policy</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MinimumPasswordLength</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">greater-than</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireSymbols</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireNumbers</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireUppercaseCharacters</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireLowercaseCharacters</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password-policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="reserved-concurrency">
<h3><a class="toc-backref" href="#id57" role="doc-backlink">reserved-concurrency</a><a class="headerlink" href="#reserved-concurrency" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;reserved-concurrency&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.lambda</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/awslambda.py</span></code> 136</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">reserved</span><span class="o">-</span><span class="n">concurrency</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ReservedConcurrency</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 4 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lambda-reserve-concurrency-absent-daily</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Email notification to setup lambda reserve concurrency</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lambda</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">reserved-concurrency</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VpcConfig.VpcId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lambda-reserve-concurrency-above-10-daily</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Setup lambda reserve concurrency to 10 for any function that have above 10</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lambda</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">greater-than</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">reserved-concurrency</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VpcConfig.VpcId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lambda-reserve-concurrency-absent-weekly</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Email notification to setup lambda reserve concurrency</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lambda</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">reserved-concurrency</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VpcConfig.VpcId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-redacted</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="access-key">
<h3><a class="toc-backref" href="#id58" role="doc-backlink">access-key</a><a class="headerlink" href="#access-key" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;access-key&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.iam-user</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 1124</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@User</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">access</span><span class="o">-</span><span class="n">key</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserAccessKey</span>
</pre></div>
</div>
<p>Filter IAM users based on access-key values</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-users-with-active-keys</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-user</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">access-key</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Status</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Active</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 2 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-credentials-old</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Detect all IAM credentials older than 60 days</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-user</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PolicyName</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AdministratorAccess</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Status</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">access-key</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Active</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CreateDate</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">greater-than</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">access-key</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-credentials-old</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Detect all IAM credentials older than 60 days</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-user</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PolicyName</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AdministratorAccess</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Status</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">access-key</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Active</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CreateDate</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">greater-than</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">access-key</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="mfa-device">
<h3><a class="toc-backref" href="#id59" role="doc-backlink">mfa-device</a><a class="headerlink" href="#mfa-device" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;mfa-device&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.iam-user</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 1178</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@User</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">mfa</span><span class="o">-</span><span class="n">device</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserMfaDevice</span>
</pre></div>
</div>
<p>Filter iam-users based on mfa-device status</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mfa-enabled-users</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-user</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mfa-device</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">UserName</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 1 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-user-no-mfa</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Detect all IAM users not using MFAs</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-user</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MFADevices</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mfa-device</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="policy">
<h3><a class="toc-backref" href="#id60" role="doc-backlink">policy</a><a class="headerlink" href="#policy" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;policy&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.iam-user</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 1034</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@User</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserPolicy</span>
</pre></div>
</div>
<p>Filter IAM users based on attached policy values</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-users-with-admin-access</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-user</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">policy</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PolicyName</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AdministratorAccess</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 1 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-credentials-old</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Detect all IAM credentials older than 60 days</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-user</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PolicyName</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">policy</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AdministratorAccess</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Status</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">access-key</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Active</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CreateDate</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">greater-than</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">access-key</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="key-rotation-status">
<h3><a class="toc-backref" href="#id61" role="doc-backlink">key-rotation-status</a><a class="headerlink" href="#key-rotation-status" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;key-rotation-status&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.kms-key</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/kms.py</span></code> 80</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Key</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">key</span><span class="o">-</span><span class="n">rotation</span><span class="o">-</span><span class="n">status</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">KeyRotationStatus</span>
</pre></div>
</div>
<p>Filters KMS keys by the rotation status</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kms-key-disabled-rotation</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kms-key</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">key-rotation-status</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KeyRotationEnabled</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 1 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kms-key-no-rotation</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Detect all keys that have key rotation disabled</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kms-key</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KeyRotationEnabled</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">key-rotation-status</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="group-no-examples">
<h3><a class="toc-backref" href="#id62" role="doc-backlink">group (no examples)</a><a class="headerlink" href="#group-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;group&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.iam-user</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 1080</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@User</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GroupMembership</span>
</pre></div>
</div>
<p>Filter IAM users based on attached group values</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-users-in-admin-group</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-user</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">group</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GroupName</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Admins</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="iam-summary-no-examples">
<h3><a class="toc-backref" href="#id63" role="doc-backlink">iam-summary (no examples)</a><a class="headerlink" href="#iam-summary-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;iam-summary&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.account</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/account.py</span></code> 228</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">iam</span><span class="o">-</span><span class="n">summary</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IAMSummary</span>
</pre></div>
</div>
<p>Return annotated account resource if iam summary filter matches.</p>
<p>Some use cases include, detecting root api keys or mfa usage.</p>
<p>Example iam summary wrt to matchable fields:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
      <span class="s2">&quot;AccessKeysPerUserQuota&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;AccountAccessKeysPresent&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;AccountMFAEnabled&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;AccountSigningCertificatesPresent&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;AssumeRolePolicySizeQuota&quot;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
      <span class="s2">&quot;AttachedPoliciesPerGroupQuota&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s2">&quot;AttachedPoliciesPerRoleQuota&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s2">&quot;AttachedPoliciesPerUserQuota&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s2">&quot;GroupPolicySizeQuota&quot;</span><span class="p">:</span> <span class="mi">5120</span><span class="p">,</span>
      <span class="s2">&quot;Groups&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;GroupsPerUserQuota&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="s2">&quot;GroupsQuota&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s2">&quot;InstanceProfiles&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;InstanceProfilesQuota&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s2">&quot;MFADevices&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s2">&quot;MFADevicesInUse&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;Policies&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s2">&quot;PoliciesQuota&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
      <span class="s2">&quot;PolicySizeQuota&quot;</span><span class="p">:</span> <span class="mi">5120</span><span class="p">,</span>
      <span class="s2">&quot;PolicyVersionsInUse&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
      <span class="s2">&quot;PolicyVersionsInUseQuota&quot;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
      <span class="s2">&quot;Providers&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;RolePolicySizeQuota&quot;</span><span class="p">:</span> <span class="mi">10240</span><span class="p">,</span>
      <span class="s2">&quot;Roles&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
      <span class="s2">&quot;RolesQuota&quot;</span><span class="p">:</span> <span class="mi">250</span><span class="p">,</span>
      <span class="s2">&quot;ServerCertificates&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;ServerCertificatesQuota&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
      <span class="s2">&quot;SigningCertificatesPerUserQuota&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;UserPolicySizeQuota&quot;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
      <span class="s2">&quot;Users&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
      <span class="s2">&quot;UsersQuota&quot;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
      <span class="s2">&quot;VersionsPerPolicyQuota&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>For example to determine if an account has either not been
enabled with root mfa or has root api keys.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root-keys-or-no-mfa</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-summary</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AccountMFAEnabled</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">        </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">swap</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="s3-public-block-no-examples">
<h3><a class="toc-backref" href="#id64" role="doc-backlink">s3-public-block (no examples)</a><a class="headerlink" href="#s3-public-block-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;s3-public-block&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.account</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/account.py</span></code> 1066</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">s3</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">block</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">S3PublicBlock</span>
</pre></div>
</div>
<p>Check for s3 public blocks on an account.</p>
<p><a class="reference external" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/access-control-block-public-access.html">https://docs.aws.amazon.com/AmazonS3/latest/dev/access-control-block-public-access.html</a></p>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="rest-integration-no-examples">
<h3><a class="toc-backref" href="#id65" role="doc-backlink">rest-integration (no examples)</a><a class="headerlink" href="#rest-integration-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;all&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ANY&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;PUT&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;GET&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;POST&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;DELETE&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;OPTIONS&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;HEAD&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;PATCH&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;rest-integration&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.rest-resource</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/apigw.py</span></code> 329</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@RestResource</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">rest</span><span class="o">-</span><span class="n">integration</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FilterRestIntegration</span>
</pre></div>
</div>
<p>Filter rest resources based on a key value for the rest method integration of the api</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api-method-integrations-with-type-aws</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rest-resource</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rest-integration</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="rest-method-no-examples">
<h3><a class="toc-backref" href="#id66" role="doc-backlink">rest-method (no examples)</a><a class="headerlink" href="#rest-method-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;all&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ANY&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;PUT&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;GET&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;POST&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;DELETE&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;OPTIONS&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;HEAD&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;PATCH&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;rest-method&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.rest-resource</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/apigw.py</span></code> 505</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@RestResource</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">rest</span><span class="o">-</span><span class="n">method</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FilterRestMethod</span>
</pre></div>
</div>
<p>Filter rest resources based on a key value for the rest method of the api</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api-without-key-required</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rest-resource</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rest-method</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apiKeyRequired</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="target-group-no-examples">
<h3><a class="toc-backref" href="#id67" role="doc-backlink">target-group (no examples)</a><a class="headerlink" href="#target-group-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;target-group&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.app-elb</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/appelb.py</span></code> 826</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">target</span><span class="o">-</span><span class="n">group</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AppELBTargetGroupFilter</span>
</pre></div>
</div>
<p>Filter ALB based on matching target group value</p>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="instance-attribute-no-examples">
<h3><a class="toc-backref" href="#id68" role="doc-backlink">instance-attribute (no examples)</a><a class="headerlink" href="#instance-attribute-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">attribute</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;instanceType&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;kernel&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ramdisk&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;userData&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;disableApiTermination&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;instanceInitiatedShutdownBehavior&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;rootDeviceName&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;blockDeviceMapping&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;productCodes&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;sourceDestCheck&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;groupSet&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ebsOptimized&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;sriovNetSupport&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enaSupport&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;instance-attribute&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 1686</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">instance</span><span class="o">-</span><span class="n">attribute</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InstanceAttribute</span>
</pre></div>
</div>
<p>EC2 Instance Value FIlter on a given instance attribute.</p>
<p>Filters EC2 Instances with the given instance attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-unoptimized-ebs</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance-attribute</span>
<span class="w">        </span><span class="nt">attribute</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebsOptimized</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Value&quot;</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="ssm-no-examples">
<h3><a class="toc-backref" href="#id69" role="doc-backlink">ssm (no examples)</a><a class="headerlink" href="#ssm-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;ssm&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 812</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@EC2</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">ssm</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SsmStatus</span>
</pre></div>
</div>
<p>Filter ec2 instances by their ssm status information.</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Find ubuntu 18.04 instances are active with ssm.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-recover-instances</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssm</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PingStatus</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Online</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssm</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PlatformName</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ubuntu</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssm</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PlatformVersion</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">18.04</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="event-source-no-examples">
<h3><a class="toc-backref" href="#id70" role="doc-backlink">event-source (no examples)</a><a class="headerlink" href="#event-source-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;event-source&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.lambda</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/awslambda.py</span></code> 206</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">event</span><span class="o">-</span><span class="n">source</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LambdaEventSource</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="db-parameter-no-examples">
<h3><a class="toc-backref" href="#id71" role="doc-backlink">db-parameter (no examples)</a><a class="headerlink" href="#db-parameter-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;db-parameter&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.rds</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rds.py</span></code> 1505</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">db</span><span class="o">-</span><span class="n">parameter</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ParameterFilter</span>
</pre></div>
</div>
<p>Applies value type filter on set db parameter values.
:example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-pg</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db-parameter</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">someparam</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">someval</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="param-no-examples">
<h3><a class="toc-backref" href="#id72" role="doc-backlink">param (no examples)</a><a class="headerlink" href="#param-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;param&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.redshift</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/redshift.py</span></code> 131</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Parameter</span>
</pre></div>
</div>
<p>Filter redshift clusters based on parameter values</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redshift-no-ssl</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redshift</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">param</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">require_ssl</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="bucket-notification-no-examples">
<h3><a class="toc-backref" href="#id73" role="doc-backlink">bucket-notification (no examples)</a><a class="headerlink" href="#bucket-notification-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;lambda&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;sns&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;sqs&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;bucket-notification&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.s3</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/s3.py</span></code> 932</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">bucket</span><span class="o">-</span><span class="n">notification</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BucketNotificationFilter</span>
</pre></div>
</div>
<p>Filter based on bucket notification configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete-incorrect-notification</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bucket-notification</span>
<span class="w">        </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lambda</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Id</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;IncorrectLambda&quot;</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete-bucket-notification</span>
<span class="w">        </span><span class="nt">statement_ids</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">matched</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="inventory-no-examples">
<h3><a class="toc-backref" href="#id74" role="doc-backlink">inventory (no examples)</a><a class="headerlink" href="#inventory-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;inventory&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.s3</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/s3.py</span></code> 2292</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">inventory</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Inventory</span>
</pre></div>
</div>
<p>Filter inventories for a bucket</p>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="route-no-examples">
<h3><a class="toc-backref" href="#id75" role="doc-backlink">route (no examples)</a><a class="headerlink" href="#route-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;eq&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ne&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-equal&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;greater-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ge&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;gte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;le&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lte&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;lt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;less-than&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;glob&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;regex&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ni&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;not-in&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;contains&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;difference&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;intersect&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;route&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;null&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">value_from</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;additionalProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">],</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;format&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;csv&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;json&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;txt&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;csv2dict&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}}}</span>
<span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;age&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expiration&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;normalize&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cidr_size&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;swap&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;resource_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;expr&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;unique_size&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.route-table</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1333</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@RouteTable</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">route</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Route</span>
</pre></div>
</div>
<p>Filter a route table by its routes’ attributes.</p>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
</section>
<section id="singleton-boolean-filters">
<h2><a class="toc-backref" href="#id76" role="doc-backlink">Singleton/Boolean Filters</a><a class="headerlink" href="#singleton-boolean-filters" title="Link to this heading">¶</a></h2>
<section id="skip-ami-snapshots">
<h3><a class="toc-backref" href="#id77" role="doc-backlink">skip-ami-snapshots</a><a class="headerlink" href="#skip-ami-snapshots" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;skip-ami-snapshots&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.ebs-snapshot</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ebs.py</span></code> 237</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Snapshot</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">skip</span><span class="o">-</span><span class="n">ami</span><span class="o">-</span><span class="n">snapshots</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SnapshotSkipAmiSnapshots</span>
</pre></div>
</div>
<p>Filter to remove snapshots of AMIs from results</p>
<p>This filter is ‘true’ by default.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>implicit with no parameters, ‘true’ by default</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete-stale-snapshots</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs-snapshot</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">        </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">28</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">skip-ami-snapshots</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>explicit with parameter</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete-snapshots</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs-snapshot</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">        </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">28</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ge</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">skip-ami-snapshots</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 86 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs-snapshot-untagged-delete</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Delete any EBS snapshots whose delete date has arrived.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs-snapshot</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">skip-ami-snapshots</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SnapshotId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all.exceptions.[&quot;ebs-snapshot&quot;][].snapshot.[&quot;SnapshotId&quot;][].*[].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Name</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ne</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REDACTED NAME</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete</span>
<span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_tagging</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marked-for-op</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">not</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ASV</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">                </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">                </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">                </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:BA</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">                </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">                </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">                </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerContact</span>
<span class="w">            </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">            </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:GroupName</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EMMO</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ApplicationName</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EMMO-FactFinder</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ApplicationName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:Environment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:Uptime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ApplicationName</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Environment</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Uptime</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs-snapshot-untagged-two-day-warning</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Final warning for EBS snapshots marked for delete.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs-snapshot</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">skip-ami-snapshots</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SnapshotId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all.exceptions.[&quot;ebs-snapshot&quot;][].snapshot.[&quot;SnapshotId&quot;][].*[].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Name</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ne</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REDACTED NAME</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerContact</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">        </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerEID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerEID</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">        </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerEID</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(^[A-Za-z]{3}[0-9]{3}$)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete</span>
<span class="w">    </span><span class="nt">skew</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_tagging</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marked-for-op</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">not</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ASV</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">                </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">                </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">                </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:BA</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:BA</span>
<span class="w">                </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">                </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">                </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerContact</span>
<span class="w">            </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">            </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">            </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:GroupName</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EMMO</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ApplicationName</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EMMO-FactFinder</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-in</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASVredacted</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:ApplicationName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:Environment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:Uptime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ApplicationName</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Environment</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Uptime</span>
<span class="w">          </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">          </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs-snapshot-untagged-two-day-warning-no-owner</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Final warning for EBS snapshots marked for delete.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs-snapshot</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">skip-ami-snapshots</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SnapshotId</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all.exceptions.[&quot;ebs-snapshot&quot;][].snapshot.[&quot;SnapshotId&quot;][].*[].*[]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:Name</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ne</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REDACTED NAME</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerContact</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">      </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerEID</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerEID</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">      </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:OwnerEID</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(?!(^[A-Za-z]{3}[0-9]{3})$)</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete</span>
<span class="w">    </span><span class="nt">skew</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_tagging</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marked-for-op</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="missing-policy-statement">
<h3><a class="toc-backref" href="#id78" role="doc-backlink">missing-policy-statement</a><a class="headerlink" href="#missing-policy-statement" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">statement_ids</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;missing-policy-statement&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;missing-statement&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.s3</p>
<p>No implementation for missing-policy-statement.
Policies studied have 65 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-encrypt-keys</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ISRM 12 - S3 nightly encrypt job for any unencrypted keys</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">statement_ids</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireEncryptedPutObject</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">missing-policy-statement</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-encrypt-keys</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ISRM 12 - S3 nightly encrypt job for any unencrypted keys</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">statement_ids</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireEncryptedPutObject</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">missing-policy-statement</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-encrypt-keys</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ISRM 12 - S3 nightly encrypt job for any unencrypted keys</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">statement_ids</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireEncryptedPutObject</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">missing-policy-statement</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="ssl-policy">
<h3><a class="toc-backref" href="#id79" role="doc-backlink">ssl-policy</a><a class="headerlink" href="#ssl-policy" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">blacklist</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">matching</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;ssl-policy&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">whitelist</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
</pre></div>
</div>
<p>Used by aws.elb</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elb.py</span></code> 514</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">ssl</span><span class="o">-</span><span class="n">policy</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SSLPolicyFilter</span>
</pre></div>
</div>
<p>Filter ELBs on the properties of SSLNegotation policies.
TODO: Only works on custom policies at the moment.</p>
<p>whitelist: filter all policies containing permitted protocols
blacklist: filter all policies containing forbidden protocols</p>
<p>Cannot specify both whitelist &amp; blacklist in the same policy. These must
be done seperately (seperate policy statements).</p>
<p>Likewise, if you want to reduce the consideration set such that we only
compare certain keys (e.g. you only want to compare the <cite>Protocol-</cite> keys),
you can use the <cite>matching</cite> option with a regular expression:</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb-ssl-policies</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssl-policy</span>
<span class="w">        </span><span class="nt">blacklist</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;Protocol-SSLv2&quot;</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;Protocol-SSLv3&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb-modern-tls</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssl-policy</span>
<span class="w">        </span><span class="nt">matching</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^Protocol-&quot;</span>
<span class="w">        </span><span class="nt">whitelist</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;Protocol-TLSv1.1&quot;</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;Protocol-TLSv1.2&quot;</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 40 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-elb-ssl-require-tls12</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ISRM 8 - HTTPS/SSL ELBs should have secure ciphers/protocols only.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CreatedTime</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">greater-than</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.011</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssl-policy</span>
<span class="w">    </span><span class="nt">whitelist</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ECDHE-ECDSA-AES128-GCM-SHA256</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ECDHE-RSA-AES128-GCM-SHA256</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ECDHE-ECDSA-AES256-GCM-SHA384</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ECDHE-RSA-AES256-GCM-SHA384</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DHE-RSA-AES128-GCM-SHA256</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DHE-RSA-AES256-GCM-SHA384</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Protocol-TLSv1.2</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Server-Defined-Cipher-Order</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-elb-ssl-require-tls12-temp</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ISRM 8 - HTTPS/SSL ELBs should have secure ciphers/protocols only.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CreatedTime</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">greater-than</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.011</span>
<span class="w">    </span><span class="nt">value_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">age</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssl-policy</span>
<span class="w">    </span><span class="nt">whitelist</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ECDHE-ECDSA-AES128-GCM-SHA256</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ECDHE-RSA-AES128-GCM-SHA256</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ECDHE-ECDSA-AES256-GCM-SHA384</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ECDHE-RSA-AES256-GCM-SHA384</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DHE-RSA-AES128-GCM-SHA256</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DHE-RSA-AES256-GCM-SHA384</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Protocol-TLSv1.2</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Server-Defined-Cipher-Order</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb-ssl-whitelist</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ISRM 8 - HTTPS/SSL ELBs should have secure ciphers/protocols only.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssl-policy</span>
<span class="w">    </span><span class="nt">whitelist</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Protocol-TLSv1.2</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Server-Defined-Cipher-Order</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ECDHE-ECDSA-AES128-GCM-SHA256</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ECDHE-RSA-AES128-GCM-SHA256</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ECDHE-ECDSA-AES256-GCM-SHA384</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ECDHE-RSA-AES256-GCM-SHA384</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DHE-RSA-AES128-GCM-SHA256</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DHE-RSA-AES256-GCM-SHA384</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="service-limit">
<h3><a class="toc-backref" href="#id80" role="doc-backlink">service-limit</a><a class="headerlink" href="#service-limit" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">limits</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">refresh_period</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">services</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;EC2&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ELB&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;VPC&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;AutoScaling&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;RDS&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;EBS&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;SES&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;IAM&#39;</span><span class="p p-Indicator">]}}</span>
<span class="nt">threshold</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;service-limit&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.account</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/account.py</span></code> 348</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">service</span><span class="o">-</span><span class="n">limit</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ServiceLimit</span>
</pre></div>
</div>
<p>Check if account’s service limits are past a given threshold.</p>
<p>Supported limits are per trusted advisor, which is variable based
on usage in the account and support level enabled on the account.</p>
<blockquote>
<div><ul class="simple">
<li><p>service: AutoScaling limit: Auto Scaling groups</p></li>
<li><p>service: AutoScaling limit: Launch configurations</p></li>
<li><p>service: EBS limit: Active snapshots</p></li>
<li><p>service: EBS limit: Active volumes</p></li>
<li><p>service: EBS limit: General Purpose (SSD) volume storage (GiB)</p></li>
<li><p>service: EBS limit: Magnetic volume storage (GiB)</p></li>
<li><p>service: EBS limit: Provisioned IOPS</p></li>
<li><p>service: EBS limit: Provisioned IOPS (SSD) storage (GiB)</p></li>
<li><p>service: EC2 limit: Elastic IP addresses (EIPs)</p></li>
</ul>
<p># Note this is extant for each active instance type in the account
# however the total value is against sum of all instance types.
# see issue <a class="reference external" href="https://github.com/capitalone/cloud-custodian/issues/516">https://github.com/capitalone/cloud-custodian/issues/516</a></p>
<ul class="simple">
<li><p>service: EC2 limit: On-Demand instances - m3.medium</p></li>
<li><p>service: EC2 limit: Reserved Instances - purchase limit (monthly)</p></li>
<li><p>service: ELB limit: Active load balancers</p></li>
<li><p>service: IAM limit: Groups</p></li>
<li><p>service: IAM limit: Instance profiles</p></li>
<li><p>service: IAM limit: Roles</p></li>
<li><p>service: IAM limit: Server certificates</p></li>
<li><p>service: IAM limit: Users</p></li>
<li><p>service: RDS limit: DB instances</p></li>
<li><p>service: RDS limit: DB parameter groups</p></li>
<li><p>service: RDS limit: DB security groups</p></li>
<li><p>service: RDS limit: DB snapshots per user</p></li>
<li><p>service: RDS limit: Storage quota (GB)</p></li>
<li><p>service: RDS limit: Internet gateways</p></li>
<li><p>service: SES limit: Daily sending quota</p></li>
<li><p>service: VPC limit: VPCs</p></li>
<li><p>service: VPC limit: VPC Elastic IP addresses (EIPs)</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account-service-limits</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">service-limit</span>
<span class="w">        </span><span class="nt">services</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EC2</span>
<span class="w">        </span><span class="nt">threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">specify-region-for-global-service</span>
<span class="w">    </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">us-east-1</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">service-limit</span>
<span class="w">        </span><span class="nt">services</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IAM</span>
<span class="w">        </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Roles</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 35 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account-service-limits-notify</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Reports back to Shared Tech Operations any service limits exceeding 80%</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">service-limit</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account-service-limits-notify</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Reports back to Shared Tech Operations any service limits exceeding 80%</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">service-limit</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account-service-limits-notify</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Reports back to Shared Tech Operations any service limits exceeding 80%</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">service-limit</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="ingress">
<h3><a class="toc-backref" href="#id81" role="doc-backlink">ingress</a><a class="headerlink" href="#ingress" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">Ports</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">SelfReference</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">match-operator</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;or&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;and&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;ingress&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.security-group</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1041</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@SecurityGroup</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">ingress</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IPPermission</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 32 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sg-rule-3a-public-subnet-ingress</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Notify security group in public subnet that does not comply with ingress rules</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:NetworkLocation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PubFacing</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:NetworkLocation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Public</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Cidr</span><span class="p">:</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0/0</span>
<span class="w">    </span><span class="nt">OnlyPorts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8098</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ingress</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sg-rule-3a-nonpublic-subnet-ingress</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Notify security group in nonpublic subnet that does not comply with ingress rules</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:NetworkLocation</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Public</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:NetworkLocation</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-equal</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PubFacing</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Cidr</span><span class="p">:</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0/0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">::/0</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ingress</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sg-rule-3a-public-subnet-ingress</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Notify security group in public subnet that does not comply with ingress rules</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">or</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:NetworkLocation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PubFacing</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:NetworkLocation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Public</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Cidr</span><span class="p">:</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0/0</span>
<span class="w">    </span><span class="nt">OnlyPorts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8098</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ingress</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="global-grants">
<h3><a class="toc-backref" href="#id82" role="doc-backlink">global-grants</a><a class="headerlink" href="#global-grants" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">allow_website</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;or&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;and&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">permissions</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;READ&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;WRITE&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;WRITE_ACP&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;READ_ACP&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;FULL_CONTROL&#39;</span><span class="p p-Indicator">]}}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;global-grants&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.s3</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/s3.py</span></code> 644</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="k">global</span><span class="o">-</span><span class="n">grants</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GlobalGrantsFilter</span>
</pre></div>
</div>
<p>Filters for all S3 buckets that have global-grants</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-delete-global-grants</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global-grants</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete-global-grants</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 25 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">deny-s3-global-access</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global-grants</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-deny-s3-global-access</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Check for global access to s3 buckets and</span>
<span class="l l-Scalar l-Scalar-Plain">report them.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global-grants</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-deny-s3-global-access-lambda</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Check for global access to s3 buckets and</span>
<span class="l l-Scalar l-Scalar-Plain">report them.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global-grants</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="last-write">
<h3><a class="toc-backref" href="#id83" role="doc-backlink">last-write</a><a class="headerlink" href="#last-write" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;number&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;last-write&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.log-group</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/cw.py</span></code> 232</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@LogGroup</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">last</span><span class="o">-</span><span class="n">write</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LastWriteDays</span>
</pre></div>
</div>
<p>Filters CloudWatch log groups by last write</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cloudwatch-stale-groups</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">log-group</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">last-write</span>
<span class="w">        </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 14 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">log-group-thirty-day-report</span>
<span class="nt">comments</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Report on log groups that haven&#39;t been used in 30 days</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">log-group</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">last-write</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">log-group-gc</span>
<span class="nt">comments</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Delete log groups that haven&#39;t been used in 60 days</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">log-group</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">last-write</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-cloudwatch-loggroup-notify-unused</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Notify log groups that have not been writen to in over 55 days</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">log-group</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">55</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">last-write</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="invalid">
<h3><a class="toc-backref" href="#id84" role="doc-backlink">invalid</a><a class="headerlink" href="#invalid" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;invalid&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.asg</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/asg.py</span></code> 372</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">invalid</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">InvalidConfigFilter</span>
</pre></div>
</div>
<p>Filter autoscale groups to find those that are structurally invalid.</p>
<p>Structurally invalid means that the auto scale group will not be able
to launch an instance succesfully as the configuration has</p>
<ul class="simple">
<li><p>invalid subnets</p></li>
<li><p>invalid security groups</p></li>
<li><p>invalid key pair name</p></li>
<li><p>invalid launch config volume snapshots</p></li>
<li><p>invalid amis</p></li>
<li><p>invalid health check elb (slower)</p></li>
</ul>
<p>Internally this tries to reuse other resource managers for better
cache utilization.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"></dd>
</dl>
</li>
</ul>
<p>Policies studied have 11 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-invalid-check</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Any ASGs which are now invalid (invalid subnets, invalid</span>
<span class="l l-Scalar l-Scalar-Plain">launch config volume snapshots, invalid amis, invalid health</span>
<span class="l l-Scalar l-Scalar-Plain">check elb, invalid key pair name, invalid ami) should be marked</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_invalid_asg</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">invalid</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-invalid-check-no-ownercontact</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Any ASGs which are now invalid (invalid subnets, invalid</span>
<span class="l l-Scalar l-Scalar-Plain">launch config volume snapshots, invalid amis, invalid health</span>
<span class="l l-Scalar l-Scalar-Plain">check elb, invalid key pair name, invalid ami) should be marked</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_invalid_asg</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">invalid</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-invalid-check</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Any ASGs which are now invalid (invalid subnets, invalid</span>
<span class="l l-Scalar l-Scalar-Plain">launch config volume snapshots, invalid amis, invalid health</span>
<span class="l l-Scalar l-Scalar-Plain">check elb, invalid key pair name, invalid ami) should be marked</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_invalid_asg</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:OwnerContact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">invalid</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="not-encrypted">
<h3><a class="toc-backref" href="#id85" role="doc-backlink">not-encrypted</a><a class="headerlink" href="#not-encrypted" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">exclude_image</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;not-encrypted&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.asg</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/asg.py</span></code> 408</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="ow">not</span><span class="o">-</span><span class="n">encrypted</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NotEncryptedFilter</span>
</pre></div>
</div>
<p>Check if an ASG is configured to have unencrypted volumes.</p>
<p>Checks both the ami snapshots and the launch configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-unencrypted</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-encrypted</span>
<span class="w">        </span><span class="nt">exclude_image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 7 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-existing-non-encrypted</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-encrypted</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-asg-unencrypted-delete</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Require EBS encryption for all newly provisioned ASGs.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-encrypted</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-asg-unencrypted-delete-existing</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Require EBS encryption for all existing provisioned ASGs.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-encrypted</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="is-log-target">
<h3><a class="toc-backref" href="#id86" role="doc-backlink">is-log-target</a><a class="headerlink" href="#is-log-target" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">self</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">services</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;s3&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;elb&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;cloudtrail&#39;</span><span class="p p-Indicator">]}}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;is-log-target&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.s3</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/s3.py</span></code> 1954</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="ow">is</span><span class="o">-</span><span class="n">log</span><span class="o">-</span><span class="n">target</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LogTarget</span>
</pre></div>
</div>
<p>Filter and return buckets are log destinations.</p>
<p>Not suitable for use in lambda on large accounts, This is a api
heavy process to detect scan all possible log sources.</p>
<dl class="simple">
<dt>Sources:</dt><dd><ul class="simple">
<li><p>elb (Access Log)</p></li>
<li><p>s3 (Access Log)</p></li>
<li><p>cfn (Template writes)</p></li>
<li><p>cloudtrail</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-log-bucket</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-log-target</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 7 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-self-loggging-buckets</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">self</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-log-target</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(?!cf-templates-.*|.*cloudformation.*|ent.*s3-access-logs-us.*|ent.*elb-access-logs-us.*|elasticbeanstalk-us.*|.*cloud-maid.*)</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-self-loggging-buckets</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">self</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-log-target</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(?!cf-templates-.*|.*cloudformation.*|ent.*s3-access-logs-us.*|ent.*elb-access-logs-us.*|elasticbeanstalk-us.*|.*cloud-maid.*)</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parent-s3-self-loggging-buckets</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">self</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-log-target</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Name</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(?!cf-templates-.*|.*cloudformation.*|ent.*s3-access-logs-us.*|ent.*elb-access-logs-us.*|elasticbeanstalk-us.*|.*cloud-maid.*)</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="has-statement">
<h3><a class="toc-backref" href="#id87" role="doc-backlink">has-statement</a><a class="headerlink" href="#has-statement" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">statement_ids</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">statements</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;properties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;Sid&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;Effect&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;Allow&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;Deny&#39;</span><span class="p p-Indicator">]},</span><span class="w"> </span><span class="s">&#39;Principal&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;anyOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">}]},</span><span class="w"> </span><span class="s">&#39;NotPrincipal&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;anyOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">}]},</span><span class="w"> </span><span class="s">&#39;Action&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;anyOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">}]},</span><span class="w"> </span><span class="s">&#39;NotAction&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;anyOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">}]},</span><span class="w"> </span><span class="s">&#39;Resource&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;anyOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">}]},</span><span class="w"> </span><span class="s">&#39;NotResource&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;anyOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">}]},</span><span class="w"> </span><span class="s">&#39;Condition&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}},</span><span class="w"> </span><span class="s">&#39;required&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;Effect&#39;</span><span class="p p-Indicator">]}}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;has-statement&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.s3</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/s3.py</span></code> 748</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">has</span><span class="o">-</span><span class="n">statement</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">HasStatementFilter</span>
</pre></div>
</div>
<p>Find buckets with set of policy statements.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-bucket-has-statement</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">has-statement</span>
<span class="w">        </span><span class="nt">statement_ids</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequiredEncryptedPutObject</span>


<span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-public-policy</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">has-statement</span>
<span class="w">        </span><span class="nt">statements</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Effect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Allow</span>
<span class="w">            </span><span class="nt">Action</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;s3:*&#39;</span>
<span class="w">            </span><span class="nt">Principal</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;*&#39;</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 6 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-unmark-updated-buckets</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">if the bucket has a compliant policy, unmark the bucket</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:c7n_s3_policy_required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">statements</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3:*</span>
<span class="w">        </span><span class="nt">Effect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deny</span>
<span class="w">        </span><span class="nt">Principal</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;*&#39;</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">has-statement</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">o-rhymjmbbe2</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">statements</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3:*</span>
<span class="w">      </span><span class="nt">Condition</span><span class="p">:</span>
<span class="w">        </span><span class="nt">Bool</span><span class="p">:</span>
<span class="w">          </span><span class="nt">aws:SecureTransport</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;false&#39;</span>
<span class="w">      </span><span class="nt">Effect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deny</span>
<span class="w">      </span><span class="nt">Principal</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;*&#39;</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">has-statement</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-invalid-creation-fixed-hourly</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Delete specific tag on S3 buckets that have been corrected adhering to RDT S3 template.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">statement_ids</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RequireSSLAccessRDT</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">has-statement</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_s3_ns_template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-s3-unmark-updated-buckets</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">if the bucket has a compliant policy, unmark the bucket</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:c7n_s3_policy_required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">and</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">statements</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3:*</span>
<span class="w">        </span><span class="nt">Effect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deny</span>
<span class="w">        </span><span class="nt">Principal</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;*&#39;</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">has-statement</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">o-rhymjmbbe2</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contains</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arn:aws:sts::{account_id}:assumed-role/Redacted/*</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">statements</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3:*</span>
<span class="w">      </span><span class="nt">Condition</span><span class="p">:</span>
<span class="w">        </span><span class="nt">Bool</span><span class="p">:</span>
<span class="w">          </span><span class="nt">aws:SecureTransport</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;false&#39;</span>
<span class="w">      </span><span class="nt">Effect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deny</span>
<span class="w">      </span><span class="nt">Principal</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;*&#39;</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">has-statement</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="missing">
<h3><a class="toc-backref" href="#id88" role="doc-backlink">missing</a><a class="headerlink" href="#missing" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policy</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;missing&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.account</p>
<p>No implementation for missing.
Policies studied have 5 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-policy-sqlserverauditing-enable</span>
<span class="nt">comments</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensure that SQL auditing is enabled. This custodian policy</span>
<span class="l l-Scalar l-Scalar-Plain">checks to see if auditing is enabled at the server level.</span>
<span class="l l-Scalar l-Scalar-Plain">If not, it applies an azure policy which will enable</span>
<span class="l l-Scalar l-Scalar-Plain">auditing</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure.subscription</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">policy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">properties.displayName</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Audit SQL server level Auditing settings</span>
<span class="w">      </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure.policyassignments</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">missing</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-policy-deny-byol-enable</span>
<span class="nt">comments</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensure that denial of bring your own license azure policy enabled.</span>
<span class="l l-Scalar l-Scalar-Plain">If not, it applies the azure policy which will enable</span>
<span class="l l-Scalar l-Scalar-Plain">auditing.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure.subscription</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">policy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">properties.displayName</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azr-ctl-vm-002</span>
<span class="w">      </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure.policyassignments</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">missing</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure-policy-allowed-resources-enable</span>
<span class="nt">comments</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensure that allowed resources azure policy enabled.</span>
<span class="l l-Scalar l-Scalar-Plain">If not, it applies the azure policy which will enable</span>
<span class="l l-Scalar l-Scalar-Plain">auditing.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure.subscription</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">policy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">properties.displayName</span>
<span class="w">        </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eq</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azr-ctl-core-002</span>
<span class="w">      </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure.policyassignments</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">missing</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="mismatch-s3-origin">
<h3><a class="toc-backref" href="#id89" role="doc-backlink">mismatch-s3-origin</a><a class="headerlink" href="#mismatch-s3-origin" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">check_custom_origins</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;mismatch-s3-origin&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.distribution</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/cloudfront.py</span></code> 183</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Distribution</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">mismatch</span><span class="o">-</span><span class="n">s3</span><span class="o">-</span><span class="n">origin</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MismatchS3Origin</span>
</pre></div>
</div>
<dl class="simple">
<dt>Check for existence of S3 bucket referenced by Cloudfront,</dt><dd><p>and verify whether owner is different from Cloudfront account owner.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mismatch-s3-origin</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">distribution</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mismatch-s3-origin</span>
<span class="w">        </span><span class="nt">check_custom_origins</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 5 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-distribution-with-missing-or-mismatched-origin</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Identify CloudFront Distributions with non-existant S3 Origins or</span>
<span class="l l-Scalar l-Scalar-Plain">Origins that are owned by a different account than the CF Distribution.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">distribution</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">check_custom_origins</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mismatch-s3-origin</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-distribution-with-missing-or-mismatched-origin</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Identify CloudFront Distributions with non-existant S3 Origins or</span>
<span class="l l-Scalar l-Scalar-Plain">Origins that are owned by a different account than the CF Distribution.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">distribution</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">check_custom_origins</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mismatch-s3-origin</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enterprise-distribution-with-missing-or-mismatched-origin</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Identify CloudFront Distributions with non-existant S3 Origins or</span>
<span class="l l-Scalar l-Scalar-Plain">Origins that are owned by a different account than the CF Distribution.</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">distribution</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">check_custom_origins</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mismatch-s3-origin</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="egress">
<h3><a class="toc-backref" href="#id90" role="doc-backlink">egress</a><a class="headerlink" href="#egress" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">SelfReference</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">match-operator</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;or&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;and&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;egress&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.security-group</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1057</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@SecurityGroup</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">egress</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IPPermissionEgress</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 5 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sg-rule-egress-notify</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Notify security group that does not comply with egress rules</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Cidr</span><span class="p">:</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0/0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">::/0</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">egress</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sg-rule-egress-notify</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Notify security group that does not comply with egress rules</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Cidr</span><span class="p">:</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0/0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">::/0</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">egress</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sg-rule-3a-nonpublic-egress-mark</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0/0 egress is not allowed</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:egress_violation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Cidr</span><span class="p">:</span>
<span class="w">      </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0/0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">::/0</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">egress</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="valid">
<h3><a class="toc-backref" href="#id91" role="doc-backlink">valid</a><a class="headerlink" href="#valid" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;valid&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.asg</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/asg.py</span></code> 345</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ValidConfigFilter</span>
</pre></div>
</div>
<p>Filters autoscale groups to find those that are structurally valid.</p>
<p>This operates as the inverse of the invalid filter for multi-step
workflows.</p>
<p>See details on the invalid filter for a list of checks made.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"></dd>
</dl>
</li>
</ul>
<p>Policies studied have 4 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-valid-check</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Any ASGs which are now valid should be unmarked</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_invalid_asg</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">valid</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-valid-check</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Any ASGs which are now valid should be unmarked</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_invalid_asg</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">valid</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-valid-check</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Any ASGs which are now valid should be unmarked</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_invalid_asg</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">not-null</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">valid</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="latest">
<h3><a class="toc-backref" href="#id92" role="doc-backlink">latest</a><a class="headerlink" href="#latest" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">automatic</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;latest&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.rds-snapshot</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rds.py</span></code> 1026</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@RDSSnapshot</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">latest</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LatestSnapshot</span>
</pre></div>
</div>
<p>Return the latest snapshot for each database.</p>
</li>
</ul>
<p>Policies studied have 3 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-snapshot-region-copy</span>
<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-snapshot</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:CrossRegionTransfer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">latest</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AllocatedStorage</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lte</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">250</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-snapshot-region-copy-daily</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Copy RDS snapshots from east region to west region</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-snapshot</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:CrossRegionTransfer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">latest</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AllocatedStorage</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lte</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-snapshot-region-copy-daily</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Copy RDS snapshots from east region to west region</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-snapshot</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:CrossRegionTransfer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">latest</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AllocatedStorage</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lte</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="capacity-delta">
<h3><a class="toc-backref" href="#id93" role="doc-backlink">capacity-delta</a><a class="headerlink" href="#capacity-delta" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;capacity-delta&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.asg</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/asg.py</span></code> 806</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">capacity</span><span class="o">-</span><span class="n">delta</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CapacityDelta</span>
</pre></div>
</div>
<p>Filter returns ASG that have less instances than desired or required</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-capacity-delta</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">capacity-delta</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 2 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-invalid-report-daily</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Mark ASGs that are spinning (attempting and failing to launch instances repeatedly) and mark them for deletion in 3 days</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">tag:custodian_invalid</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">invalid</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">capacity-delta</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg-invalid-delete-daily</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Delete ASGs that are spinning (attempting and failing to launch instances repeatedly</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asg</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete</span>
<span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custodian_invalid</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marked-for-op</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:CMDBEnvironment</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.*[].ami.*[].[&quot;tag:CMDBEnvironment&quot;][][]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag:ASV</span>
<span class="w">    </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ni</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">    </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">      </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exemptions.*[].ami.*[].[&quot;tag:ASV&quot;][][]</span>
<span class="w">      </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3://redacted/bucket</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">invalid</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">capacity-delta</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="check-cloudtrail">
<h3><a class="toc-backref" href="#id94" role="doc-backlink">check-cloudtrail</a><a class="headerlink" href="#check-cloudtrail" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">current-region</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">file-digest</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">global-events</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">kms</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">kms-key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">multi-region</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">notifies</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">running</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;check-cloudtrail&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.account</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/account.py</span></code> 98</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">check</span><span class="o">-</span><span class="n">cloudtrail</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CloudTrailEnabled</span>
</pre></div>
</div>
<p>Verify cloud trail enabled for this account per specifications.</p>
<p>Returns an annotated account resource if trail is not enabled.</p>
<p>Of particular note, the current-region option will evaluate whether cloudtrail is available
in the current region, either as a multi region trail or as a trail with it as the home region.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account-cloudtrail-enabled</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="w">    </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">us-east-1</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check-cloudtrail</span>
<span class="w">        </span><span class="nt">global-events</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">multi-region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">running</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 1 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws-cloudtrail-not-enabled</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy scans for accounts which do not have CloudTrails enabled in the current region</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">global-events</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">multi-region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">running</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check-cloudtrail</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="check-config">
<h3><a class="toc-backref" href="#id95" role="doc-backlink">check-config</a><a class="headerlink" href="#check-config" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">all-resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">global-resources</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">running</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;check-config&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.account</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/account.py</span></code> 171</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">check</span><span class="o">-</span><span class="n">config</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ConfigEnabled</span>
</pre></div>
</div>
<p>Is config service enabled for this account</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account-check-config-services</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="w">    </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">us-east-1</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check-config</span>
<span class="w">        </span><span class="nt">all-resources</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">global-resources</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">running</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 1 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws-config-not-enabled</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Policy scans for accounts which do not have the AWS config service enabled</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">all-resources</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">global-resources</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">running</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check-config</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="grant-count">
<h3><a class="toc-backref" href="#id96" role="doc-backlink">grant-count</a><a class="headerlink" href="#grant-count" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;integer&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;minimum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;grant-count&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.kms</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/kms.py</span></code> 162</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@KeyAlias</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">grant</span><span class="o">-</span><span class="n">count</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GrantCount</span>
</pre></div>
</div>
<p>Filters KMS key grants</p>
<p>This can be used to ensure issues around grant limits are monitored</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kms-grants</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kms</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">grant-count</span>
<span class="w">        </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 1 examples.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kms-extant-grants-reporting</span>
<span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Monitor kms keys with more than 100 extant keys. This allows us to setup</span>
<span class="l l-Scalar l-Scalar-Plain">cloudwatch alerts on the grant limits to ensure we don&#39;t end up in a situation</span>
<span class="l l-Scalar l-Scalar-Plain">where we can&#39;t allocate instances or volumes due to hitting max limits on kms grants</span>

<span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kms</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">grant-count</span>

<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># REDACTED #</span>
</pre></div>
</div>
</section>
<section id="has-users-no-examples">
<h3><a class="toc-backref" href="#id97" role="doc-backlink">has-users (no examples)</a><a class="headerlink" href="#has-users-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;has-users&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.iam-group</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 1584</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Group</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">has</span><span class="o">-</span><span class="n">users</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IamGroupUsers</span>
</pre></div>
</div>
<p>Filter IAM groups that have users attached based on True/False value:
True: Filter all IAM groups with users assigned to it
False: Filter all IAM groups without any users assigned to it</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">empty-iam-group</span>
<span class="w">  </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-group</span>
<span class="w">  </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">has-users</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="has-specific-managed-policy-no-examples">
<h3><a class="toc-backref" href="#id98" role="doc-backlink">has-specific-managed-policy (no examples)</a><a class="headerlink" href="#has-specific-managed-policy-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;has-specific-managed-policy&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.iam-role</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 453</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Role</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">has</span><span class="o">-</span><span class="n">specific</span><span class="o">-</span><span class="n">managed</span><span class="o">-</span><span class="n">policy</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SpecificIamRoleManagedPolicy</span>
</pre></div>
</div>
<p>Filter IAM roles that has a specific policy attached</p>
<p>For example, if the user wants to check all roles with ‘admin-policy’:</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-roles-have-admin</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-role</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">has-specific-managed-policy</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">admin-policy</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="no-specific-managed-policy-no-examples">
<h3><a class="toc-backref" href="#id99" role="doc-backlink">no-specific-managed-policy (no examples)</a><a class="headerlink" href="#no-specific-managed-policy-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;no-specific-managed-policy&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.iam-role</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 485</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Role</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">no</span><span class="o">-</span><span class="n">specific</span><span class="o">-</span><span class="n">managed</span><span class="o">-</span><span class="n">policy</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NoSpecificIamRoleManagedPolicy</span>
</pre></div>
</div>
<p>Filter IAM roles that do not have a specific policy attached</p>
<p>For example, if the user wants to check all roles without ‘ip-restriction’:</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-roles-no-ip-restriction</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-role</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no-specific-managed-policy</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ip-restriction</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="has-allow-all-no-examples">
<h3><a class="toc-backref" href="#id100" role="doc-backlink">has-allow-all (no examples)</a><a class="headerlink" href="#has-allow-all-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;has-allow-all&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.iam-policy</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/iam.py</span></code> 619</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Policy</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">has</span><span class="o">-</span><span class="n">allow</span><span class="o">-</span><span class="nb">all</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AllowAllIamPolicies</span>
</pre></div>
</div>
<p>Check if IAM policy resource(s) have allow-all IAM policy statement block.</p>
<p>This allows users to implement CIS AWS check 1.24 which states that no
policy must exist with the following requirements.</p>
<p>Policy must have ‘Action’ and Resource = ‘*’ with ‘Effect’ = ‘Allow’</p>
<p>The policy will trigger on the following IAM policy (statement).
For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Statement&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span>
<span class="w">        </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Allow&quot;</span>
<span class="w">    </span><span class="p">}]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Additionally, the policy checks if the statement has no ‘Condition’ or
‘NotAction’</p>
<p>For example, if the user wants to check all used policies and filter on
allow all:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-no-used-all-all-policy</span>
<span class="w">  </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam-policy</span>
<span class="w">  </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">used</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">has-allow-all</span>
</pre></div>
</div>
<p>Note that scanning and getting all policies and all statements can take
a while. Use it sparingly or combine it with filters such as ‘used’ as
above.</p>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="has-virtual-mfa-no-examples">
<h3><a class="toc-backref" href="#id101" role="doc-backlink">has-virtual-mfa (no examples)</a><a class="headerlink" href="#has-virtual-mfa-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;has-virtual-mfa&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.account</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/account.py</span></code> 739</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">has</span><span class="o">-</span><span class="n">virtual</span><span class="o">-</span><span class="n">mfa</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">HasVirtualMFA</span>
</pre></div>
</div>
<p>Is the account configured with a virtual MFA device?</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account-with-virtual-mfa</span>
<span class="w">      </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account</span>
<span class="w">      </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">us-east-1</span>
<span class="w">      </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">has-virtual-mfa</span>
<span class="w">          </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="xray-encrypt-key-no-examples">
<h3><a class="toc-backref" href="#id102" role="doc-backlink">xray-encrypt-key (no examples)</a><a class="headerlink" href="#xray-encrypt-key-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;xray-encrypt-key&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.account</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/account.py</span></code> 988</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">xray</span><span class="o">-</span><span class="n">encrypt</span><span class="o">-</span><span class="n">key</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">XrayEncrypted</span>
</pre></div>
</div>
<p>Determine if xray is encrypted.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xray-encrypt-with-default</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws.account</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xray-encrypt-key</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xray-encrypt-with-kms</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">- type</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xray-encrypt-key</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">key</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kms</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xray-encrypt-with-specific-key</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">-type</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xray-encrypt-key</span>
<span class="w">       </span><span class="l l-Scalar l-Scalar-Plain">key</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alias/my-alias or arn or keyid</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="ephemeral-no-examples">
<h3><a class="toc-backref" href="#id103" role="doc-backlink">ephemeral (no examples)</a><a class="headerlink" href="#ephemeral-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;ephemeral&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 569</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">ephemeral</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EphemeralInstanceFilter</span>
</pre></div>
</div>
<p>EC2 instances with ephemeral storage</p>
<p>Filters EC2 instances that have ephemeral storage (an instance-store backed
root device)</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-ephemeral-instances</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ephemeral</span>
</pre></div>
</div>
<p><a class="reference external" href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html">http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html</a></p>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="singleton-no-examples">
<h3><a class="toc-backref" href="#id104" role="doc-backlink">singleton (no examples)</a><a class="headerlink" href="#singleton-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;singleton&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 744</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">singleton</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SingletonFilter</span>
</pre></div>
</div>
<p>EC2 instances without autoscaling or a recover alarm</p>
<p>Filters EC2 instances that are not members of an autoscaling group
and do not have Cloudwatch recover alarms.</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2-recover-instances</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">singleton</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">problem</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance is not resilient</span>
</pre></div>
</div>
<p><a class="reference external" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-recover.html">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-recover.html</a></p>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="termination-protected-no-examples">
<h3><a class="toc-backref" href="#id105" role="doc-backlink">termination-protected (no examples)</a><a class="headerlink" href="#termination-protected-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;termination-protected&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ec2</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ec2.py</span></code> 313</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">termination</span><span class="o">-</span><span class="n">protected</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DisableApiTermination</span>
</pre></div>
</div>
<p>EC2 instances with <code class="docutils literal notranslate"><span class="pre">disableApiTermination</span></code> attribute set</p>
<p>Filters EC2 instances with <code class="docutils literal notranslate"><span class="pre">disableApiTermination</span></code> attribute set to true.</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">termination-protection-enabled</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">termination-protected</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">termination-protection-NOT-enabled</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">not</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">termination-protected</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="progagated-tags-no-examples">
<h3><a class="toc-backref" href="#id106" role="doc-backlink">progagated-tags (no examples)</a><a class="headerlink" href="#progagated-tags-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">keys</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}}</span>
<span class="nt">match</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">propagate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;progagated-tags&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;propagated-tags&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.asg</p>
<p>No implementation for progagated-tags.
Policies studied have 0 examples.</p>
</section>
<section id="is-shadow-no-examples">
<h3><a class="toc-backref" href="#id107" role="doc-backlink">is-shadow (no examples)</a><a class="headerlink" href="#is-shadow-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;is-shadow&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.cloudtrail</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/cloudtrail.py</span></code> 45</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@CloudTrail</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="ow">is</span><span class="o">-</span><span class="n">shadow</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IsShadow</span>
</pre></div>
</div>
<p>Identify shadow trails (secondary copies), shadow trails
can’t be modified directly, the origin trail needs to be modified.</p>
<p>Shadow trails are created for multi-region trails as well for
organizational trails.</p>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="fault-tolerant-no-examples">
<h3><a class="toc-backref" href="#id108" role="doc-backlink">fault-tolerant (no examples)</a><a class="headerlink" href="#fault-tolerant-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tolerant</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;fault-tolerant&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ebs</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ebs.py</span></code> 556</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">fault</span><span class="o">-</span><span class="n">tolerant</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FaultTolerantSnapshots</span>
</pre></div>
</div>
<p>This filter will return any EBS volume that does/does not have a
snapshot within the last 7 days. ‘Fault-Tolerance’ in this instance
means that, in the event of a failure, the volume can be restored
from a snapshot with (reasonable) data loss</p>
<ul class="simple">
<li><p>name: ebs-volume-tolerance</p></li>
<li><p>resource: ebs</p></li>
<li><dl class="simple">
<dt>filters: [{</dt><dd><p>‘type’: ‘fault-tolerant’,
‘tolerant’: True}]</p>
</dd>
</dl>
</li>
</ul>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="modifyable-no-examples">
<h3><a class="toc-backref" href="#id109" role="doc-backlink">modifyable (no examples)</a><a class="headerlink" href="#modifyable-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;modifyable&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ebs</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ebs.py</span></code> 1144</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">modifyable</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ModifyableVolume</span>
</pre></div>
</div>
<p>Check if an ebs volume is modifyable online.</p>
<p>Considerations - <a class="reference external" href="https://goo.gl/CBhfqV">https://goo.gl/CBhfqV</a></p>
<dl class="simple">
<dt>Consideration Summary</dt><dd><ul class="simple">
<li><p>only current instance types are supported (one exception m3.medium)
Current Generation Instances (2017-2) <a class="reference external" href="https://goo.gl/iuNjPZ">https://goo.gl/iuNjPZ</a></p></li>
<li><p>older magnetic volume types are not supported</p></li>
<li><p>shrinking volumes is not supported</p></li>
<li><p>must wait at least 6hrs between modifications to the same volume.</p></li>
<li><p>volumes must have been attached after nov 1st, 2016.</p></li>
</ul>
</dd>
</dl>
<p>See <cite>custodian schema ebs.actions.modify</cite> for examples.</p>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="lifecycle-rule-no-examples">
<h3><a class="toc-backref" href="#id110" role="doc-backlink">lifecycle-rule (no examples)</a><a class="headerlink" href="#lifecycle-rule-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">match</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;$ref&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;#/definitions/filters/value&#39;</span><span class="p p-Indicator">},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;object&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;minProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;maxProperties&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">}]}}</span>
<span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;lifecycle-rule&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.ecr</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/ecr.py</span></code> 132</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ECR</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">lifecycle</span><span class="o">-</span><span class="n">rule</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LifecycleRule</span>
</pre></div>
</div>
<p>Lifecycle rule filtering</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ecr-life</span>
<span class="w">   </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws.ecr</span>
<span class="w">   </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lifecycle-rule</span>
<span class="w">       </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">       </span><span class="nt">match</span><span class="p">:</span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">selection.tagStatus</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">untagged</span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action.type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">expire</span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">selection.countNumber</span>
<span class="w">           </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">           </span><span class="nt">op</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">less-than</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="is-ssl-no-examples">
<h3><a class="toc-backref" href="#id111" role="doc-backlink">is-ssl (no examples)</a><a class="headerlink" href="#is-ssl-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;is-ssl&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.elb</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/elb.py</span></code> 493</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="ow">is</span><span class="o">-</span><span class="n">ssl</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IsSSLFilter</span>
</pre></div>
</div>
<p>Filters ELB that are using a SSL policy</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb-using-ssl</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elb</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">is-ssl</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="upgrade-available-no-examples">
<h3><a class="toc-backref" href="#id112" role="doc-backlink">upgrade-available (no examples)</a><a class="headerlink" href="#upgrade-available-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">major</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;upgrade-available&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Used by aws.rds</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/rds.py</span></code> 364</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">upgrade</span><span class="o">-</span><span class="n">available</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UpgradeAvailable</span>
</pre></div>
</div>
<p>Scan DB instances for available engine upgrades</p>
<p>This will pull DB instances &amp; check their specific engine for any
engine version with higher release numbers than the current one</p>
<p>This will also annotate the rds instance with ‘target_engine’ which is
the most recent version of the engine available</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds-upgrade-available</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rds</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">upgrade-available</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">major</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="query-logging-enabled-no-examples">
<h3><a class="toc-backref" href="#id113" role="doc-backlink">query-logging-enabled (no examples)</a><a class="headerlink" href="#query-logging-enabled-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;query-logging-enabled&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.hostedzone</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/route53.py</span></code> 412</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@HostedZone</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">query</span><span class="o">-</span><span class="n">logging</span><span class="o">-</span><span class="n">enabled</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IsQueryLoggingEnabled</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="bucket-encryption-no-examples">
<h3><a class="toc-backref" href="#id114" role="doc-backlink">bucket-encryption (no examples)</a><a class="headerlink" href="#bucket-encryption-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">crypto</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;AES256&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;aws:kms&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;bucket-encryption&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.s3</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/s3.py</span></code> 2788</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">bucket</span><span class="o">-</span><span class="n">encryption</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BucketEncryption</span>
</pre></div>
</div>
<p>Filters for S3 buckets that have bucket-encryption</p>
<p>:example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-bucket-encryption-AES256</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="w">    </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">us-east-1</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bucket-encryption</span>
<span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">        </span><span class="nt">crypto</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AES256</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-bucket-encryption-KMS</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="w">    </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">us-east-1</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">filters</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">- type</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bucket-encryption</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">state</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">crypto</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws:kms</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">key</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alias/some/alias/key</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-bucket-encryption-off</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="w">    </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">us-east-1</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">filters</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">- type</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bucket-encryption</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">state</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="data-events-no-examples">
<h3><a class="toc-backref" href="#id115" role="doc-backlink">data-events (no examples)</a><a class="headerlink" href="#data-events-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;present&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;absent&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;data-events&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.s3</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/s3.py</span></code> 2242</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">data</span><span class="o">-</span><span class="n">events</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DataEvents</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="no-encryption-statement-no-examples">
<h3><a class="toc-backref" href="#id116" role="doc-backlink">no-encryption-statement (no examples)</a><a class="headerlink" href="#no-encryption-statement-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;no-encryption-statement&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.s3</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/s3.py</span></code> 845</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@filters</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">no</span><span class="o">-</span><span class="n">encryption</span><span class="o">-</span><span class="n">statement</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EncryptionEnabledFilter</span>
</pre></div>
</div>
<p>Find buckets with missing encryption policy statements.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-bucket-not-encrypted</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no-encryption-statement</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="dhcp-options-no-examples">
<h3><a class="toc-backref" href="#id117" role="doc-backlink">dhcp-options (no examples)</a><a class="headerlink" href="#dhcp-options-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">domain-name</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">domain-name-servers</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">ntp-servers</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;oneOf&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;array&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;items&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}},</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}]}</span>
<span class="nt">present</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;dhcp-options&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.vpc</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 262</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Vpc</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">dhcp</span><span class="o">-</span><span class="n">options</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DhcpOptionsFilter</span>
</pre></div>
</div>
<p>Filter VPCs based on their dhcp options</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div></blockquote>
<p>if an option value is specified as a list, then all elements must be present.
if an option value is specified as a string, then that string must be present.</p>
<p>vpcs not matching a given option value can be found via specifying
a <cite>present: false</cite> parameter.</p>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="vpc-attributes-no-examples">
<h3><a class="toc-backref" href="#id118" role="doc-backlink">vpc-attributes (no examples)</a><a class="headerlink" href="#vpc-attributes-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">dnshostnames</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">dnssupport</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;vpc-attributes&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.vpc</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 212</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Vpc</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">vpc</span><span class="o">-</span><span class="n">attributes</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AttributesFilter</span>
</pre></div>
</div>
<p>Filters VPCs based on their DNS attributes</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dns-hostname-enabled</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-attributes</span>
<span class="w">        </span><span class="nt">dnshostnames</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="diff-no-examples">
<h3><a class="toc-backref" href="#id119" role="doc-backlink">diff (no examples)</a><a class="headerlink" href="#diff-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">selector</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;previous&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;date&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;locked&#39;</span><span class="p p-Indicator">]}</span>
<span class="nt">selector_value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;diff&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.security-group</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 409</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@SecurityGroup</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityGroupDiffFilter</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="locked-no-examples">
<h3><a class="toc-backref" href="#id120" role="doc-backlink">locked (no examples)</a><a class="headerlink" href="#locked-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;string&#39;</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;locked&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.security-group</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 402</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@SecurityGroup</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">locked</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SecurityGroupLockedFilter</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="stale-no-examples">
<h3><a class="toc-backref" href="#id121" role="doc-backlink">stale (no examples)</a><a class="headerlink" href="#stale-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;stale&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.security-group</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 720</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@SecurityGroup</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">stale</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Stale</span>
</pre></div>
</div>
<p>Filter to find security groups that contain stale references
to other groups that are either no longer present or traverse
a broken vpc peering connection. Note this applies to VPC
Security groups only and will implicitly filter security groups.</p>
<p>AWS Docs - <a class="reference external" href="https://goo.gl/nSj7VG">https://goo.gl/nSj7VG</a></p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stale-security-groups</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-group</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stale</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="missing-route-no-examples">
<h3><a class="toc-backref" href="#id122" role="doc-backlink">missing-route (no examples)</a><a class="headerlink" href="#missing-route-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;missing-route&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.peering-connection</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1437</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@PeeringConnection</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">missing</span><span class="o">-</span><span class="n">route</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MissingRoute</span>
</pre></div>
</div>
<p>Return peers which are missing a route in route tables.</p>
<p>If the peering connection is between two vpcs in the same account,
the connection is returned unless it is in present route tables in
each vpc.</p>
<p>If the peering connection is between accounts, then the local vpc’s
route table is checked.</p>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
<section id="s3-cidr-no-examples">
<h3><a class="toc-backref" href="#id123" role="doc-backlink">s3-cidr (no examples)</a><a class="headerlink" href="#s3-cidr-no-examples" title="Link to this heading">¶</a></h3>
<p>Schema</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">egress</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;default&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">True</span><span class="p p-Indicator">}</span>
<span class="nt">ingress</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;default&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">True</span><span class="p p-Indicator">}</span>
<span class="nt">present</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;type&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;boolean&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;default&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">False</span><span class="p p-Indicator">}</span>
<span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&#39;enum&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;s3-cidr&#39;</span><span class="p p-Indicator">]}</span>
</pre></div>
</div>
<p>Used by aws.network-acl</p>
<p>Resource Type Implementations for {function.name}:</p>
<ul>
<li><p>In <code class="file docutils literal notranslate"><span class="pre">c7n/resources/vpc.py</span></code> 1513</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@NetworkAcl</span><span class="o">.</span><span class="n">filter_registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">s3</span><span class="o">-</span><span class="n">cidr</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AclAwsS3Cidrs</span>
</pre></div>
</div>
<p>Filter network acls by those that allow access to s3 cidrs.</p>
<p>Defaults to filtering those nacls that do not allow s3 communication.</p>
<dl class="field-list simple">
<dt class="field-odd">example<span class="colon">:</span></dt>
<dd class="field-odd"><p>Find all nacls that do not allow communication with s3.</p>
</dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">policies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-not-allowed-nacl</span>
<span class="w">    </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-acl</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3-cidr</span>
</pre></div>
</div>
</li>
</ul>
<p>Policies studied have 0 examples.</p>
</section>
</section>
<section id="summary">
<h2><a class="toc-backref" href="#id124" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><dl class="field-list simple">
<dt class="field-odd">header<span class="colon">:</span></dt>
<dd class="field-odd"><p>category</p>
</dd>
</dl>
</td>
<td><p>count</p></td>
</tr>
<tr class="row-even"><td><p>(‘Common’, ‘Non-Bool’)</p></td>
<td><p>21</p></td>
</tr>
<tr class="row-odd"><td><p>(‘Common’, ‘Boolean’)</p></td>
<td><p>15</p></td>
</tr>
<tr class="row-even"><td><p>(‘Singleton’, ‘Non-Bool’)</p></td>
<td><p>27</p></td>
</tr>
<tr class="row-odd"><td><p>(‘Singleton’, ‘Boolean’)</p></td>
<td><p>47</p></td>
</tr>
</tbody>
</table>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">CEL in Python</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Documentation Content:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">CLI Use of CEL-Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="integration.html">Application Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure.html">Architecture and Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development Tools</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">C7N Functions Required</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#design-principles">Design Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#c7n-context-object">C7N Context Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#celfilter-design">CELFilter Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="#c7n-cache">C7N Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="#common-c7n-constructs">Common C7N Constructs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#common-non-bool-filters">Common/Non-Bool Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#common-boolean-filters">Common/Boolean Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#singleton-non-bool-filters">Singleton/Non-Bool Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#singleton-boolean-filters">Singleton/Boolean Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="development.html" title="previous chapter">Development Tools</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2020, CapitalOne.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/c7n_functions.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>